function Jg(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function I_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function P_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Xg={exports:{}},Uc={},Yg={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao=Symbol.for("react.element"),R_=Symbol.for("react.portal"),D_=Symbol.for("react.fragment"),F_=Symbol.for("react.strict_mode"),L_=Symbol.for("react.profiler"),M_=Symbol.for("react.provider"),B_=Symbol.for("react.context"),U_=Symbol.for("react.forward_ref"),$_=Symbol.for("react.suspense"),W_=Symbol.for("react.memo"),z_=Symbol.for("react.lazy"),U0=Symbol.iterator;function H_(e){return e===null||typeof e!="object"?null:(e=U0&&e[U0]||e["@@iterator"],typeof e=="function"?e:null)}var qg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qg=Object.assign,Zg={};function Ys(e,t,r){this.props=e,this.context=t,this.refs=Zg,this.updater=r||qg}Ys.prototype.isReactComponent={};Ys.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ys.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ex(){}ex.prototype=Ys.prototype;function Xh(e,t,r){this.props=e,this.context=t,this.refs=Zg,this.updater=r||qg}var Yh=Xh.prototype=new ex;Yh.constructor=Xh;Qg(Yh,Ys.prototype);Yh.isPureReactComponent=!0;var $0=Array.isArray,tx=Object.prototype.hasOwnProperty,qh={current:null},rx={key:!0,ref:!0,__self:!0,__source:!0};function nx(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)tx.call(t,n)&&!rx.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Ao,type:e,key:s,ref:a,props:i,_owner:qh.current}}function V_(e,t){return{$$typeof:Ao,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qh(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ao}function G_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var W0=/\/+/g;function Su(e,t){return typeof e=="object"&&e!==null&&e.key!=null?G_(""+e.key):t.toString(36)}function Pl(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ao:case R_:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Su(a,0):n,$0(i)?(r="",e!=null&&(r=e.replace(W0,"$&/")+"/"),Pl(i,t,r,"",function(u){return u})):i!=null&&(Qh(i)&&(i=V_(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(W0,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",$0(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+Su(s,l);a+=Pl(s,t,r,c,i)}else if(c=H_(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+Su(s,l++),a+=Pl(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function zo(e,t,r){if(e==null)return e;var n=[],i=0;return Pl(e,n,"","",function(s){return t.call(r,s,i++)}),n}function K_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ur={current:null},Rl={transition:null},J_={ReactCurrentDispatcher:ur,ReactCurrentBatchConfig:Rl,ReactCurrentOwner:qh};Ue.Children={map:zo,forEach:function(e,t,r){zo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zo(e,function(){t++}),t},toArray:function(e){return zo(e,function(t){return t})||[]},only:function(e){if(!Qh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=Ys;Ue.Fragment=D_;Ue.Profiler=L_;Ue.PureComponent=Xh;Ue.StrictMode=F_;Ue.Suspense=$_;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J_;Ue.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Qg({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=qh.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)tx.call(t,c)&&!rx.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Ao,type:e.type,key:i,ref:s,props:n,_owner:a}};Ue.createContext=function(e){return e={$$typeof:B_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:M_,_context:e},e.Consumer=e};Ue.createElement=nx;Ue.createFactory=function(e){var t=nx.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:U_,render:e}};Ue.isValidElement=Qh;Ue.lazy=function(e){return{$$typeof:z_,_payload:{_status:-1,_result:e},_init:K_}};Ue.memo=function(e,t){return{$$typeof:W_,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=Rl.transition;Rl.transition={};try{e()}finally{Rl.transition=t}};Ue.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ue.useCallback=function(e,t){return ur.current.useCallback(e,t)};Ue.useContext=function(e){return ur.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return ur.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return ur.current.useEffect(e,t)};Ue.useId=function(){return ur.current.useId()};Ue.useImperativeHandle=function(e,t,r){return ur.current.useImperativeHandle(e,t,r)};Ue.useInsertionEffect=function(e,t){return ur.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return ur.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return ur.current.useMemo(e,t)};Ue.useReducer=function(e,t,r){return ur.current.useReducer(e,t,r)};Ue.useRef=function(e){return ur.current.useRef(e)};Ue.useState=function(e){return ur.current.useState(e)};Ue.useSyncExternalStore=function(e,t,r){return ur.current.useSyncExternalStore(e,t,r)};Ue.useTransition=function(){return ur.current.useTransition()};Ue.version="18.2.0";Yg.exports=Ue;var X=Yg.exports;const de=I_(X),X_=Jg({__proto__:null,default:de},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_=X,q_=Symbol.for("react.element"),Q_=Symbol.for("react.fragment"),Z_=Object.prototype.hasOwnProperty,eS=Y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tS={key:!0,ref:!0,__self:!0,__source:!0};function ix(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)Z_.call(t,n)&&!tS.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:q_,type:e,key:s,ref:a,props:i,_owner:eS.current}}Uc.Fragment=Q_;Uc.jsx=ix;Uc.jsxs=ix;Xg.exports=Uc;var o=Xg.exports,Od={},sx={exports:{}},Ir={},ax={exports:{}},ox={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,ae){var _=F.length;F.push(ae);e:for(;0<_;){var b=_-1>>>1,T=F[b];if(0<i(T,ae))F[b]=ae,F[_]=T,_=b;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var ae=F[0],_=F.pop();if(_!==ae){F[0]=_;e:for(var b=0,T=F.length,B=T>>>1;b<B;){var S=2*(b+1)-1,R=F[S],W=S+1,Y=F[W];if(0>i(R,_))W<T&&0>i(Y,R)?(F[b]=Y,F[W]=_,b=W):(F[b]=R,F[S]=_,b=S);else if(W<T&&0>i(Y,_))F[b]=Y,F[W]=_,b=W;else break e}}return ae}function i(F,ae){var _=F.sortIndex-ae.sortIndex;return _!==0?_:F.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,m=!1,y=!1,f=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var ae=r(u);ae!==null;){if(ae.callback===null)n(u);else if(ae.startTime<=F)n(u),ae.sortIndex=ae.expirationTime,t(c,ae);else break;ae=r(u)}}function E(F){if(f=!1,w(F),!y)if(r(c)!==null)y=!0,Be(C);else{var ae=r(u);ae!==null&&Ne(E,ae.startTime-F)}}function C(F,ae){y=!1,f&&(f=!1,v(O),O=-1),m=!0;var _=p;try{for(w(ae),h=r(c);h!==null&&(!(h.expirationTime>ae)||F&&!V());){var b=h.callback;if(typeof b=="function"){h.callback=null,p=h.priorityLevel;var T=b(h.expirationTime<=ae);ae=e.unstable_now(),typeof T=="function"?h.callback=T:h===r(c)&&n(c),w(ae)}else n(c);h=r(c)}if(h!==null)var B=!0;else{var S=r(u);S!==null&&Ne(E,S.startTime-ae),B=!1}return B}finally{h=null,p=_,m=!1}}var A=!1,k=null,O=-1,U=5,z=-1;function V(){return!(e.unstable_now()-z<U)}function G(){if(k!==null){var F=e.unstable_now();z=F;var ae=!0;try{ae=k(!0,F)}finally{ae?ie():(A=!1,k=null)}}else A=!1}var ie;if(typeof x=="function")ie=function(){x(G)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,xe=le.port2;le.port1.onmessage=G,ie=function(){xe.postMessage(null)}}else ie=function(){g(G,0)};function Be(F){k=F,A||(A=!0,ie())}function Ne(F,ae){O=g(function(){F(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){y||m||(y=!0,Be(C))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(F){switch(p){case 1:case 2:case 3:var ae=3;break;default:ae=p}var _=p;p=ae;try{return F()}finally{p=_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,ae){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var _=p;p=F;try{return ae()}finally{p=_}},e.unstable_scheduleCallback=function(F,ae,_){var b=e.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?b+_:b):_=b,F){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=_+T,F={id:d++,callback:ae,priorityLevel:F,startTime:_,expirationTime:T,sortIndex:-1},_>b?(F.sortIndex=_,t(u,F),r(c)===null&&F===r(u)&&(f?(v(O),O=-1):f=!0,Ne(E,_-b))):(F.sortIndex=T,t(c,F),y||m||(y=!0,Be(C))),F},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(F){var ae=p;return function(){var _=p;p=ae;try{return F.apply(this,arguments)}finally{p=_}}}})(ox);ax.exports=ox;var rS=ax.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lx=X,br=rS;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cx=new Set,qa={};function Vi(e,t){$s(e,t),$s(e+"Capture",t)}function $s(e,t){for(qa[e]=t,e=0;e<t.length;e++)cx.add(t[e])}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Id=Object.prototype.hasOwnProperty,nS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,z0={},H0={};function iS(e){return Id.call(H0,e)?!0:Id.call(z0,e)?!1:nS.test(e)?H0[e]=!0:(z0[e]=!0,!1)}function sS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aS(e,t,r,n){if(t===null||typeof t>"u"||sS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vt[e]=new dr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Vt[t]=new dr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vt[e]=new dr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vt[e]=new dr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vt[e]=new dr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vt[e]=new dr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vt[e]=new dr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vt[e]=new dr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vt[e]=new dr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zh=/[\-:]([a-z])/g;function ef(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zh,ef);Vt[t]=new dr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zh,ef);Vt[t]=new dr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zh,ef);Vt[t]=new dr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vt[e]=new dr(e,1,!1,e.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vt[e]=new dr(e,1,!1,e.toLowerCase(),null,!0,!0)});function tf(e,t,r,n){var i=Vt.hasOwnProperty(t)?Vt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aS(t,r,i,n)&&(r=null),n||i===null?iS(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var In=lx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ho=Symbol.for("react.element"),xs=Symbol.for("react.portal"),vs=Symbol.for("react.fragment"),rf=Symbol.for("react.strict_mode"),Pd=Symbol.for("react.profiler"),ux=Symbol.for("react.provider"),dx=Symbol.for("react.context"),nf=Symbol.for("react.forward_ref"),Rd=Symbol.for("react.suspense"),Dd=Symbol.for("react.suspense_list"),sf=Symbol.for("react.memo"),$n=Symbol.for("react.lazy"),hx=Symbol.for("react.offscreen"),V0=Symbol.iterator;function fa(e){return e===null||typeof e!="object"?null:(e=V0&&e[V0]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,Eu;function Aa(e){if(Eu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Eu=t&&t[1]||""}return`
`+Eu+e}var Tu=!1;function ku(e,t){if(!e||Tu)return"";Tu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var c=`
`+i[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Tu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Aa(e):""}function oS(e){switch(e.tag){case 5:return Aa(e.type);case 16:return Aa("Lazy");case 13:return Aa("Suspense");case 19:return Aa("SuspenseList");case 0:case 2:case 15:return e=ku(e.type,!1),e;case 11:return e=ku(e.type.render,!1),e;case 1:return e=ku(e.type,!0),e;default:return""}}function Fd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vs:return"Fragment";case xs:return"Portal";case Pd:return"Profiler";case rf:return"StrictMode";case Rd:return"Suspense";case Dd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dx:return(e.displayName||"Context")+".Consumer";case ux:return(e._context.displayName||"Context")+".Provider";case nf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sf:return t=e.displayName||null,t!==null?t:Fd(e.type)||"Memo";case $n:t=e._payload,e=e._init;try{return Fd(e(t))}catch{}}return null}function lS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fd(t);case 8:return t===rf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ai(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cS(e){var t=fx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vo(e){e._valueTracker||(e._valueTracker=cS(e))}function px(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=fx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Jl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ld(e,t){var r=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function G0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ai(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mx(e,t){t=t.checked,t!=null&&tf(e,"checked",t,!1)}function Md(e,t){mx(e,t);var r=ai(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bd(e,t.type,r):t.hasOwnProperty("defaultValue")&&Bd(e,t.type,ai(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function K0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Bd(e,t,r){(t!=="number"||Jl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ca=Array.isArray;function bs(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ai(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Ud(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function J0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pe(92));if(Ca(r)){if(1<r.length)throw Error(pe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ai(r)}}function gx(e,t){var r=ai(t.value),n=ai(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function X0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function xx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $d(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?xx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Go,vx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Go=Go||document.createElement("div"),Go.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Go.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qa(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ra={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uS=["Webkit","ms","Moz","O"];Object.keys(Ra).forEach(function(e){uS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ra[t]=Ra[e]})});function yx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ra.hasOwnProperty(e)&&Ra[e]?(""+t).trim():t+"px"}function wx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=yx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var dS=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wd(e,t){if(t){if(dS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function zd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hd=null;function af(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vd=null,Os=null,Is=null;function Y0(e){if(e=bo(e)){if(typeof Vd!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=Vc(t),Vd(e.stateNode,e.type,t))}}function _x(e){Os?Is?Is.push(e):Is=[e]:Os=e}function Sx(){if(Os){var e=Os,t=Is;if(Is=Os=null,Y0(e),t)for(e=0;e<t.length;e++)Y0(t[e])}}function Ex(e,t){return e(t)}function Tx(){}var ju=!1;function kx(e,t,r){if(ju)return e(t,r);ju=!0;try{return Ex(e,t,r)}finally{ju=!1,(Os!==null||Is!==null)&&(Tx(),Sx())}}function Za(e,t){var r=e.stateNode;if(r===null)return null;var n=Vc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pe(231,t,typeof r));return r}var Gd=!1;if(jn)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){Gd=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{Gd=!1}function hS(e,t,r,n,i,s,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Da=!1,Xl=null,Yl=!1,Kd=null,fS={onError:function(e){Da=!0,Xl=e}};function pS(e,t,r,n,i,s,a,l,c){Da=!1,Xl=null,hS.apply(fS,arguments)}function mS(e,t,r,n,i,s,a,l,c){if(pS.apply(this,arguments),Da){if(Da){var u=Xl;Da=!1,Xl=null}else throw Error(pe(198));Yl||(Yl=!0,Kd=u)}}function Gi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function jx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function q0(e){if(Gi(e)!==e)throw Error(pe(188))}function gS(e){var t=e.alternate;if(!t){if(t=Gi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return q0(i),e;if(s===n)return q0(i),t;s=s.sibling}throw Error(pe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a)throw Error(pe(189))}}if(r.alternate!==n)throw Error(pe(190))}if(r.tag!==3)throw Error(pe(188));return r.stateNode.current===r?e:t}function Ax(e){return e=gS(e),e!==null?Cx(e):null}function Cx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Cx(e);if(t!==null)return t;e=e.sibling}return null}var Nx=br.unstable_scheduleCallback,Q0=br.unstable_cancelCallback,xS=br.unstable_shouldYield,vS=br.unstable_requestPaint,wt=br.unstable_now,yS=br.unstable_getCurrentPriorityLevel,of=br.unstable_ImmediatePriority,bx=br.unstable_UserBlockingPriority,ql=br.unstable_NormalPriority,wS=br.unstable_LowPriority,Ox=br.unstable_IdlePriority,$c=null,hn=null;function _S(e){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot($c,e,void 0,(e.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:TS,SS=Math.log,ES=Math.LN2;function TS(e){return e>>>=0,e===0?32:31-(SS(e)/ES|0)|0}var Ko=64,Jo=4194304;function Na(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ql(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~i;l!==0?n=Na(l):(s&=a,s!==0&&(n=Na(s)))}else a=r&~i,a!==0?n=Na(a):s!==0&&(n=Na(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-rn(t),i=1<<r,n|=e[r],t&=~i;return n}function kS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-rn(s),l=1<<a,c=i[a];c===-1?(!(l&r)||l&n)&&(i[a]=kS(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Jd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ix(){var e=Ko;return Ko<<=1,!(Ko&4194240)&&(Ko=64),e}function Au(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Co(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rn(t),e[t]=r}function AS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-rn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function lf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-rn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ye=0;function Px(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Rx,cf,Dx,Fx,Lx,Xd=!1,Xo=[],qn=null,Qn=null,Zn=null,eo=new Map,to=new Map,zn=[],CS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z0(e,t){switch(e){case"focusin":case"focusout":qn=null;break;case"dragenter":case"dragleave":Qn=null;break;case"mouseover":case"mouseout":Zn=null;break;case"pointerover":case"pointerout":eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(t.pointerId)}}function ma(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=bo(t),t!==null&&cf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function NS(e,t,r,n,i){switch(t){case"focusin":return qn=ma(qn,e,t,r,n,i),!0;case"dragenter":return Qn=ma(Qn,e,t,r,n,i),!0;case"mouseover":return Zn=ma(Zn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return eo.set(s,ma(eo.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,to.set(s,ma(to.get(s)||null,e,t,r,n,i)),!0}return!1}function Mx(e){var t=bi(e.target);if(t!==null){var r=Gi(t);if(r!==null){if(t=r.tag,t===13){if(t=jx(r),t!==null){e.blockedOn=t,Lx(e.priority,function(){Dx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Hd=n,r.target.dispatchEvent(n),Hd=null}else return t=bo(r),t!==null&&cf(t),e.blockedOn=r,!1;t.shift()}return!0}function ep(e,t,r){Dl(e)&&r.delete(t)}function bS(){Xd=!1,qn!==null&&Dl(qn)&&(qn=null),Qn!==null&&Dl(Qn)&&(Qn=null),Zn!==null&&Dl(Zn)&&(Zn=null),eo.forEach(ep),to.forEach(ep)}function ga(e,t){e.blockedOn===t&&(e.blockedOn=null,Xd||(Xd=!0,br.unstable_scheduleCallback(br.unstable_NormalPriority,bS)))}function ro(e){function t(i){return ga(i,e)}if(0<Xo.length){ga(Xo[0],e);for(var r=1;r<Xo.length;r++){var n=Xo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(qn!==null&&ga(qn,e),Qn!==null&&ga(Qn,e),Zn!==null&&ga(Zn,e),eo.forEach(t),to.forEach(t),r=0;r<zn.length;r++)n=zn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zn.length&&(r=zn[0],r.blockedOn===null);)Mx(r),r.blockedOn===null&&zn.shift()}var Ps=In.ReactCurrentBatchConfig,Zl=!0;function OS(e,t,r,n){var i=Ye,s=Ps.transition;Ps.transition=null;try{Ye=1,uf(e,t,r,n)}finally{Ye=i,Ps.transition=s}}function IS(e,t,r,n){var i=Ye,s=Ps.transition;Ps.transition=null;try{Ye=4,uf(e,t,r,n)}finally{Ye=i,Ps.transition=s}}function uf(e,t,r,n){if(Zl){var i=Yd(e,t,r,n);if(i===null)Lu(e,t,n,ec,r),Z0(e,n);else if(NS(i,e,t,r,n))n.stopPropagation();else if(Z0(e,n),t&4&&-1<CS.indexOf(e)){for(;i!==null;){var s=bo(i);if(s!==null&&Rx(s),s=Yd(e,t,r,n),s===null&&Lu(e,t,n,ec,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Lu(e,t,n,null,r)}}var ec=null;function Yd(e,t,r,n){if(ec=null,e=af(n),e=bi(e),e!==null)if(t=Gi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=jx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ec=e,null}function Bx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yS()){case of:return 1;case bx:return 4;case ql:case wS:return 16;case Ox:return 536870912;default:return 16}default:return 16}}var Gn=null,df=null,Fl=null;function Ux(){if(Fl)return Fl;var e,t=df,r=t.length,n,i="value"in Gn?Gn.value:Gn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Fl=i.slice(e,1<n?1-n:void 0)}function Ll(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yo(){return!0}function tp(){return!1}function Pr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Yo:tp,this.isPropagationStopped=tp,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),t}var qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hf=Pr(qs),No=pt({},qs,{view:0,detail:0}),PS=Pr(No),Cu,Nu,xa,Wc=pt({},No,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ff,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==xa&&(xa&&e.type==="mousemove"?(Cu=e.screenX-xa.screenX,Nu=e.screenY-xa.screenY):Nu=Cu=0,xa=e),Cu)},movementY:function(e){return"movementY"in e?e.movementY:Nu}}),rp=Pr(Wc),RS=pt({},Wc,{dataTransfer:0}),DS=Pr(RS),FS=pt({},No,{relatedTarget:0}),bu=Pr(FS),LS=pt({},qs,{animationName:0,elapsedTime:0,pseudoElement:0}),MS=Pr(LS),BS=pt({},qs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),US=Pr(BS),$S=pt({},qs,{data:0}),np=Pr($S),WS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=HS[e])?!!t[e]:!1}function ff(){return VS}var GS=pt({},No,{key:function(e){if(e.key){var t=WS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ll(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ff,charCode:function(e){return e.type==="keypress"?Ll(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ll(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),KS=Pr(GS),JS=pt({},Wc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ip=Pr(JS),XS=pt({},No,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ff}),YS=Pr(XS),qS=pt({},qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),QS=Pr(qS),ZS=pt({},Wc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),e2=Pr(ZS),t2=[9,13,27,32],pf=jn&&"CompositionEvent"in window,Fa=null;jn&&"documentMode"in document&&(Fa=document.documentMode);var r2=jn&&"TextEvent"in window&&!Fa,$x=jn&&(!pf||Fa&&8<Fa&&11>=Fa),sp=" ",ap=!1;function Wx(e,t){switch(e){case"keyup":return t2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ys=!1;function n2(e,t){switch(e){case"compositionend":return zx(t);case"keypress":return t.which!==32?null:(ap=!0,sp);case"textInput":return e=t.data,e===sp&&ap?null:e;default:return null}}function i2(e,t){if(ys)return e==="compositionend"||!pf&&Wx(e,t)?(e=Ux(),Fl=df=Gn=null,ys=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $x&&t.locale!=="ko"?null:t.data;default:return null}}var s2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function op(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!s2[e.type]:t==="textarea"}function Hx(e,t,r,n){_x(n),t=tc(t,"onChange"),0<t.length&&(r=new hf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var La=null,no=null;function a2(e){t1(e,0)}function zc(e){var t=Ss(e);if(px(t))return e}function o2(e,t){if(e==="change")return t}var Vx=!1;if(jn){var Ou;if(jn){var Iu="oninput"in document;if(!Iu){var lp=document.createElement("div");lp.setAttribute("oninput","return;"),Iu=typeof lp.oninput=="function"}Ou=Iu}else Ou=!1;Vx=Ou&&(!document.documentMode||9<document.documentMode)}function cp(){La&&(La.detachEvent("onpropertychange",Gx),no=La=null)}function Gx(e){if(e.propertyName==="value"&&zc(no)){var t=[];Hx(t,no,e,af(e)),kx(a2,t)}}function l2(e,t,r){e==="focusin"?(cp(),La=t,no=r,La.attachEvent("onpropertychange",Gx)):e==="focusout"&&cp()}function c2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zc(no)}function u2(e,t){if(e==="click")return zc(t)}function d2(e,t){if(e==="input"||e==="change")return zc(t)}function h2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var an=typeof Object.is=="function"?Object.is:h2;function io(e,t){if(an(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Id.call(t,i)||!an(e[i],t[i]))return!1}return!0}function up(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dp(e,t){var r=up(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=up(r)}}function Kx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Kx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Jx(){for(var e=window,t=Jl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Jl(e.document)}return t}function mf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function f2(e){var t=Jx(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Kx(r.ownerDocument.documentElement,r)){if(n!==null&&mf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=dp(r,s);var a=dp(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var p2=jn&&"documentMode"in document&&11>=document.documentMode,ws=null,qd=null,Ma=null,Qd=!1;function hp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qd||ws==null||ws!==Jl(n)||(n=ws,"selectionStart"in n&&mf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ma&&io(Ma,n)||(Ma=n,n=tc(qd,"onSelect"),0<n.length&&(t=new hf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ws)))}function qo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _s={animationend:qo("Animation","AnimationEnd"),animationiteration:qo("Animation","AnimationIteration"),animationstart:qo("Animation","AnimationStart"),transitionend:qo("Transition","TransitionEnd")},Pu={},Xx={};jn&&(Xx=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function Hc(e){if(Pu[e])return Pu[e];if(!_s[e])return e;var t=_s[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Xx)return Pu[e]=t[r];return e}var Yx=Hc("animationend"),qx=Hc("animationiteration"),Qx=Hc("animationstart"),Zx=Hc("transitionend"),e1=new Map,fp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function di(e,t){e1.set(e,t),Vi(t,[e])}for(var Ru=0;Ru<fp.length;Ru++){var Du=fp[Ru],m2=Du.toLowerCase(),g2=Du[0].toUpperCase()+Du.slice(1);di(m2,"on"+g2)}di(Yx,"onAnimationEnd");di(qx,"onAnimationIteration");di(Qx,"onAnimationStart");di("dblclick","onDoubleClick");di("focusin","onFocus");di("focusout","onBlur");di(Zx,"onTransitionEnd");$s("onMouseEnter",["mouseout","mouseover"]);$s("onMouseLeave",["mouseout","mouseover"]);$s("onPointerEnter",["pointerout","pointerover"]);$s("onPointerLeave",["pointerout","pointerover"]);Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x2=new Set("cancel close invalid load scroll toggle".split(" ").concat(ba));function pp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,mS(n,t,void 0,e),e.currentTarget=null}function t1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;pp(i,l,u),s=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;pp(i,l,u),s=c}}}if(Yl)throw e=Kd,Yl=!1,Kd=null,e}function nt(e,t){var r=t[nh];r===void 0&&(r=t[nh]=new Set);var n=e+"__bubble";r.has(n)||(r1(t,e,2,!1),r.add(n))}function Fu(e,t,r){var n=0;t&&(n|=4),r1(r,e,n,t)}var Qo="_reactListening"+Math.random().toString(36).slice(2);function so(e){if(!e[Qo]){e[Qo]=!0,cx.forEach(function(r){r!=="selectionchange"&&(x2.has(r)||Fu(r,!1,e),Fu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qo]||(t[Qo]=!0,Fu("selectionchange",!1,t))}}function r1(e,t,r,n){switch(Bx(t)){case 1:var i=OS;break;case 4:i=IS;break;default:i=uf}r=i.bind(null,t,r,e),i=void 0,!Gd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Lu(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;l!==null;){if(a=bi(l),a===null)return;if(c=a.tag,c===5||c===6){n=s=a;continue e}l=l.parentNode}}n=n.return}kx(function(){var u=s,d=af(r),h=[];e:{var p=e1.get(e);if(p!==void 0){var m=hf,y=e;switch(e){case"keypress":if(Ll(r)===0)break e;case"keydown":case"keyup":m=KS;break;case"focusin":y="focus",m=bu;break;case"focusout":y="blur",m=bu;break;case"beforeblur":case"afterblur":m=bu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=DS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=YS;break;case Yx:case qx:case Qx:m=MS;break;case Zx:m=QS;break;case"scroll":m=PS;break;case"wheel":m=e2;break;case"copy":case"cut":case"paste":m=US;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=ip}var f=(t&4)!==0,g=!f&&e==="scroll",v=f?p!==null?p+"Capture":null:p;f=[];for(var x=u,w;x!==null;){w=x;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,v!==null&&(E=Za(x,v),E!=null&&f.push(ao(x,E,w)))),g)break;x=x.return}0<f.length&&(p=new m(p,y,null,r,d),h.push({event:p,listeners:f}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==Hd&&(y=r.relatedTarget||r.fromElement)&&(bi(y)||y[An]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?bi(y):null,y!==null&&(g=Gi(y),y!==g||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(f=rp,E="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(f=ip,E="onPointerLeave",v="onPointerEnter",x="pointer"),g=m==null?p:Ss(m),w=y==null?p:Ss(y),p=new f(E,x+"leave",m,r,d),p.target=g,p.relatedTarget=w,E=null,bi(d)===u&&(f=new f(v,x+"enter",y,r,d),f.target=w,f.relatedTarget=g,E=f),g=E,m&&y)t:{for(f=m,v=y,x=0,w=f;w;w=Qi(w))x++;for(w=0,E=v;E;E=Qi(E))w++;for(;0<x-w;)f=Qi(f),x--;for(;0<w-x;)v=Qi(v),w--;for(;x--;){if(f===v||v!==null&&f===v.alternate)break t;f=Qi(f),v=Qi(v)}f=null}else f=null;m!==null&&mp(h,p,m,f,!1),y!==null&&g!==null&&mp(h,g,y,f,!0)}}e:{if(p=u?Ss(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=o2;else if(op(p))if(Vx)C=d2;else{C=c2;var A=l2}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=u2);if(C&&(C=C(e,u))){Hx(h,C,r,d);break e}A&&A(e,p,u),e==="focusout"&&(A=p._wrapperState)&&A.controlled&&p.type==="number"&&Bd(p,"number",p.value)}switch(A=u?Ss(u):window,e){case"focusin":(op(A)||A.contentEditable==="true")&&(ws=A,qd=u,Ma=null);break;case"focusout":Ma=qd=ws=null;break;case"mousedown":Qd=!0;break;case"contextmenu":case"mouseup":case"dragend":Qd=!1,hp(h,r,d);break;case"selectionchange":if(p2)break;case"keydown":case"keyup":hp(h,r,d)}var k;if(pf)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else ys?Wx(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&($x&&r.locale!=="ko"&&(ys||O!=="onCompositionStart"?O==="onCompositionEnd"&&ys&&(k=Ux()):(Gn=d,df="value"in Gn?Gn.value:Gn.textContent,ys=!0)),A=tc(u,O),0<A.length&&(O=new np(O,e,null,r,d),h.push({event:O,listeners:A}),k?O.data=k:(k=zx(r),k!==null&&(O.data=k)))),(k=r2?n2(e,r):i2(e,r))&&(u=tc(u,"onBeforeInput"),0<u.length&&(d=new np("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=k))}t1(h,t)})}function ao(e,t,r){return{instance:e,listener:t,currentTarget:r}}function tc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Za(e,r),s!=null&&n.unshift(ao(e,s,i)),s=Za(e,t),s!=null&&n.push(ao(e,s,i))),e=e.return}return n}function Qi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function mp(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Za(r,s),c!=null&&a.unshift(ao(r,c,l))):i||(c=Za(r,s),c!=null&&a.push(ao(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var v2=/\r\n?/g,y2=/\u0000|\uFFFD/g;function gp(e){return(typeof e=="string"?e:""+e).replace(v2,`
`).replace(y2,"")}function Zo(e,t,r){if(t=gp(t),gp(e)!==t&&r)throw Error(pe(425))}function rc(){}var Zd=null,eh=null;function th(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rh=typeof setTimeout=="function"?setTimeout:void 0,w2=typeof clearTimeout=="function"?clearTimeout:void 0,xp=typeof Promise=="function"?Promise:void 0,_2=typeof queueMicrotask=="function"?queueMicrotask:typeof xp<"u"?function(e){return xp.resolve(null).then(e).catch(S2)}:rh;function S2(e){setTimeout(function(){throw e})}function Mu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),ro(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ro(t)}function ei(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qs=Math.random().toString(36).slice(2),dn="__reactFiber$"+Qs,oo="__reactProps$"+Qs,An="__reactContainer$"+Qs,nh="__reactEvents$"+Qs,E2="__reactListeners$"+Qs,T2="__reactHandles$"+Qs;function bi(e){var t=e[dn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[An]||r[dn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=vp(e);e!==null;){if(r=e[dn])return r;e=vp(e)}return t}e=r,r=e.parentNode}return null}function bo(e){return e=e[dn]||e[An],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ss(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function Vc(e){return e[oo]||null}var ih=[],Es=-1;function hi(e){return{current:e}}function it(e){0>Es||(e.current=ih[Es],ih[Es]=null,Es--)}function rt(e,t){Es++,ih[Es]=e.current,e.current=t}var oi={},tr=hi(oi),pr=hi(!1),Li=oi;function Ws(e,t){var r=e.type.contextTypes;if(!r)return oi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function mr(e){return e=e.childContextTypes,e!=null}function nc(){it(pr),it(tr)}function yp(e,t,r){if(tr.current!==oi)throw Error(pe(168));rt(tr,t),rt(pr,r)}function n1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(pe(108,lS(e)||"Unknown",i));return pt({},r,n)}function ic(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oi,Li=tr.current,rt(tr,e),rt(pr,pr.current),!0}function wp(e,t,r){var n=e.stateNode;if(!n)throw Error(pe(169));r?(e=n1(e,t,Li),n.__reactInternalMemoizedMergedChildContext=e,it(pr),it(tr),rt(tr,e)):it(pr),rt(pr,r)}var yn=null,Gc=!1,Bu=!1;function i1(e){yn===null?yn=[e]:yn.push(e)}function k2(e){Gc=!0,i1(e)}function fi(){if(!Bu&&yn!==null){Bu=!0;var e=0,t=Ye;try{var r=yn;for(Ye=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}yn=null,Gc=!1}catch(i){throw yn!==null&&(yn=yn.slice(e+1)),Nx(of,fi),i}finally{Ye=t,Bu=!1}}return null}var Ts=[],ks=0,sc=null,ac=0,Mr=[],Br=0,Mi=null,wn=1,_n="";function Ei(e,t){Ts[ks++]=ac,Ts[ks++]=sc,sc=e,ac=t}function s1(e,t,r){Mr[Br++]=wn,Mr[Br++]=_n,Mr[Br++]=Mi,Mi=e;var n=wn;e=_n;var i=32-rn(n)-1;n&=~(1<<i),r+=1;var s=32-rn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,wn=1<<32-rn(t)+i|r<<i|n,_n=s+e}else wn=1<<s|r<<i|n,_n=e}function gf(e){e.return!==null&&(Ei(e,1),s1(e,1,0))}function xf(e){for(;e===sc;)sc=Ts[--ks],Ts[ks]=null,ac=Ts[--ks],Ts[ks]=null;for(;e===Mi;)Mi=Mr[--Br],Mr[Br]=null,_n=Mr[--Br],Mr[Br]=null,wn=Mr[--Br],Mr[Br]=null}var Nr=null,Cr=null,ot=!1,Zr=null;function a1(e,t){var r=Ur(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _p(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nr=e,Cr=ei(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nr=e,Cr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Mi!==null?{id:wn,overflow:_n}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ur(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Nr=e,Cr=null,!0):!1;default:return!1}}function sh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ah(e){if(ot){var t=Cr;if(t){var r=t;if(!_p(e,t)){if(sh(e))throw Error(pe(418));t=ei(r.nextSibling);var n=Nr;t&&_p(e,t)?a1(n,r):(e.flags=e.flags&-4097|2,ot=!1,Nr=e)}}else{if(sh(e))throw Error(pe(418));e.flags=e.flags&-4097|2,ot=!1,Nr=e}}}function Sp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nr=e}function el(e){if(e!==Nr)return!1;if(!ot)return Sp(e),ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!th(e.type,e.memoizedProps)),t&&(t=Cr)){if(sh(e))throw o1(),Error(pe(418));for(;t;)a1(e,t),t=ei(t.nextSibling)}if(Sp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Cr=ei(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Cr=null}}else Cr=Nr?ei(e.stateNode.nextSibling):null;return!0}function o1(){for(var e=Cr;e;)e=ei(e.nextSibling)}function zs(){Cr=Nr=null,ot=!1}function vf(e){Zr===null?Zr=[e]:Zr.push(e)}var j2=In.ReactCurrentBatchConfig;function Yr(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var oc=hi(null),lc=null,js=null,yf=null;function wf(){yf=js=lc=null}function _f(e){var t=oc.current;it(oc),e._currentValue=t}function oh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Rs(e,t){lc=e,yf=js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fr=!0),e.firstContext=null)}function Wr(e){var t=e._currentValue;if(yf!==e)if(e={context:e,memoizedValue:t,next:null},js===null){if(lc===null)throw Error(pe(308));js=e,lc.dependencies={lanes:0,firstContext:e}}else js=js.next=e;return t}var Oi=null;function Sf(e){Oi===null?Oi=[e]:Oi.push(e)}function l1(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Sf(t)):(r.next=i.next,i.next=r),t.interleaved=r,Cn(e,n)}function Cn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Wn=!1;function Ef(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ti(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ze&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Cn(e,r)}return i=n.interleaved,i===null?(t.next=t,Sf(n)):(t.next=i.next,i.next=t),n.interleaved=t,Cn(e,r)}function Ml(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lf(e,r)}}function Ep(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function cc(e,t,r,n){var i=e.updateQueue;Wn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?s=u:a.next=u,a=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;a=0,d=u=c=null,l=s;do{var p=l.lane,m=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,f=l;switch(p=t,m=r,f.tag){case 1:if(y=f.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=f.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=pt({},h,p);break e;case 2:Wn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,a|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ui|=a,e.lanes=a,e.memoizedState=h}}function Tp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(pe(191,i));i.call(n)}}}var u1=new lx.Component().refs;function lh(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Kc={isMounted:function(e){return(e=e._reactInternals)?Gi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=lr(),i=ni(e),s=Sn(n,i);s.payload=t,r!=null&&(s.callback=r),t=ti(e,s,i),t!==null&&(nn(t,e,i,n),Ml(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=lr(),i=ni(e),s=Sn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ti(e,s,i),t!==null&&(nn(t,e,i,n),Ml(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=lr(),n=ni(e),i=Sn(r,n);i.tag=2,t!=null&&(i.callback=t),t=ti(e,i,n),t!==null&&(nn(t,e,n,r),Ml(t,e,n))}};function kp(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!io(r,n)||!io(i,s):!0}function d1(e,t,r){var n=!1,i=oi,s=t.contextType;return typeof s=="object"&&s!==null?s=Wr(s):(i=mr(t)?Li:tr.current,n=t.contextTypes,s=(n=n!=null)?Ws(e,i):oi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Kc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function jp(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Kc.enqueueReplaceState(t,t.state,null)}function ch(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=u1,Ef(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Wr(s):(s=mr(t)?Li:tr.current,i.context=Ws(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(lh(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Kc.enqueueReplaceState(i,i.state,null),cc(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function va(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pe(309));var n=r.stateNode}if(!n)throw Error(pe(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var l=i.refs;l===u1&&(l=i.refs={}),a===null?delete l[s]:l[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(pe(284));if(!r._owner)throw Error(pe(290,e))}return e}function tl(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ap(e){var t=e._init;return t(e._payload)}function h1(e){function t(v,x){if(e){var w=v.deletions;w===null?(v.deletions=[x],v.flags|=16):w.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=ii(v,x),v.index=0,v.sibling=null,v}function s(v,x,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<x?(v.flags|=2,x):w):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,x,w,E){return x===null||x.tag!==6?(x=Gu(w,v.mode,E),x.return=v,x):(x=i(x,w),x.return=v,x)}function c(v,x,w,E){var C=w.type;return C===vs?d(v,x,w.props.children,E,w.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$n&&Ap(C)===x.type)?(E=i(x,w.props),E.ref=va(v,x,w),E.return=v,E):(E=Hl(w.type,w.key,w.props,null,v.mode,E),E.ref=va(v,x,w),E.return=v,E)}function u(v,x,w,E){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Ku(w,v.mode,E),x.return=v,x):(x=i(x,w.children||[]),x.return=v,x)}function d(v,x,w,E,C){return x===null||x.tag!==7?(x=Di(w,v.mode,E,C),x.return=v,x):(x=i(x,w),x.return=v,x)}function h(v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Gu(""+x,v.mode,w),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ho:return w=Hl(x.type,x.key,x.props,null,v.mode,w),w.ref=va(v,null,x),w.return=v,w;case xs:return x=Ku(x,v.mode,w),x.return=v,x;case $n:var E=x._init;return h(v,E(x._payload),w)}if(Ca(x)||fa(x))return x=Di(x,v.mode,w,null),x.return=v,x;tl(v,x)}return null}function p(v,x,w,E){var C=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:l(v,x,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ho:return w.key===C?c(v,x,w,E):null;case xs:return w.key===C?u(v,x,w,E):null;case $n:return C=w._init,p(v,x,C(w._payload),E)}if(Ca(w)||fa(w))return C!==null?null:d(v,x,w,E,null);tl(v,w)}return null}function m(v,x,w,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(w)||null,l(x,v,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ho:return v=v.get(E.key===null?w:E.key)||null,c(x,v,E,C);case xs:return v=v.get(E.key===null?w:E.key)||null,u(x,v,E,C);case $n:var A=E._init;return m(v,x,w,A(E._payload),C)}if(Ca(E)||fa(E))return v=v.get(w)||null,d(x,v,E,C,null);tl(x,E)}return null}function y(v,x,w,E){for(var C=null,A=null,k=x,O=x=0,U=null;k!==null&&O<w.length;O++){k.index>O?(U=k,k=null):U=k.sibling;var z=p(v,k,w[O],E);if(z===null){k===null&&(k=U);break}e&&k&&z.alternate===null&&t(v,k),x=s(z,x,O),A===null?C=z:A.sibling=z,A=z,k=U}if(O===w.length)return r(v,k),ot&&Ei(v,O),C;if(k===null){for(;O<w.length;O++)k=h(v,w[O],E),k!==null&&(x=s(k,x,O),A===null?C=k:A.sibling=k,A=k);return ot&&Ei(v,O),C}for(k=n(v,k);O<w.length;O++)U=m(k,v,O,w[O],E),U!==null&&(e&&U.alternate!==null&&k.delete(U.key===null?O:U.key),x=s(U,x,O),A===null?C=U:A.sibling=U,A=U);return e&&k.forEach(function(V){return t(v,V)}),ot&&Ei(v,O),C}function f(v,x,w,E){var C=fa(w);if(typeof C!="function")throw Error(pe(150));if(w=C.call(w),w==null)throw Error(pe(151));for(var A=C=null,k=x,O=x=0,U=null,z=w.next();k!==null&&!z.done;O++,z=w.next()){k.index>O?(U=k,k=null):U=k.sibling;var V=p(v,k,z.value,E);if(V===null){k===null&&(k=U);break}e&&k&&V.alternate===null&&t(v,k),x=s(V,x,O),A===null?C=V:A.sibling=V,A=V,k=U}if(z.done)return r(v,k),ot&&Ei(v,O),C;if(k===null){for(;!z.done;O++,z=w.next())z=h(v,z.value,E),z!==null&&(x=s(z,x,O),A===null?C=z:A.sibling=z,A=z);return ot&&Ei(v,O),C}for(k=n(v,k);!z.done;O++,z=w.next())z=m(k,v,O,z.value,E),z!==null&&(e&&z.alternate!==null&&k.delete(z.key===null?O:z.key),x=s(z,x,O),A===null?C=z:A.sibling=z,A=z);return e&&k.forEach(function(G){return t(v,G)}),ot&&Ei(v,O),C}function g(v,x,w,E){if(typeof w=="object"&&w!==null&&w.type===vs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ho:e:{for(var C=w.key,A=x;A!==null;){if(A.key===C){if(C=w.type,C===vs){if(A.tag===7){r(v,A.sibling),x=i(A,w.props.children),x.return=v,v=x;break e}}else if(A.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$n&&Ap(C)===A.type){r(v,A.sibling),x=i(A,w.props),x.ref=va(v,A,w),x.return=v,v=x;break e}r(v,A);break}else t(v,A);A=A.sibling}w.type===vs?(x=Di(w.props.children,v.mode,E,w.key),x.return=v,v=x):(E=Hl(w.type,w.key,w.props,null,v.mode,E),E.ref=va(v,x,w),E.return=v,v=E)}return a(v);case xs:e:{for(A=w.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){r(v,x.sibling),x=i(x,w.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=Ku(w,v.mode,E),x.return=v,v=x}return a(v);case $n:return A=w._init,g(v,x,A(w._payload),E)}if(Ca(w))return y(v,x,w,E);if(fa(w))return f(v,x,w,E);tl(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,w),x.return=v,v=x):(r(v,x),x=Gu(w,v.mode,E),x.return=v,v=x),a(v)):r(v,x)}return g}var Hs=h1(!0),f1=h1(!1),Oo={},fn=hi(Oo),lo=hi(Oo),co=hi(Oo);function Ii(e){if(e===Oo)throw Error(pe(174));return e}function Tf(e,t){switch(rt(co,t),rt(lo,e),rt(fn,Oo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$d(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$d(t,e)}it(fn),rt(fn,t)}function Vs(){it(fn),it(lo),it(co)}function p1(e){Ii(co.current);var t=Ii(fn.current),r=$d(t,e.type);t!==r&&(rt(lo,e),rt(fn,r))}function kf(e){lo.current===e&&(it(fn),it(lo))}var ht=hi(0);function uc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Uu=[];function jf(){for(var e=0;e<Uu.length;e++)Uu[e]._workInProgressVersionPrimary=null;Uu.length=0}var Bl=In.ReactCurrentDispatcher,$u=In.ReactCurrentBatchConfig,Bi=0,ft=null,Ot=null,Pt=null,dc=!1,Ba=!1,uo=0,A2=0;function Jt(){throw Error(pe(321))}function Af(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!an(e[r],t[r]))return!1;return!0}function Cf(e,t,r,n,i,s){if(Bi=s,ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bl.current=e===null||e.memoizedState===null?O2:I2,e=r(n,i),Ba){s=0;do{if(Ba=!1,uo=0,25<=s)throw Error(pe(301));s+=1,Pt=Ot=null,t.updateQueue=null,Bl.current=P2,e=r(n,i)}while(Ba)}if(Bl.current=hc,t=Ot!==null&&Ot.next!==null,Bi=0,Pt=Ot=ft=null,dc=!1,t)throw Error(pe(300));return e}function Nf(){var e=uo!==0;return uo=0,e}function un(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?ft.memoizedState=Pt=e:Pt=Pt.next=e,Pt}function zr(){if(Ot===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=Pt===null?ft.memoizedState:Pt.next;if(t!==null)Pt=t,Ot=e;else{if(e===null)throw Error(pe(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Pt===null?ft.memoizedState=Pt=e:Pt=Pt.next=e}return Pt}function ho(e,t){return typeof t=="function"?t(e):t}function Wu(e){var t=zr(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=Ot,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((Bi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=n):c=c.next=h,ft.lanes|=d,Ui|=d}u=u.next}while(u!==null&&u!==s);c===null?a=n:c.next=l,an(n,t.memoizedState)||(fr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,ft.lanes|=s,Ui|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function zu(e){var t=zr(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);an(s,t.memoizedState)||(fr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function m1(){}function g1(e,t){var r=ft,n=zr(),i=t(),s=!an(n.memoizedState,i);if(s&&(n.memoizedState=i,fr=!0),n=n.queue,bf(y1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Pt!==null&&Pt.memoizedState.tag&1){if(r.flags|=2048,fo(9,v1.bind(null,r,n,i,t),void 0,null),Lt===null)throw Error(pe(349));Bi&30||x1(r,t,i)}return i}function x1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function v1(e,t,r,n){t.value=r,t.getSnapshot=n,w1(t)&&_1(e)}function y1(e,t,r){return r(function(){w1(t)&&_1(e)})}function w1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!an(e,r)}catch{return!0}}function _1(e){var t=Cn(e,1);t!==null&&nn(t,e,1,-1)}function Cp(e){var t=un();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:e},t.queue=e,e=e.dispatch=b2.bind(null,ft,e),[t.memoizedState,e]}function fo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function S1(){return zr().memoizedState}function Ul(e,t,r,n){var i=un();ft.flags|=e,i.memoizedState=fo(1|t,r,void 0,n===void 0?null:n)}function Jc(e,t,r,n){var i=zr();n=n===void 0?null:n;var s=void 0;if(Ot!==null){var a=Ot.memoizedState;if(s=a.destroy,n!==null&&Af(n,a.deps)){i.memoizedState=fo(t,r,s,n);return}}ft.flags|=e,i.memoizedState=fo(1|t,r,s,n)}function Np(e,t){return Ul(8390656,8,e,t)}function bf(e,t){return Jc(2048,8,e,t)}function E1(e,t){return Jc(4,2,e,t)}function T1(e,t){return Jc(4,4,e,t)}function k1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function j1(e,t,r){return r=r!=null?r.concat([e]):null,Jc(4,4,k1.bind(null,t,e),r)}function Of(){}function A1(e,t){var r=zr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Af(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function C1(e,t){var r=zr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Af(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function N1(e,t,r){return Bi&21?(an(r,t)||(r=Ix(),ft.lanes|=r,Ui|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fr=!0),e.memoizedState=r)}function C2(e,t){var r=Ye;Ye=r!==0&&4>r?r:4,e(!0);var n=$u.transition;$u.transition={};try{e(!1),t()}finally{Ye=r,$u.transition=n}}function b1(){return zr().memoizedState}function N2(e,t,r){var n=ni(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},O1(e))I1(t,r);else if(r=l1(e,t,r,n),r!==null){var i=lr();nn(r,e,n,i),P1(r,t,n)}}function b2(e,t,r){var n=ni(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(O1(e))I1(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,l=s(a,r);if(i.hasEagerState=!0,i.eagerState=l,an(l,a)){var c=t.interleaved;c===null?(i.next=i,Sf(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=l1(e,t,i,n),r!==null&&(i=lr(),nn(r,e,n,i),P1(r,t,n))}}function O1(e){var t=e.alternate;return e===ft||t!==null&&t===ft}function I1(e,t){Ba=dc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function P1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lf(e,r)}}var hc={readContext:Wr,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},O2={readContext:Wr,useCallback:function(e,t){return un().memoizedState=[e,t===void 0?null:t],e},useContext:Wr,useEffect:Np,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ul(4194308,4,k1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ul(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ul(4,2,e,t)},useMemo:function(e,t){var r=un();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=un();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=N2.bind(null,ft,e),[n.memoizedState,e]},useRef:function(e){var t=un();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:Of,useDeferredValue:function(e){return un().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=C2.bind(null,e[1]),un().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ft,i=un();if(ot){if(r===void 0)throw Error(pe(407));r=r()}else{if(r=t(),Lt===null)throw Error(pe(349));Bi&30||x1(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Np(y1.bind(null,n,s,e),[e]),n.flags|=2048,fo(9,v1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=un(),t=Lt.identifierPrefix;if(ot){var r=_n,n=wn;r=(n&~(1<<32-rn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=uo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=A2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},I2={readContext:Wr,useCallback:A1,useContext:Wr,useEffect:bf,useImperativeHandle:j1,useInsertionEffect:E1,useLayoutEffect:T1,useMemo:C1,useReducer:Wu,useRef:S1,useState:function(){return Wu(ho)},useDebugValue:Of,useDeferredValue:function(e){var t=zr();return N1(t,Ot.memoizedState,e)},useTransition:function(){var e=Wu(ho)[0],t=zr().memoizedState;return[e,t]},useMutableSource:m1,useSyncExternalStore:g1,useId:b1,unstable_isNewReconciler:!1},P2={readContext:Wr,useCallback:A1,useContext:Wr,useEffect:bf,useImperativeHandle:j1,useInsertionEffect:E1,useLayoutEffect:T1,useMemo:C1,useReducer:zu,useRef:S1,useState:function(){return zu(ho)},useDebugValue:Of,useDeferredValue:function(e){var t=zr();return Ot===null?t.memoizedState=e:N1(t,Ot.memoizedState,e)},useTransition:function(){var e=zu(ho)[0],t=zr().memoizedState;return[e,t]},useMutableSource:m1,useSyncExternalStore:g1,useId:b1,unstable_isNewReconciler:!1};function Gs(e,t){try{var r="",n=t;do r+=oS(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Hu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function uh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var R2=typeof WeakMap=="function"?WeakMap:Map;function R1(e,t,r){r=Sn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){pc||(pc=!0,wh=n),uh(e,t)},r}function D1(e,t,r){r=Sn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){uh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){uh(e,t),typeof n!="function"&&(ri===null?ri=new Set([this]):ri.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function bp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new R2;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=J2.bind(null,e,t,r),t.then(e,e))}function Op(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ip(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Sn(-1,1),t.tag=2,ti(r,t,1))),r.lanes|=1),e)}var D2=In.ReactCurrentOwner,fr=!1;function ir(e,t,r,n){t.child=e===null?f1(t,null,r,n):Hs(t,e.child,r,n)}function Pp(e,t,r,n,i){r=r.render;var s=t.ref;return Rs(t,i),n=Cf(e,t,r,n,s,i),r=Nf(),e!==null&&!fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Nn(e,t,i)):(ot&&r&&gf(t),t.flags|=1,ir(e,t,n,i),t.child)}function Rp(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Bf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,F1(e,t,s,n,i)):(e=Hl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:io,r(a,n)&&e.ref===t.ref)return Nn(e,t,i)}return t.flags|=1,e=ii(s,n),e.ref=t.ref,e.return=t,t.child=e}function F1(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(io(s,n)&&e.ref===t.ref)if(fr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(fr=!0);else return t.lanes=e.lanes,Nn(e,t,i)}return dh(e,t,r,n,i)}function L1(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt(Cs,Sr),Sr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rt(Cs,Sr),Sr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,rt(Cs,Sr),Sr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,rt(Cs,Sr),Sr|=n;return ir(e,t,i,r),t.child}function M1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function dh(e,t,r,n,i){var s=mr(r)?Li:tr.current;return s=Ws(t,s),Rs(t,i),r=Cf(e,t,r,n,s,i),n=Nf(),e!==null&&!fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Nn(e,t,i)):(ot&&n&&gf(t),t.flags|=1,ir(e,t,r,i),t.child)}function Dp(e,t,r,n,i){if(mr(r)){var s=!0;ic(t)}else s=!1;if(Rs(t,i),t.stateNode===null)$l(e,t),d1(t,r,n),ch(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Wr(u):(u=mr(r)?Li:tr.current,u=Ws(t,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==u)&&jp(t,a,n,u),Wn=!1;var p=t.memoizedState;a.state=p,cc(t,n,a,i),c=t.memoizedState,l!==n||p!==c||pr.current||Wn?(typeof d=="function"&&(lh(t,r,d,n),c=t.memoizedState),(l=Wn||kp(t,r,l,n,p,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=u,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,c1(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Yr(t.type,l),a.props=u,h=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=Wr(c):(c=mr(r)?Li:tr.current,c=Ws(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||p!==c)&&jp(t,a,n,c),Wn=!1,p=t.memoizedState,a.state=p,cc(t,n,a,i);var y=t.memoizedState;l!==h||p!==y||pr.current||Wn?(typeof m=="function"&&(lh(t,r,m,n),y=t.memoizedState),(u=Wn||kp(t,r,u,n,p,y,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),a.props=n,a.state=y,a.context=c,n=u):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return hh(e,t,r,n,s,i)}function hh(e,t,r,n,i,s){M1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&wp(t,r,!1),Nn(e,t,s);n=t.stateNode,D2.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Hs(t,e.child,null,s),t.child=Hs(t,null,l,s)):ir(e,t,l,s),t.memoizedState=n.state,i&&wp(t,r,!0),t.child}function B1(e){var t=e.stateNode;t.pendingContext?yp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yp(e,t.context,!1),Tf(e,t.containerInfo)}function Fp(e,t,r,n,i){return zs(),vf(i),t.flags|=256,ir(e,t,r,n),t.child}var fh={dehydrated:null,treeContext:null,retryLane:0};function ph(e){return{baseLanes:e,cachePool:null,transitions:null}}function U1(e,t,r){var n=t.pendingProps,i=ht.current,s=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),rt(ht,i&1),e===null)return ah(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=qc(a,n,0,null),e=Di(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ph(r),t.memoizedState=fh,e):If(t,a));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return F2(e,t,a,n,l,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ii(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ii(l,s):(s=Di(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?ph(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=fh,n}return s=e.child,e=s.sibling,n=ii(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function If(e,t){return t=qc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rl(e,t,r,n){return n!==null&&vf(n),Hs(t,e.child,null,r),e=If(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function F2(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Hu(Error(pe(422))),rl(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=qc({mode:"visible",children:n.children},i,0,null),s=Di(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Hs(t,e.child,null,a),t.child.memoizedState=ph(a),t.memoizedState=fh,s);if(!(t.mode&1))return rl(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(pe(419)),n=Hu(s,n,void 0),rl(e,t,a,n)}if(l=(a&e.childLanes)!==0,fr||l){if(n=Lt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Cn(e,i),nn(n,e,i,-1))}return Mf(),n=Hu(Error(pe(421))),rl(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=X2.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Cr=ei(i.nextSibling),Nr=t,ot=!0,Zr=null,e!==null&&(Mr[Br++]=wn,Mr[Br++]=_n,Mr[Br++]=Mi,wn=e.id,_n=e.overflow,Mi=t),t=If(t,n.children),t.flags|=4096,t)}function Lp(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),oh(e.return,t,r)}function Vu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function $1(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(ir(e,t,n.children,r),n=ht.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lp(e,r,t);else if(e.tag===19)Lp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(rt(ht,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&uc(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Vu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&uc(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Vu(t,!0,r,null,s);break;case"together":Vu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Nn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ui|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,r=ii(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ii(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function L2(e,t,r){switch(t.tag){case 3:B1(t),zs();break;case 5:p1(t);break;case 1:mr(t.type)&&ic(t);break;case 4:Tf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;rt(oc,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(rt(ht,ht.current&1),t.flags|=128,null):r&t.child.childLanes?U1(e,t,r):(rt(ht,ht.current&1),e=Nn(e,t,r),e!==null?e.sibling:null);rt(ht,ht.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return $1(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rt(ht,ht.current),n)break;return null;case 22:case 23:return t.lanes=0,L1(e,t,r)}return Nn(e,t,r)}var W1,mh,z1,H1;W1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};mh=function(){};z1=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ii(fn.current);var s=null;switch(r){case"input":i=Ld(e,i),n=Ld(e,n),s=[];break;case"select":i=pt({},i,{value:void 0}),n=pt({},n,{value:void 0}),s=[];break;case"textarea":i=Ud(e,i),n=Ud(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=rc)}Wd(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qa.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qa.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&nt("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};H1=function(e,t,r,n){r!==n&&(t.flags|=4)};function ya(e,t){if(!ot)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function M2(e,t,r){var n=t.pendingProps;switch(xf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(t),null;case 1:return mr(t.type)&&nc(),Xt(t),null;case 3:return n=t.stateNode,Vs(),it(pr),it(tr),jf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(el(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zr!==null&&(Eh(Zr),Zr=null))),mh(e,t),Xt(t),null;case 5:kf(t);var i=Ii(co.current);if(r=t.type,e!==null&&t.stateNode!=null)z1(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pe(166));return Xt(t),null}if(e=Ii(fn.current),el(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[dn]=t,n[oo]=s,e=(t.mode&1)!==0,r){case"dialog":nt("cancel",n),nt("close",n);break;case"iframe":case"object":case"embed":nt("load",n);break;case"video":case"audio":for(i=0;i<ba.length;i++)nt(ba[i],n);break;case"source":nt("error",n);break;case"img":case"image":case"link":nt("error",n),nt("load",n);break;case"details":nt("toggle",n);break;case"input":G0(n,s),nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},nt("invalid",n);break;case"textarea":J0(n,s),nt("invalid",n)}Wd(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Zo(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Zo(n.textContent,l,e),i=["children",""+l]):qa.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&nt("scroll",n)}switch(r){case"input":Vo(n),K0(n,s,!0);break;case"textarea":Vo(n),X0(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=rc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=xx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[dn]=t,e[oo]=n,W1(e,t,!1,!1),t.stateNode=e;e:{switch(a=zd(r,n),r){case"dialog":nt("cancel",e),nt("close",e),i=n;break;case"iframe":case"object":case"embed":nt("load",e),i=n;break;case"video":case"audio":for(i=0;i<ba.length;i++)nt(ba[i],e);i=n;break;case"source":nt("error",e),i=n;break;case"img":case"image":case"link":nt("error",e),nt("load",e),i=n;break;case"details":nt("toggle",e),i=n;break;case"input":G0(e,n),i=Ld(e,n),nt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=pt({},n,{value:void 0}),nt("invalid",e);break;case"textarea":J0(e,n),i=Ud(e,n),nt("invalid",e);break;default:i=n}Wd(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?wx(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vx(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Qa(e,c):typeof c=="number"&&Qa(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qa.hasOwnProperty(s)?c!=null&&s==="onScroll"&&nt("scroll",e):c!=null&&tf(e,s,c,a))}switch(r){case"input":Vo(e),K0(e,n,!1);break;case"textarea":Vo(e),X0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ai(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?bs(e,!!n.multiple,s,!1):n.defaultValue!=null&&bs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=rc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Xt(t),null;case 6:if(e&&t.stateNode!=null)H1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pe(166));if(r=Ii(co.current),Ii(fn.current),el(t)){if(n=t.stateNode,r=t.memoizedProps,n[dn]=t,(s=n.nodeValue!==r)&&(e=Nr,e!==null))switch(e.tag){case 3:Zo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Zo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[dn]=t,t.stateNode=n}return Xt(t),null;case 13:if(it(ht),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ot&&Cr!==null&&t.mode&1&&!(t.flags&128))o1(),zs(),t.flags|=98560,s=!1;else if(s=el(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(pe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(pe(317));s[dn]=t}else zs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Xt(t),s=!1}else Zr!==null&&(Eh(Zr),Zr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ht.current&1?It===0&&(It=3):Mf())),t.updateQueue!==null&&(t.flags|=4),Xt(t),null);case 4:return Vs(),mh(e,t),e===null&&so(t.stateNode.containerInfo),Xt(t),null;case 10:return _f(t.type._context),Xt(t),null;case 17:return mr(t.type)&&nc(),Xt(t),null;case 19:if(it(ht),s=t.memoizedState,s===null)return Xt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)ya(s,!1);else{if(It!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=uc(e),a!==null){for(t.flags|=128,ya(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return rt(ht,ht.current&1|2),t.child}e=e.sibling}s.tail!==null&&wt()>Ks&&(t.flags|=128,n=!0,ya(s,!1),t.lanes=4194304)}else{if(!n)if(e=uc(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ya(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ot)return Xt(t),null}else 2*wt()-s.renderingStartTime>Ks&&r!==1073741824&&(t.flags|=128,n=!0,ya(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=wt(),t.sibling=null,r=ht.current,rt(ht,n?r&1|2:r&1),t):(Xt(t),null);case 22:case 23:return Lf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sr&1073741824&&(Xt(t),t.subtreeFlags&6&&(t.flags|=8192)):Xt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function B2(e,t){switch(xf(t),t.tag){case 1:return mr(t.type)&&nc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Vs(),it(pr),it(tr),jf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return kf(t),null;case 13:if(it(ht),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));zs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(ht),null;case 4:return Vs(),null;case 10:return _f(t.type._context),null;case 22:case 23:return Lf(),null;case 24:return null;default:return null}}var nl=!1,Qt=!1,U2=typeof WeakSet=="function"?WeakSet:Set,ke=null;function As(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mt(e,t,n)}else r.current=null}function gh(e,t,r){try{r()}catch(n){mt(e,t,n)}}var Mp=!1;function $2(e,t){if(Zd=Zl,e=Jx(),mf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(l=a+i),h!==s||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===e)break t;if(p===r&&++u===i&&(l=a),p===s&&++d===n&&(c=a),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(eh={focusedElem:e,selectionRange:r},Zl=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var f=y.memoizedProps,g=y.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?f:Yr(t.type,f),g);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(E){mt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return y=Mp,Mp=!1,y}function Ua(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&gh(t,r,s)}i=i.next}while(i!==n)}}function Xc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function xh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function V1(e){var t=e.alternate;t!==null&&(e.alternate=null,V1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[dn],delete t[oo],delete t[nh],delete t[E2],delete t[T2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function G1(e){return e.tag===5||e.tag===3||e.tag===4}function Bp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||G1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=rc));else if(n!==4&&(e=e.child,e!==null))for(vh(e,t,r),e=e.sibling;e!==null;)vh(e,t,r),e=e.sibling}function yh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(yh(e,t,r),e=e.sibling;e!==null;)yh(e,t,r),e=e.sibling}var Bt=null,Qr=!1;function Rn(e,t,r){for(r=r.child;r!==null;)K1(e,t,r),r=r.sibling}function K1(e,t,r){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount($c,r)}catch{}switch(r.tag){case 5:Qt||As(r,t);case 6:var n=Bt,i=Qr;Bt=null,Rn(e,t,r),Bt=n,Qr=i,Bt!==null&&(Qr?(e=Bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bt.removeChild(r.stateNode));break;case 18:Bt!==null&&(Qr?(e=Bt,r=r.stateNode,e.nodeType===8?Mu(e.parentNode,r):e.nodeType===1&&Mu(e,r),ro(e)):Mu(Bt,r.stateNode));break;case 4:n=Bt,i=Qr,Bt=r.stateNode.containerInfo,Qr=!0,Rn(e,t,r),Bt=n,Qr=i;break;case 0:case 11:case 14:case 15:if(!Qt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&gh(r,t,a),i=i.next}while(i!==n)}Rn(e,t,r);break;case 1:if(!Qt&&(As(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){mt(r,t,l)}Rn(e,t,r);break;case 21:Rn(e,t,r);break;case 22:r.mode&1?(Qt=(n=Qt)||r.memoizedState!==null,Rn(e,t,r),Qt=n):Rn(e,t,r);break;default:Rn(e,t,r)}}function Up(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new U2),t.forEach(function(n){var i=Y2.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Vr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:Bt=l.stateNode,Qr=!1;break e;case 3:Bt=l.stateNode.containerInfo,Qr=!0;break e;case 4:Bt=l.stateNode.containerInfo,Qr=!0;break e}l=l.return}if(Bt===null)throw Error(pe(160));K1(s,a,i),Bt=null,Qr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){mt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)J1(t,e),t=t.sibling}function J1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vr(t,e),on(e),n&4){try{Ua(3,e,e.return),Xc(3,e)}catch(f){mt(e,e.return,f)}try{Ua(5,e,e.return)}catch(f){mt(e,e.return,f)}}break;case 1:Vr(t,e),on(e),n&512&&r!==null&&As(r,r.return);break;case 5:if(Vr(t,e),on(e),n&512&&r!==null&&As(r,r.return),e.flags&32){var i=e.stateNode;try{Qa(i,"")}catch(f){mt(e,e.return,f)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&mx(i,s),zd(l,a);var u=zd(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?wx(i,h):d==="dangerouslySetInnerHTML"?vx(i,h):d==="children"?Qa(i,h):tf(i,d,h,u)}switch(l){case"input":Md(i,s);break;case"textarea":gx(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?bs(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?bs(i,!!s.multiple,s.defaultValue,!0):bs(i,!!s.multiple,s.multiple?[]:"",!1))}i[oo]=s}catch(f){mt(e,e.return,f)}}break;case 6:if(Vr(t,e),on(e),n&4){if(e.stateNode===null)throw Error(pe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(f){mt(e,e.return,f)}}break;case 3:if(Vr(t,e),on(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ro(t.containerInfo)}catch(f){mt(e,e.return,f)}break;case 4:Vr(t,e),on(e);break;case 13:Vr(t,e),on(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Df=wt())),n&4&&Up(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Qt=(u=Qt)||d,Vr(t,e),Qt=u):Vr(t,e),on(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ke=e,d=e.child;d!==null;){for(h=ke=d;ke!==null;){switch(p=ke,m=p.child,p.tag){case 0:case 11:case 14:case 15:Ua(4,p,p.return);break;case 1:As(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(f){mt(n,r,f)}}break;case 5:As(p,p.return);break;case 22:if(p.memoizedState!==null){Wp(h);continue}}m!==null?(m.return=p,ke=m):Wp(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=yx("display",a))}catch(f){mt(e,e.return,f)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(f){mt(e,e.return,f)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vr(t,e),on(e),n&4&&Up(e);break;case 21:break;default:Vr(t,e),on(e)}}function on(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(G1(r)){var n=r;break e}r=r.return}throw Error(pe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Qa(i,""),n.flags&=-33);var s=Bp(e);yh(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,l=Bp(e);vh(e,l,a);break;default:throw Error(pe(161))}}catch(c){mt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function W2(e,t,r){ke=e,X1(e)}function X1(e,t,r){for(var n=(e.mode&1)!==0;ke!==null;){var i=ke,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||nl;if(!a){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Qt;l=nl;var u=Qt;if(nl=a,(Qt=c)&&!u)for(ke=i;ke!==null;)a=ke,c=a.child,a.tag===22&&a.memoizedState!==null?zp(i):c!==null?(c.return=a,ke=c):zp(i);for(;s!==null;)ke=s,X1(s),s=s.sibling;ke=i,nl=l,Qt=u}$p(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ke=s):$p(e)}}function $p(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Qt||Xc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Qt)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Yr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Tp(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Tp(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ro(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Qt||t.flags&512&&xh(t)}catch(p){mt(t,t.return,p)}}if(t===e){ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,ke=r;break}ke=t.return}}function Wp(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ke=r;break}ke=t.return}}function zp(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Xc(4,t)}catch(c){mt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){mt(t,i,c)}}var s=t.return;try{xh(t)}catch(c){mt(t,s,c)}break;case 5:var a=t.return;try{xh(t)}catch(c){mt(t,a,c)}}}catch(c){mt(t,t.return,c)}if(t===e){ke=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ke=l;break}ke=t.return}}var z2=Math.ceil,fc=In.ReactCurrentDispatcher,Pf=In.ReactCurrentOwner,$r=In.ReactCurrentBatchConfig,ze=0,Lt=null,kt=null,zt=0,Sr=0,Cs=hi(0),It=0,po=null,Ui=0,Yc=0,Rf=0,$a=null,hr=null,Df=0,Ks=1/0,xn=null,pc=!1,wh=null,ri=null,il=!1,Kn=null,mc=0,Wa=0,_h=null,Wl=-1,zl=0;function lr(){return ze&6?wt():Wl!==-1?Wl:Wl=wt()}function ni(e){return e.mode&1?ze&2&&zt!==0?zt&-zt:j2.transition!==null?(zl===0&&(zl=Ix()),zl):(e=Ye,e!==0||(e=window.event,e=e===void 0?16:Bx(e.type)),e):1}function nn(e,t,r,n){if(50<Wa)throw Wa=0,_h=null,Error(pe(185));Co(e,r,n),(!(ze&2)||e!==Lt)&&(e===Lt&&(!(ze&2)&&(Yc|=r),It===4&&Hn(e,zt)),gr(e,n),r===1&&ze===0&&!(t.mode&1)&&(Ks=wt()+500,Gc&&fi()))}function gr(e,t){var r=e.callbackNode;jS(e,t);var n=Ql(e,e===Lt?zt:0);if(n===0)r!==null&&Q0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Q0(r),t===1)e.tag===0?k2(Hp.bind(null,e)):i1(Hp.bind(null,e)),_2(function(){!(ze&6)&&fi()}),r=null;else{switch(Px(n)){case 1:r=of;break;case 4:r=bx;break;case 16:r=ql;break;case 536870912:r=Ox;break;default:r=ql}r=nv(r,Y1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Y1(e,t){if(Wl=-1,zl=0,ze&6)throw Error(pe(327));var r=e.callbackNode;if(Ds()&&e.callbackNode!==r)return null;var n=Ql(e,e===Lt?zt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=gc(e,n);else{t=n;var i=ze;ze|=2;var s=Q1();(Lt!==e||zt!==t)&&(xn=null,Ks=wt()+500,Ri(e,t));do try{G2();break}catch(l){q1(e,l)}while(!0);wf(),fc.current=s,ze=i,kt!==null?t=0:(Lt=null,zt=0,t=It)}if(t!==0){if(t===2&&(i=Jd(e),i!==0&&(n=i,t=Sh(e,i))),t===1)throw r=po,Ri(e,0),Hn(e,n),gr(e,wt()),r;if(t===6)Hn(e,n);else{if(i=e.current.alternate,!(n&30)&&!H2(i)&&(t=gc(e,n),t===2&&(s=Jd(e),s!==0&&(n=s,t=Sh(e,s))),t===1))throw r=po,Ri(e,0),Hn(e,n),gr(e,wt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(pe(345));case 2:Ti(e,hr,xn);break;case 3:if(Hn(e,n),(n&130023424)===n&&(t=Df+500-wt(),10<t)){if(Ql(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){lr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=rh(Ti.bind(null,e,hr,xn),t);break}Ti(e,hr,xn);break;case 4:if(Hn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-rn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=wt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*z2(n/1960))-n,10<n){e.timeoutHandle=rh(Ti.bind(null,e,hr,xn),n);break}Ti(e,hr,xn);break;case 5:Ti(e,hr,xn);break;default:throw Error(pe(329))}}}return gr(e,wt()),e.callbackNode===r?Y1.bind(null,e):null}function Sh(e,t){var r=$a;return e.current.memoizedState.isDehydrated&&(Ri(e,t).flags|=256),e=gc(e,t),e!==2&&(t=hr,hr=r,t!==null&&Eh(t)),e}function Eh(e){hr===null?hr=e:hr.push.apply(hr,e)}function H2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!an(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hn(e,t){for(t&=~Rf,t&=~Yc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-rn(t),n=1<<r;e[r]=-1,t&=~n}}function Hp(e){if(ze&6)throw Error(pe(327));Ds();var t=Ql(e,0);if(!(t&1))return gr(e,wt()),null;var r=gc(e,t);if(e.tag!==0&&r===2){var n=Jd(e);n!==0&&(t=n,r=Sh(e,n))}if(r===1)throw r=po,Ri(e,0),Hn(e,t),gr(e,wt()),r;if(r===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ti(e,hr,xn),gr(e,wt()),null}function Ff(e,t){var r=ze;ze|=1;try{return e(t)}finally{ze=r,ze===0&&(Ks=wt()+500,Gc&&fi())}}function $i(e){Kn!==null&&Kn.tag===0&&!(ze&6)&&Ds();var t=ze;ze|=1;var r=$r.transition,n=Ye;try{if($r.transition=null,Ye=1,e)return e()}finally{Ye=n,$r.transition=r,ze=t,!(ze&6)&&fi()}}function Lf(){Sr=Cs.current,it(Cs)}function Ri(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,w2(r)),kt!==null)for(r=kt.return;r!==null;){var n=r;switch(xf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&nc();break;case 3:Vs(),it(pr),it(tr),jf();break;case 5:kf(n);break;case 4:Vs();break;case 13:it(ht);break;case 19:it(ht);break;case 10:_f(n.type._context);break;case 22:case 23:Lf()}r=r.return}if(Lt=e,kt=e=ii(e.current,null),zt=Sr=t,It=0,po=null,Rf=Yc=Ui=0,hr=$a=null,Oi!==null){for(t=0;t<Oi.length;t++)if(r=Oi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Oi=null}return e}function q1(e,t){do{var r=kt;try{if(wf(),Bl.current=hc,dc){for(var n=ft.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}dc=!1}if(Bi=0,Pt=Ot=ft=null,Ba=!1,uo=0,Pf.current=null,r===null||r.return===null){It=1,po=t,kt=null;break}e:{var s=e,a=r.return,l=r,c=t;if(t=zt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=Op(a);if(m!==null){m.flags&=-257,Ip(m,a,l,s,t),m.mode&1&&bp(s,u,t),t=m,c=u;var y=t.updateQueue;if(y===null){var f=new Set;f.add(c),t.updateQueue=f}else y.add(c);break e}else{if(!(t&1)){bp(s,u,t),Mf();break e}c=Error(pe(426))}}else if(ot&&l.mode&1){var g=Op(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Ip(g,a,l,s,t),vf(Gs(c,l));break e}}s=c=Gs(c,l),It!==4&&(It=2),$a===null?$a=[s]:$a.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=R1(s,c,t);Ep(s,v);break e;case 1:l=c;var x=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ri===null||!ri.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=D1(s,l,t);Ep(s,E);break e}}s=s.return}while(s!==null)}ev(r)}catch(C){t=C,kt===r&&r!==null&&(kt=r=r.return);continue}break}while(!0)}function Q1(){var e=fc.current;return fc.current=hc,e===null?hc:e}function Mf(){(It===0||It===3||It===2)&&(It=4),Lt===null||!(Ui&268435455)&&!(Yc&268435455)||Hn(Lt,zt)}function gc(e,t){var r=ze;ze|=2;var n=Q1();(Lt!==e||zt!==t)&&(xn=null,Ri(e,t));do try{V2();break}catch(i){q1(e,i)}while(!0);if(wf(),ze=r,fc.current=n,kt!==null)throw Error(pe(261));return Lt=null,zt=0,It}function V2(){for(;kt!==null;)Z1(kt)}function G2(){for(;kt!==null&&!xS();)Z1(kt)}function Z1(e){var t=rv(e.alternate,e,Sr);e.memoizedProps=e.pendingProps,t===null?ev(e):kt=t,Pf.current=null}function ev(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=B2(r,t),r!==null){r.flags&=32767,kt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{It=6,kt=null;return}}else if(r=M2(r,t,Sr),r!==null){kt=r;return}if(t=t.sibling,t!==null){kt=t;return}kt=t=e}while(t!==null);It===0&&(It=5)}function Ti(e,t,r){var n=Ye,i=$r.transition;try{$r.transition=null,Ye=1,K2(e,t,r,n)}finally{$r.transition=i,Ye=n}return null}function K2(e,t,r,n){do Ds();while(Kn!==null);if(ze&6)throw Error(pe(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(AS(e,s),e===Lt&&(kt=Lt=null,zt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||il||(il=!0,nv(ql,function(){return Ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=$r.transition,$r.transition=null;var a=Ye;Ye=1;var l=ze;ze|=4,Pf.current=null,$2(e,r),J1(r,e),f2(eh),Zl=!!Zd,eh=Zd=null,e.current=r,W2(r),vS(),ze=l,Ye=a,$r.transition=s}else e.current=r;if(il&&(il=!1,Kn=e,mc=i),s=e.pendingLanes,s===0&&(ri=null),_S(r.stateNode),gr(e,wt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(pc)throw pc=!1,e=wh,wh=null,e;return mc&1&&e.tag!==0&&Ds(),s=e.pendingLanes,s&1?e===_h?Wa++:(Wa=0,_h=e):Wa=0,fi(),null}function Ds(){if(Kn!==null){var e=Px(mc),t=$r.transition,r=Ye;try{if($r.transition=null,Ye=16>e?16:e,Kn===null)var n=!1;else{if(e=Kn,Kn=null,mc=0,ze&6)throw Error(pe(331));var i=ze;for(ze|=4,ke=e.current;ke!==null;){var s=ke,a=s.child;if(ke.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ke=u;ke!==null;){var d=ke;switch(d.tag){case 0:case 11:case 15:Ua(8,d,s)}var h=d.child;if(h!==null)h.return=d,ke=h;else for(;ke!==null;){d=ke;var p=d.sibling,m=d.return;if(V1(d),d===u){ke=null;break}if(p!==null){p.return=m,ke=p;break}ke=m}}}var y=s.alternate;if(y!==null){var f=y.child;if(f!==null){y.child=null;do{var g=f.sibling;f.sibling=null,f=g}while(f!==null)}}ke=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ke=a;else e:for(;ke!==null;){if(s=ke,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ua(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ke=v;break e}ke=s.return}}var x=e.current;for(ke=x;ke!==null;){a=ke;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,ke=w;else e:for(a=x;ke!==null;){if(l=ke,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Xc(9,l)}}catch(C){mt(l,l.return,C)}if(l===a){ke=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,ke=E;break e}ke=l.return}}if(ze=i,fi(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot($c,e)}catch{}n=!0}return n}finally{Ye=r,$r.transition=t}}return!1}function Vp(e,t,r){t=Gs(r,t),t=R1(e,t,1),e=ti(e,t,1),t=lr(),e!==null&&(Co(e,1,t),gr(e,t))}function mt(e,t,r){if(e.tag===3)Vp(e,e,r);else for(;t!==null;){if(t.tag===3){Vp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ri===null||!ri.has(n))){e=Gs(r,e),e=D1(t,e,1),t=ti(t,e,1),e=lr(),t!==null&&(Co(t,1,e),gr(t,e));break}}t=t.return}}function J2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=lr(),e.pingedLanes|=e.suspendedLanes&r,Lt===e&&(zt&r)===r&&(It===4||It===3&&(zt&130023424)===zt&&500>wt()-Df?Ri(e,0):Rf|=r),gr(e,t)}function tv(e,t){t===0&&(e.mode&1?(t=Jo,Jo<<=1,!(Jo&130023424)&&(Jo=4194304)):t=1);var r=lr();e=Cn(e,t),e!==null&&(Co(e,t,r),gr(e,r))}function X2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),tv(e,r)}function Y2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pe(314))}n!==null&&n.delete(t),tv(e,r)}var rv;rv=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||pr.current)fr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fr=!1,L2(e,t,r);fr=!!(e.flags&131072)}else fr=!1,ot&&t.flags&1048576&&s1(t,ac,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$l(e,t),e=t.pendingProps;var i=Ws(t,tr.current);Rs(t,r),i=Cf(null,t,n,e,i,r);var s=Nf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mr(n)?(s=!0,ic(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ef(t),i.updater=Kc,t.stateNode=i,i._reactInternals=t,ch(t,n,e,r),t=hh(null,t,n,!0,s,r)):(t.tag=0,ot&&s&&gf(t),ir(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch($l(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Q2(n),e=Yr(n,e),i){case 0:t=dh(null,t,n,e,r);break e;case 1:t=Dp(null,t,n,e,r);break e;case 11:t=Pp(null,t,n,e,r);break e;case 14:t=Rp(null,t,n,Yr(n.type,e),r);break e}throw Error(pe(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Yr(n,i),dh(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Yr(n,i),Dp(e,t,n,i,r);case 3:e:{if(B1(t),e===null)throw Error(pe(387));n=t.pendingProps,s=t.memoizedState,i=s.element,c1(e,t),cc(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Gs(Error(pe(423)),t),t=Fp(e,t,n,r,i);break e}else if(n!==i){i=Gs(Error(pe(424)),t),t=Fp(e,t,n,r,i);break e}else for(Cr=ei(t.stateNode.containerInfo.firstChild),Nr=t,ot=!0,Zr=null,r=f1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zs(),n===i){t=Nn(e,t,r);break e}ir(e,t,n,r)}t=t.child}return t;case 5:return p1(t),e===null&&ah(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,th(n,i)?a=null:s!==null&&th(n,s)&&(t.flags|=32),M1(e,t),ir(e,t,a,r),t.child;case 6:return e===null&&ah(t),null;case 13:return U1(e,t,r);case 4:return Tf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Hs(t,null,n,r):ir(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Yr(n,i),Pp(e,t,n,i,r);case 7:return ir(e,t,t.pendingProps,r),t.child;case 8:return ir(e,t,t.pendingProps.children,r),t.child;case 12:return ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,rt(oc,n._currentValue),n._currentValue=a,s!==null)if(an(s.value,a)){if(s.children===i.children&&!pr.current){t=Nn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Sn(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),oh(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(pe(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),oh(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ir(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Rs(t,r),i=Wr(i),n=n(i),t.flags|=1,ir(e,t,n,r),t.child;case 14:return n=t.type,i=Yr(n,t.pendingProps),i=Yr(n.type,i),Rp(e,t,n,i,r);case 15:return F1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Yr(n,i),$l(e,t),t.tag=1,mr(n)?(e=!0,ic(t)):e=!1,Rs(t,r),d1(t,n,i),ch(t,n,i,r),hh(null,t,n,!0,e,r);case 19:return $1(e,t,r);case 22:return L1(e,t,r)}throw Error(pe(156,t.tag))};function nv(e,t){return Nx(e,t)}function q2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(e,t,r,n){return new q2(e,t,r,n)}function Bf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Q2(e){if(typeof e=="function")return Bf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nf)return 11;if(e===sf)return 14}return 2}function ii(e,t){var r=e.alternate;return r===null?(r=Ur(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Hl(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Bf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case vs:return Di(r.children,i,s,t);case rf:a=8,i|=8;break;case Pd:return e=Ur(12,r,t,i|2),e.elementType=Pd,e.lanes=s,e;case Rd:return e=Ur(13,r,t,i),e.elementType=Rd,e.lanes=s,e;case Dd:return e=Ur(19,r,t,i),e.elementType=Dd,e.lanes=s,e;case hx:return qc(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ux:a=10;break e;case dx:a=9;break e;case nf:a=11;break e;case sf:a=14;break e;case $n:a=16,n=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Ur(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Di(e,t,r,n){return e=Ur(7,e,n,t),e.lanes=r,e}function qc(e,t,r,n){return e=Ur(22,e,n,t),e.elementType=hx,e.lanes=r,e.stateNode={isHidden:!1},e}function Gu(e,t,r){return e=Ur(6,e,null,t),e.lanes=r,e}function Ku(e,t,r){return t=Ur(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Z2(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Au(0),this.expirationTimes=Au(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Au(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uf(e,t,r,n,i,s,a,l,c){return e=new Z2(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ur(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ef(s),e}function eE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function iv(e){if(!e)return oi;e=e._reactInternals;e:{if(Gi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var r=e.type;if(mr(r))return n1(e,r,t)}return t}function sv(e,t,r,n,i,s,a,l,c){return e=Uf(r,n,!0,e,i,s,a,l,c),e.context=iv(null),r=e.current,n=lr(),i=ni(r),s=Sn(n,i),s.callback=t??null,ti(r,s,i),e.current.lanes=i,Co(e,i,n),gr(e,n),e}function Qc(e,t,r,n){var i=t.current,s=lr(),a=ni(i);return r=iv(r),t.context===null?t.context=r:t.pendingContext=r,t=Sn(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ti(i,t,a),e!==null&&(nn(e,i,a,s),Ml(e,i,a)),a}function xc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function $f(e,t){Gp(e,t),(e=e.alternate)&&Gp(e,t)}function tE(){return null}var av=typeof reportError=="function"?reportError:function(e){console.error(e)};function Wf(e){this._internalRoot=e}Zc.prototype.render=Wf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Qc(e,t,null,null)};Zc.prototype.unmount=Wf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$i(function(){Qc(null,e,null,null)}),t[An]=null}};function Zc(e){this._internalRoot=e}Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zn.length&&t!==0&&t<zn[r].priority;r++);zn.splice(r,0,e),r===0&&Mx(e)}};function zf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kp(){}function rE(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=xc(a);s.call(u)}}var a=sv(t,n,e,0,null,!1,!1,"",Kp);return e._reactRootContainer=a,e[An]=a.current,so(e.nodeType===8?e.parentNode:e),$i(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=xc(c);l.call(u)}}var c=Uf(e,0,!1,null,null,!1,!1,"",Kp);return e._reactRootContainer=c,e[An]=c.current,so(e.nodeType===8?e.parentNode:e),$i(function(){Qc(t,c,r,n)}),c}function tu(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var c=xc(a);l.call(c)}}Qc(t,a,e,i)}else a=rE(r,t,e,i,n);return xc(a)}Rx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Na(t.pendingLanes);r!==0&&(lf(t,r|1),gr(t,wt()),!(ze&6)&&(Ks=wt()+500,fi()))}break;case 13:$i(function(){var n=Cn(e,1);if(n!==null){var i=lr();nn(n,e,1,i)}}),$f(e,1)}};cf=function(e){if(e.tag===13){var t=Cn(e,134217728);if(t!==null){var r=lr();nn(t,e,134217728,r)}$f(e,134217728)}};Dx=function(e){if(e.tag===13){var t=ni(e),r=Cn(e,t);if(r!==null){var n=lr();nn(r,e,t,n)}$f(e,t)}};Fx=function(){return Ye};Lx=function(e,t){var r=Ye;try{return Ye=e,t()}finally{Ye=r}};Vd=function(e,t,r){switch(t){case"input":if(Md(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Vc(n);if(!i)throw Error(pe(90));px(n),Md(n,i)}}}break;case"textarea":gx(e,r);break;case"select":t=r.value,t!=null&&bs(e,!!r.multiple,t,!1)}};Ex=Ff;Tx=$i;var nE={usingClientEntryPoint:!1,Events:[bo,Ss,Vc,_x,Sx,Ff]},wa={findFiberByHostInstance:bi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iE={bundleType:wa.bundleType,version:wa.version,rendererPackageName:wa.rendererPackageName,rendererConfig:wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:In.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ax(e),e===null?null:e.stateNode},findFiberByHostInstance:wa.findFiberByHostInstance||tE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sl.isDisabled&&sl.supportsFiber)try{$c=sl.inject(iE),hn=sl}catch{}}Ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nE;Ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zf(t))throw Error(pe(200));return eE(e,t,null,r)};Ir.createRoot=function(e,t){if(!zf(e))throw Error(pe(299));var r=!1,n="",i=av;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Uf(e,1,!1,null,null,r,!1,n,i),e[An]=t.current,so(e.nodeType===8?e.parentNode:e),new Wf(t)};Ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=Ax(t),e=e===null?null:e.stateNode,e};Ir.flushSync=function(e){return $i(e)};Ir.hydrate=function(e,t,r){if(!eu(t))throw Error(pe(200));return tu(null,e,t,!0,r)};Ir.hydrateRoot=function(e,t,r){if(!zf(e))throw Error(pe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=av;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=sv(t,null,e,1,r??null,i,!1,s,a),e[An]=t.current,so(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Zc(t)};Ir.render=function(e,t,r){if(!eu(t))throw Error(pe(200));return tu(null,e,t,!1,r)};Ir.unmountComponentAtNode=function(e){if(!eu(e))throw Error(pe(40));return e._reactRootContainer?($i(function(){tu(null,null,e,!1,function(){e._reactRootContainer=null,e[An]=null})}),!0):!1};Ir.unstable_batchedUpdates=Ff;Ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!eu(r))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return tu(e,t,r,!1,n)};Ir.version="18.2.0-next-9e3b772b8-20220608";function ov(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ov)}catch(e){console.error(e)}}ov(),sx.exports=Ir;var sE=sx.exports,Jp=sE;Od.createRoot=Jp.createRoot,Od.hydrateRoot=Jp.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mo(){return mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mo.apply(this,arguments)}var Jn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Jn||(Jn={}));const Xp="popstate";function aE(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:l}=n.location;return Th("",{pathname:s,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:vc(i)}return lE(t,r,null,e)}function _t(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function lv(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function oE(){return Math.random().toString(36).substr(2,8)}function Yp(e,t){return{usr:e.state,key:e.key,idx:t}}function Th(e,t,r,n){return r===void 0&&(r=null),mo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Zs(t):t,{state:r,key:t&&t.key||n||oE()})}function vc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Zs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function lE(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,l=Jn.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(mo({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function h(){l=Jn.Pop;let g=d(),v=g==null?null:g-u;u=g,c&&c({action:l,location:f.location,delta:v})}function p(g,v){l=Jn.Push;let x=Th(f.location,g,v);u=d()+1;let w=Yp(x,u),E=f.createHref(x);try{a.pushState(w,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(E)}s&&c&&c({action:l,location:f.location,delta:1})}function m(g,v){l=Jn.Replace;let x=Th(f.location,g,v);u=d();let w=Yp(x,u),E=f.createHref(x);a.replaceState(w,"",E),s&&c&&c({action:l,location:f.location,delta:0})}function y(g){let v=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof g=="string"?g:vc(g);return x=x.replace(/ $/,"%20"),_t(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let f={get action(){return l},get location(){return e(i,a)},listen(g){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Xp,h),c=g,()=>{i.removeEventListener(Xp,h),c=null}},createHref(g){return t(i,g)},createURL:y,encodeLocation(g){let v=y(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:m,go(g){return a.go(g)}};return f}var qp;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(qp||(qp={}));function cE(e,t,r){return r===void 0&&(r="/"),uE(e,t,r)}function uE(e,t,r,n){let i=typeof t=="string"?Zs(t):t,s=Hf(i.pathname||"/",r);if(s==null)return null;let a=cv(e);dE(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=EE(s);l=wE(a[c],u)}return l}function cv(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};c.relativePath.startsWith("/")&&(_t(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=si([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(_t(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),cv(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:vE(u,s.index),routesMeta:d})};return e.forEach((s,a)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,a);else for(let c of uv(s.path))i(s,a,c)}),t}function uv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=uv(n.join("/")),l=[];return l.push(...a.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...a),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function dE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:yE(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const hE=/^:[\w-]+$/,fE=3,pE=2,mE=1,gE=10,xE=-2,Qp=e=>e==="*";function vE(e,t){let r=e.split("/"),n=r.length;return r.some(Qp)&&(n+=xE),t&&(n+=pE),r.filter(i=>!Qp(i)).reduce((i,s)=>i+(hE.test(s)?fE:s===""?mE:gE),n)}function yE(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function wE(e,t,r){let{routesMeta:n}=e,i={},s="/",a=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",h=_E({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:si([s,h.pathname]),pathnameBase:AE(si([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=si([s,h.pathnameBase]))}return a}function _E(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=SE(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:p,isOptional:m}=d;if(p==="*"){let f=l[h]||"";a=s.slice(0,s.length-f.length).replace(/(.)\/+$/,"$1")}const y=l[h];return m&&!y?u[p]=void 0:u[p]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:e}}function SE(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),lv(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function EE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return lv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Hf(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function TE(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Zs(e):e;return{pathname:r?r.startsWith("/")?r:kE(r,t):t,search:CE(n),hash:NE(i)}}function kE(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Ju(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Vf(e,t){let r=jE(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Gf(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Zs(e):(i=mo({},e),_t(!i.pathname||!i.pathname.includes("?"),Ju("?","pathname","search",i)),_t(!i.pathname||!i.pathname.includes("#"),Ju("#","pathname","hash",i)),_t(!i.search||!i.search.includes("#"),Ju("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,l;if(a==null)l=r;else{let h=t.length-1;if(!n&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),h-=1;i.pathname=p.join("/")}l=h>=0?t[h]:"/"}let c=TE(i,l),u=a&&a!=="/"&&a.endsWith("/"),d=(s||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const si=e=>e.join("/").replace(/\/\/+/g,"/"),AE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),CE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,NE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const dv=["post","put","patch","delete"];new Set(dv);const OE=["get",...dv];new Set(OE);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function go(){return go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},go.apply(this,arguments)}const Kf=X.createContext(null),IE=X.createContext(null),pi=X.createContext(null),ru=X.createContext(null),mi=X.createContext({outlet:null,matches:[],isDataRoute:!1}),hv=X.createContext(null);function PE(e,t){let{relative:r}=t===void 0?{}:t;ea()||_t(!1);let{basename:n,navigator:i}=X.useContext(pi),{hash:s,pathname:a,search:l}=pv(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:si([n,a])),i.createHref({pathname:c,search:l,hash:s})}function ea(){return X.useContext(ru)!=null}function ta(){return ea()||_t(!1),X.useContext(ru).location}function fv(e){X.useContext(pi).static||X.useLayoutEffect(e)}function nu(){let{isDataRoute:e}=X.useContext(mi);return e?GE():RE()}function RE(){ea()||_t(!1);let e=X.useContext(Kf),{basename:t,future:r,navigator:n}=X.useContext(pi),{matches:i}=X.useContext(mi),{pathname:s}=ta(),a=JSON.stringify(Vf(i,r.v7_relativeSplatPath)),l=X.useRef(!1);return fv(()=>{l.current=!0}),X.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let h=Gf(u,JSON.parse(a),s,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:si([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,a,s,e])}function pv(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=X.useContext(pi),{matches:i}=X.useContext(mi),{pathname:s}=ta(),a=JSON.stringify(Vf(i,n.v7_relativeSplatPath));return X.useMemo(()=>Gf(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function DE(e,t){return FE(e,t)}function FE(e,t,r,n){ea()||_t(!1);let{navigator:i}=X.useContext(pi),{matches:s}=X.useContext(mi),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=ta(),d;if(t){var h;let g=typeof t=="string"?Zs(t):t;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||_t(!1),d=g}else d=u;let p=d.pathname||"/",m=p;if(c!=="/"){let g=c.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(g.length).join("/")}let y=cE(e,{pathname:m}),f=$E(y&&y.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:si([c,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:si([c,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),s,r,n);return t&&f?X.createElement(ru.Provider,{value:{location:go({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Jn.Pop}},f):f}function LE(){let e=VE(),t=bE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),r?X.createElement("pre",{style:i},r):null,null)}const ME=X.createElement(LE,null);class BE extends X.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?X.createElement(mi.Provider,{value:this.props.routeContext},X.createElement(hv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function UE(e){let{routeContext:t,match:r,children:n}=e,i=X.useContext(Kf);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),X.createElement(mi.Provider,{value:t},n)}function $E(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=a.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||_t(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:p,errors:m}=r,y=h.route.loader&&p[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||y){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,h,p)=>{let m,y=!1,f=null,g=null;r&&(m=l&&h.route.id?l[h.route.id]:void 0,f=h.route.errorElement||ME,c&&(u<0&&p===0?(KE("route-fallback"),y=!0,g=null):u===p&&(y=!0,g=h.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,p+1)),x=()=>{let w;return m?w=f:y?w=g:h.route.Component?w=X.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,X.createElement(UE,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?X.createElement(BE,{location:r.location,revalidation:r.revalidation,component:f,error:m,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var mv=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(mv||{}),gv=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(gv||{});function WE(e){let t=X.useContext(Kf);return t||_t(!1),t}function zE(e){let t=X.useContext(IE);return t||_t(!1),t}function HE(e){let t=X.useContext(mi);return t||_t(!1),t}function xv(e){let t=HE(),r=t.matches[t.matches.length-1];return r.route.id||_t(!1),r.route.id}function VE(){var e;let t=X.useContext(hv),r=zE(),n=xv();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function GE(){let{router:e}=WE(mv.UseNavigateStable),t=xv(gv.UseNavigateStable),r=X.useRef(!1);return fv(()=>{r.current=!0}),X.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,go({fromRouteId:t},s)))},[e,t])}const Zp={};function KE(e,t,r){Zp[e]||(Zp[e]=!0)}const em={};function JE(e,t){em[t]||(em[t]=!0,console.warn(t))}const tm=(e,t,r)=>JE(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function XE(e,t){e!=null&&e.v7_startTransition||tm("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),e!=null&&e.v7_relativeSplatPath||tm("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function kh(e){let{to:t,replace:r,state:n,relative:i}=e;ea()||_t(!1);let{future:s,static:a}=X.useContext(pi),{matches:l}=X.useContext(mi),{pathname:c}=ta(),u=nu(),d=Gf(t,Vf(l,s.v7_relativeSplatPath),c,i==="path"),h=JSON.stringify(d);return X.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:i}),[u,h,i,r,n]),null}function ut(e){_t(!1)}function YE(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Jn.Pop,navigator:s,static:a=!1,future:l}=e;ea()&&_t(!1);let c=t.replace(/^\/*/,"/"),u=X.useMemo(()=>({basename:c,navigator:s,static:a,future:go({v7_relativeSplatPath:!1},l)}),[c,l,s,a]);typeof n=="string"&&(n=Zs(n));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:y="default"}=n,f=X.useMemo(()=>{let g=Hf(d,c);return g==null?null:{location:{pathname:g,search:h,hash:p,state:m,key:y},navigationType:i}},[c,d,h,p,m,y,i]);return f==null?null:X.createElement(pi.Provider,{value:u},X.createElement(ru.Provider,{children:r,value:f}))}function qE(e){let{children:t,location:r}=e;return DE(jh(t),r)}new Promise(()=>{});function jh(e,t){t===void 0&&(t=[]);let r=[];return X.Children.forEach(e,(n,i)=>{if(!X.isValidElement(n))return;let s=[...t,i];if(n.type===X.Fragment){r.push.apply(r,jh(n.props.children,s));return}n.type!==ut&&_t(!1),!n.props.index||!n.props.children||_t(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=jh(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ah(){return Ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ah.apply(this,arguments)}function QE(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ZE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function eT(e,t){return e.button===0&&(!t||t==="_self")&&!ZE(e)}const tT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rT="6";try{window.__reactRouterVersion=rT}catch{}const nT="startTransition",rm=X_[nT];function iT(e){let{basename:t,children:r,future:n,window:i}=e,s=X.useRef();s.current==null&&(s.current=aE({window:i,v5Compat:!0}));let a=s.current,[l,c]=X.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},d=X.useCallback(h=>{u&&rm?rm(()=>c(h)):c(h)},[c,u]);return X.useLayoutEffect(()=>a.listen(d),[a,d]),X.useEffect(()=>XE(n),[n]),X.createElement(YE,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:a,future:n})}const sT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oT=X.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=t,p=QE(t,tT),{basename:m}=X.useContext(pi),y,f=!1;if(typeof u=="string"&&aT.test(u)&&(y=u,sT))try{let w=new URL(window.location.href),E=u.startsWith("//")?new URL(w.protocol+u):new URL(u),C=Hf(E.pathname,m);E.origin===w.origin&&C!=null?u=C+E.search+E.hash:f=!0}catch{}let g=PE(u,{relative:i}),v=lT(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:h});function x(w){n&&n(w),w.defaultPrevented||v(w)}return X.createElement("a",Ah({},p,{href:y||g,onClick:f||s?n:x,ref:r,target:c}))});var nm;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(nm||(nm={}));var im;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(im||(im={}));function lT(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:l}=t===void 0?{}:t,c=nu(),u=ta(),d=pv(e,{relative:a});return X.useCallback(h=>{if(eT(h,r)){h.preventDefault();let p=n!==void 0?n:vc(u)===vc(d);c(e,{replace:p,state:i,preventScrollReset:s,relative:a,viewTransition:l})}},[u,c,d,n,i,r,e,s,a,l])}const cT="modulepreload",uT=function(e){return"/"+e},sm={},dT=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=uT(c),c in sm)return;sm[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":cT,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};function hT(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:i,onRegisteredSW:s,onRegisterError:a}=e;let l,c;const u=async(h=!0)=>{await c};async function d(){if("serviceWorker"in navigator){if(l=await dT(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{a==null||a(h)}),!l)return;l.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),l.addEventListener("installed",h=>{h.isUpdate||n==null||n()}),l.register({immediate:t}).then(h=>{s?s("/sw.js",h):i==null||i(h)}).catch(h=>{a==null||a(h)})}}return c=d(),u}var Ch=function(e,t){return Ch=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Ch(e,t)};function vv(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ch(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var yc=function(){return yc=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},yc.apply(this,arguments)};function ra(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function yv(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function wv(e,t){return function(r,n){t(r,n,e)}}function _v(e,t,r,n,i,s){function a(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,p=!1,m=r.length-1;m>=0;m--){var y={};for(var f in n)y[f]=f==="access"?{}:n[f];for(var f in n.access)y.access[f]=n.access[f];y.addInitializer=function(v){if(p)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(v||null))};var g=(0,r[m])(l==="accessor"?{get:d.get,set:d.set}:d[c],y);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=a(g.get))&&(d.get=h),(h=a(g.set))&&(d.set=h),(h=a(g.init))&&i.unshift(h)}else(h=a(g))&&(l==="field"?i.unshift(h):d[c]=h)}u&&Object.defineProperty(u,n.name,d),p=!0}function Sv(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function Ev(e){return typeof e=="symbol"?e:"".concat(e)}function Tv(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function kv(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function je(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?s(d.value):i(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function jv(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var iu=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function Av(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&iu(t,e,r)}function wc(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jf(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Cv(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Jf(arguments[t]));return e}function Nv(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,l=s.length;a<l;a++,i++)n[i]=s[a];return n}function bv(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function Js(e){return this instanceof Js?(this.v=e,this):new Js(e)}function Ov(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(m){return function(y){return Promise.resolve(y).then(m,h)}}function l(m,y){n[m]&&(i[m]=function(f){return new Promise(function(g,v){s.push([m,f,g,v])>1||c(m,f)})},y&&(i[m]=y(i[m])))}function c(m,y){try{u(n[m](y))}catch(f){p(s[0][3],f)}}function u(m){m.value instanceof Js?Promise.resolve(m.value.v).then(d,h):p(s[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function p(m,y){m(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Iv(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:Js(e[i](a)),done:!1}:s?s(a):a}:s}}function Pv(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof wc=="function"?wc(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(l,c){a=e[s](a),i(l,c,a.done,a.value)})}}function i(s,a,l,c){Promise.resolve(c).then(function(u){s({value:u,done:l})},a)}}function Rv(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var fT=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Nh=function(e){return Nh=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Nh(e)};function Dv(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Nh(e),n=0;n<r.length;n++)r[n]!=="default"&&iu(t,e,r[n]);return fT(t,e),t}function Fv(e){return e&&e.__esModule?e:{default:e}}function Lv(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Mv(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function Bv(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Uv(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var pT=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function $v(e){function t(s){e.error=e.hasError?new pT(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function Wv(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?t?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):e}const mT={__extends:vv,__assign:yc,__rest:ra,__decorate:yv,__param:wv,__esDecorate:_v,__runInitializers:Sv,__propKey:Ev,__setFunctionName:Tv,__metadata:kv,__awaiter:je,__generator:jv,__createBinding:iu,__exportStar:Av,__values:wc,__read:Jf,__spread:Cv,__spreadArrays:Nv,__spreadArray:bv,__await:Js,__asyncGenerator:Ov,__asyncDelegator:Iv,__asyncValues:Pv,__makeTemplateObject:Rv,__importStar:Dv,__importDefault:Fv,__classPrivateFieldGet:Lv,__classPrivateFieldSet:Mv,__classPrivateFieldIn:Bv,__addDisposableResource:Uv,__disposeResources:$v,__rewriteRelativeImportExtension:Wv},gT=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Uv,get __assign(){return yc},__asyncDelegator:Iv,__asyncGenerator:Ov,__asyncValues:Pv,__await:Js,__awaiter:je,__classPrivateFieldGet:Lv,__classPrivateFieldIn:Bv,__classPrivateFieldSet:Mv,__createBinding:iu,__decorate:yv,__disposeResources:$v,__esDecorate:_v,__exportStar:Av,__extends:vv,__generator:jv,__importDefault:Fv,__importStar:Dv,__makeTemplateObject:Rv,__metadata:kv,__param:wv,__propKey:Ev,__read:Jf,__rest:ra,__rewriteRelativeImportExtension:Wv,__runInitializers:Sv,__setFunctionName:Tv,__spread:Cv,__spreadArray:bv,__spreadArrays:Nv,__values:wc,default:mT},Symbol.toStringTag,{value:"Module"})),xT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Xf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class vT extends Xf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class am extends Xf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class om extends Xf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(bh||(bh={}));class yT{constructor(t,{headers:r={},customFetch:n,region:i=bh.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=xT(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return je(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=n;let p={},{region:m}=n;m||(m=this.region);const y=new URL(`${this.url}/${r}`);m&&m!=="any"&&(p["x-region"]=m,y.searchParams.set("forceFunctionRegion",m));let f;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",f=u):typeof u=="string"?(p["Content-Type"]="text/plain",f=u):typeof FormData<"u"&&u instanceof FormData?f=u:(p["Content-Type"]="application/json",f=JSON.stringify(u)):f=u;let g=d;h&&(a=new AbortController,s=setTimeout(()=>a.abort(),h),d?(g=a.signal,d.addEventListener("abort",()=>a.abort())):g=a.signal);const v=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:f,signal:g}).catch(C=>{throw new vT(C)}),x=v.headers.get("x-relay-error");if(x&&x==="true")throw new am(v);if(!v.ok)throw new om(v);let w=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),E;return w==="application/json"?E=yield v.json():w==="application/octet-stream"||w==="application/pdf"?E=yield v.blob():w==="text/event-stream"?E=v:w==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(l){return{data:null,error:l,response:l instanceof om||l instanceof am?l.context:void 0}}finally{s&&clearTimeout(s)}})}}var or={};const na=P_(gT);var al={},ol={},ll={},cl={},ul={},dl={},lm;function zv(){if(lm)return dl;lm=1,Object.defineProperty(dl,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return dl.default=e,dl}var cm;function Hv(){if(cm)return ul;cm=1,Object.defineProperty(ul,"__esModule",{value:!0});const t=na.__importDefault(zv());class r{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h,p;let m=null,y=null,f=null,g=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const C=await c.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?y=C:y=JSON.parse(C))}const w=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),E=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");w&&E&&E.length>1&&(f=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(m={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,f=null,g=406,v="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const w=await c.text();try{m=JSON.parse(w),Array.isArray(m)&&c.status===404&&(y=[],m=null,g=200,v="OK")}catch{c.status===404&&w===""?(g=204,v="No Content"):m={message:w}}if(m&&this.isMaybeSingle&&(!((p=m==null?void 0:m.details)===null||p===void 0)&&p.includes("0 rows"))&&(m=null,g=200,v="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:y,count:f,status:g,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return ul.default=r,ul}var um;function Vv(){if(um)return cl;um=1,Object.defineProperty(cl,"__esModule",{value:!0});const t=na.__importDefault(Hv());class r extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(u,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const h=[i?"analyze":null,s?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),p=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${p}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return cl.default=r,cl}var dm;function Yf(){if(dm)return ll;dm=1,Object.defineProperty(ll,"__esModule",{value:!0});const t=na.__importDefault(Vv()),r=new RegExp("[,()]");class n extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${u}fts${d}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return ll.default=n,ll}var hm;function Gv(){if(hm)return ol;hm=1,Object.defineProperty(ol,"__esModule",{value:!0});const t=na.__importDefault(Yf());class r{constructor(i,{headers:s={},schema:a,fetch:l}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=l}select(i,s){const{head:a=!1,count:l}=s??{},c=a?"HEAD":"GET";let u=!1;const d=(i??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const u=i.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const h=i.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(h.length>0){const p=[...new Set(h)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(i,{count:s}={}){var a;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return ol.default=r,ol}var fm;function wT(){if(fm)return al;fm=1,Object.defineProperty(al,"__esModule",{value:!0});const e=na,t=e.__importDefault(Gv()),r=e.__importDefault(Yf());class n{constructor(s,{headers:a={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(s){const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:l=!1,get:c=!1,count:u}={}){var d;let h;const p=new URL(`${this.url}/rpc/${s}`);let m;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([f,g])=>g!==void 0).map(([f,g])=>[f,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([f,g])=>{p.searchParams.append(f,g)})):(h="POST",m=a);const y=new Headers(this.headers);return u&&y.set("Prefer",`count=${u}`),new r.default({method:h,url:p,headers:y,schema:this.schemaName,body:m,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return al.default=n,al}Object.defineProperty(or,"__esModule",{value:!0});var Kv=or.PostgrestError=ny=or.PostgrestBuilder=ty=or.PostgrestTransformBuilder=Zv=or.PostgrestFilterBuilder=qv=or.PostgrestQueryBuilder=Xv=or.PostgrestClient=void 0;const ia=na,Jv=ia.__importDefault(wT());var Xv=or.PostgrestClient=Jv.default;const Yv=ia.__importDefault(Gv());var qv=or.PostgrestQueryBuilder=Yv.default;const Qv=ia.__importDefault(Yf());var Zv=or.PostgrestFilterBuilder=Qv.default;const ey=ia.__importDefault(Vv());var ty=or.PostgrestTransformBuilder=ey.default;const ry=ia.__importDefault(Hv());var ny=or.PostgrestBuilder=ry.default;const iy=ia.__importDefault(zv());Kv=or.PostgrestError=iy.default;var sy=or.default={PostgrestClient:Jv.default,PostgrestQueryBuilder:Yv.default,PostgrestFilterBuilder:Qv.default,PostgrestTransformBuilder:ey.default,PostgrestBuilder:ry.default,PostgrestError:iy.default};const _T=Jg({__proto__:null,get PostgrestBuilder(){return ny},get PostgrestClient(){return Xv},get PostgrestError(){return Kv},get PostgrestFilterBuilder(){return Zv},get PostgrestQueryBuilder(){return qv},get PostgrestTransformBuilder(){return ty},default:sy},[or]),{PostgrestClient:ST,PostgrestQueryBuilder:JR,PostgrestFilterBuilder:XR,PostgrestTransformBuilder:YR,PostgrestBuilder:qR,PostgrestError:QR}=sy||_T;class ET{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const TT="2.81.0",kT=`realtime-js/${TT}`,ay="1.0.0",jT="2.0.0",pm=ay,Oh=1e4,AT=1e3,CT=100;var ji;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ji||(ji={}));var Nt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Nt||(Nt={}));var Lr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Lr||(Lr={}));var Ih;(function(e){e.websocket="websocket"})(Ih||(Ih={}));var Ai;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ai||(Ai={}));class NT{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodePush(t){const{join_ref:r,ref:n,event:i,topic:s,payload:a}=t,l=this.META_LENGTH+r.length+n.length+s.length+i.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let u=new DataView(c),d=0;u.setUint8(d++,this.KINDS.push),u.setUint8(d++,r.length),u.setUint8(d++,n.length),u.setUint8(d++,s.length),u.setUint8(d++,i.length),Array.from(r,p=>u.setUint8(d++,p.charCodeAt(0))),Array.from(n,p=>u.setUint8(d++,p.charCodeAt(0))),Array.from(s,p=>u.setUint8(d++,p.charCodeAt(0))),Array.from(i,p=>u.setUint8(d++,p.charCodeAt(0)));var h=new Uint8Array(c.byteLength+a.byteLength);return h.set(new Uint8Array(c),0),h.set(new Uint8Array(a),c.byteLength),h.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const{join_ref:i,ref:s,topic:a}=t,l=t.payload.event,c=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0),u=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+l.length,d=new ArrayBuffer(this.HEADER_LENGTH+u);let h=new DataView(d),p=0;h.setUint8(p++,this.KINDS.userBroadcastPush),h.setUint8(p++,i.length),h.setUint8(p++,s.length),h.setUint8(p++,a.length),h.setUint8(p++,l.length),h.setUint8(p++,this.BINARY_ENCODING),Array.from(i,y=>h.setUint8(p++,y.charCodeAt(0))),Array.from(s,y=>h.setUint8(p++,y.charCodeAt(0))),Array.from(a,y=>h.setUint8(p++,y.charCodeAt(0))),Array.from(l,y=>h.setUint8(p++,y.charCodeAt(0)));var m=new Uint8Array(d.byteLength+c.byteLength);return m.set(new Uint8Array(d),0),m.set(new Uint8Array(c),d.byteLength),m.buffer}_encodeJsonUserBroadcastPush(t){var r,n;const{join_ref:i,ref:s,topic:a}=t,l=t.payload.event,c=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},d=new TextEncoder().encode(JSON.stringify(c)).buffer,h=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+l.length,p=new ArrayBuffer(this.HEADER_LENGTH+h);let m=new DataView(p),y=0;m.setUint8(y++,this.KINDS.userBroadcastPush),m.setUint8(y++,i.length),m.setUint8(y++,s.length),m.setUint8(y++,a.length),m.setUint8(y++,l.length),m.setUint8(y++,this.JSON_ENCODING),Array.from(i,g=>m.setUint8(y++,g.charCodeAt(0))),Array.from(s,g=>m.setUint8(y++,g.charCodeAt(0))),Array.from(a,g=>m.setUint8(y++,g.charCodeAt(0))),Array.from(l,g=>m.setUint8(y++,g.charCodeAt(0)));var f=new Uint8Array(p.byteLength+d.byteLength);return f.set(new Uint8Array(p),0),f.set(new Uint8Array(d),p.byteLength),f.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,a,l,c]=n;return r({join_ref:i,ref:s,topic:a,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.push:return this._decodePush(t,r,i);case this.KINDS.reply:return this._decodeReply(t,r,i);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,i);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodePush(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+a));l=l+a;const h=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{join_ref:c,ref:null,topic:u,event:d,payload:h}}_decodeReply(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const u=n.decode(t.slice(c,c+i));c=c+i;const d=n.decode(t.slice(c,c+s));c=c+s;const h=n.decode(t.slice(c,c+a));c=c+a;const p=n.decode(t.slice(c,c+l));c=c+l;const m=JSON.parse(n.decode(t.slice(c,t.byteLength))),y={status:p,response:m};return{join_ref:u,ref:d,topic:h,event:Lr.reply,payload:y}}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(t.slice(a,a+i));a=a+i;const c=n.decode(t.slice(a,a+s));a=a+s;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:u}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+i));c=c+i;const d=n.decode(t.slice(c,c+s));c=c+s;const h=n.decode(t.slice(c,c+a));c=c+a;const p=t.slice(c,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,y={type:this.BROADCAST,event:d,payload:m};return a>0&&(y.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST,payload:y}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class oy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var tt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(tt||(tt={}));const mm=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=bT(a,e,t,i),s),{}):{}},bT=(e,t,r,n)=>{const i=t.find(l=>l.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?ly(s,a):Ph(a)},ly=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return RT(t,r)}switch(e){case tt.bool:return OT(t);case tt.float4:case tt.float8:case tt.int2:case tt.int4:case tt.int8:case tt.numeric:case tt.oid:return IT(t);case tt.json:case tt.jsonb:return PT(t);case tt.timestamp:return DT(t);case tt.abstime:case tt.date:case tt.daterange:case tt.int4range:case tt.int8range:case tt.money:case tt.reltime:case tt.text:case tt.time:case tt.timestamptz:case tt.timetz:case tt.tsrange:case tt.tstzrange:return Ph(t);default:return Ph(t)}},Ph=e=>e,OT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},IT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},PT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},RT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(l=>ly(t,l))}return e},DT=e=>typeof e=="string"?e.replace(" ","T"):e,cy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Xu{constructor(t,r,n={},i=Oh){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var gm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(gm||(gm={}));class za{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=za.syncState(this.state,i,s,a),this.pendingDiffs.forEach(c=>{this.state=za.syncDiff(this.state,c,s,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=za.syncDiff(this.state,i,s,a),l())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),l={},c={};return this.map(s,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const h=s[u];if(h){const p=d.map(g=>g.presence_ref),m=h.map(g=>g.presence_ref),y=d.filter(g=>m.indexOf(g.presence_ref)<0),f=h.filter(g=>p.indexOf(g.presence_ref)<0);y.length>0&&(l[u]=y),f.length>0&&(c[u]=f)}else l[u]=d}),this.syncDiff(s,{joins:l,leaves:c},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(m=>m.presence_ref),p=d.filter(m=>h.indexOf(m.presence_ref)<0);t[l].unshift(...p)}n(l,d,c)}),this.map(a,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,i(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var xm;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(xm||(xm={}));var Ha;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ha||(Ha={}));var vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vn||(vn={}));class qf{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xu(this,Lr.join,this.params,this.timeout),this.rejoinTimer=new oy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lr.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new za(this),this.broadcastEndpointURL=cy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Nt.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,u=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Ha.PRESENCE]&&this.bindings[Ha.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},p={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(vn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(vn.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var y;if(this.socket.setAuth(),m===void 0){t==null||t(vn.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,g=(y=f==null?void 0:f.length)!==null&&y!==void 0?y:0,v=[];for(let x=0;x<g;x++){const w=f[x],{filter:{event:E,schema:C,table:A,filter:k}}=w,O=m&&m[x];if(O&&O.event===E&&O.schema===C&&O.table===A&&O.filter===k)v.push(Object.assign(Object.assign({},w),{id:O.id}));else{this.unsubscribe(),this.state=Nt.errored,t==null||t(vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(vn.SUBSCRIBED);return}}).receive("error",m=>{this.state=Nt.errored,t==null||t(vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Nt.joined&&t===Ha.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Nt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Xu(this,Lr.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xu(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>CT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Lr;if(n&&[l,c,u,d].indexOf(a)>=0&&n!==this._joinRef())return;let p=this._onMessage(a,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var y,f,g;return((y=m.filter)===null||y===void 0?void 0:y.event)==="*"||((g=(f=m.filter)===null||f===void 0?void 0:f.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(m=>m.callback(p,n)):(s=this.bindings[a])===null||s===void 0||s.filter(m=>{var y,f,g,v,x,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const E=m.id,C=(y=m.filter)===null||y===void 0?void 0:y.event;return E&&((f=r.ids)===null||f===void 0?void 0:f.includes(E))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const E=(x=(v=m==null?void 0:m.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return E==="*"||E===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:f,table:g,commit_timestamp:v,type:x,errors:w}=y;p=Object.assign(Object.assign({},{schema:f,table:g,commit_timestamp:v,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(y))}m.callback(p,n)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&qf.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Lr.close,{},t)}_onError(t){this._on(Lr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=mm(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=mm(t.columns,t.old_record)),r}}const Yu=()=>{},hl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},FT=[1e3,2e3,5e3,1e4],LT=1e4,MT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Oh,this.transport=null,this.heartbeatIntervalMs=hl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yu,this.ref=0,this.reconnectTimer=null,this.vsn=pm,this.logger=Yu,this.conn=null,this.sendBuffer=[],this.serializer=new NT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Ih.websocket}`,this.httpEndpoint=cy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ET.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ji.connecting:return Ai.Connecting;case ji.open:return Ai.Open;case ji.closing:return Ai.Closing;default:return Ai.Closed}}isConnected(){return this.connectionState()===Ai.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new qf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(AT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},hl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,l=a?`(${a})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ji.open||this.conn.readyState===ji.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Lr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([MT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:kT};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Lr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new oy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},hl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,l,c,u,d,h,p,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Oh,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:hl.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Yu,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:pm,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:y=>FT[y-1]||LT,this.vsn){case ay:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(y,f)=>f(JSON.stringify(y)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(y,f)=>f(JSON.parse(y));break;case jT:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Qf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function dt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class UT extends Qf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rh extends Qf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const Zf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$T=()=>Response,Dh=e=>{if(Array.isArray(e))return e.map(r=>Dh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Dh(n)}),t},WT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},qu=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},zT=(e,t,r)=>je(void 0,void 0,void 0,function*(){const n=yield $T();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const s=e.status||500,a=(i==null?void 0:i.statusCode)||s+"";t(new UT(qu(i),s,a))}).catch(i=>{t(new Rh(qu(i),i))}):t(new Rh(qu(e),e))}),HT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(WT(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function Io(e,t,r,n,i,s){return je(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,HT(t,n,i,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>zT(c,l,n))})})}function xo(e,t,r,n){return je(this,void 0,void 0,function*(){return Io(e,"GET",t,r,n)})}function qr(e,t,r,n,i){return je(this,void 0,void 0,function*(){return Io(e,"POST",t,n,i,r)})}function Fh(e,t,r,n,i){return je(this,void 0,void 0,function*(){return Io(e,"PUT",t,n,i,r)})}function VT(e,t,r,n){return je(this,void 0,void 0,function*(){return Io(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function e0(e,t,r,n,i){return je(this,void 0,void 0,function*(){return Io(e,"DELETE",t,n,i,r)})}class GT{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return je(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dt(t))return{data:null,error:t};throw t}})}}var uy;class KT{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[uy]="BlobDownloadBuilder",this.promise=null}asStream(){return new GT(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return je(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dt(t))return{data:null,error:t};throw t}})}}uy=Symbol.toStringTag;const JT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class XT{constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Zf(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return je(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},vm),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),c&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield(t=="PUT"?Fh:qr)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return je(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:vm.upsert},i),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Fh(this.fetch,l.toString(),c,{headers:d});return{data:{path:s,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(dt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return je(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield qr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),l=a.searchParams.get("token");if(!l)throw new Qf("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dt(n))return{data:null,error:n};throw n}})}update(t,r,n){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return je(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return je(this,void 0,void 0,function*(){try{return{data:{path:(yield qr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return je(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield qr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return je(this,void 0,void 0,function*(){try{const i=yield qr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"",l=this._getFinalPath(t),c=()=>xo(this.fetch,`${this.url}/${i}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new KT(c,this.shouldThrowOnError)}info(t){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield xo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Dh(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dt(n))return{data:null,error:n};throw n}})}exists(t){return je(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield VT(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dt(n)&&n instanceof Rh){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return je(this,void 0,void 0,function*(){try{return{data:yield e0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}list(t,r,n){return je(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},JT),r),{prefix:t||""});return{data:yield qr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}listV2(t,r){return je(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield qr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const dy="2.81.0",hy={"X-Client-Info":`storage-js/${dy}`};class YT{constructor(t,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hy),r),this.fetch=Zf(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return je(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield xo(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}getBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield xo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}createBucket(t){return je(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dt(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return je(this,void 0,void 0,function*(){try{return{data:yield Fh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield e0(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class qT{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hy),r),this.fetch=Zf(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}listBuckets(t){return je(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield xo(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield e0(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dt(r))return{data:null,error:r};throw r}})}}const t0={"X-Client-Info":`storage-js/${dy}`,"Content-Type":"application/json"};class fy extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function jr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Qu extends fy{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class QT extends fy{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var ym;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(ym||(ym={}));const r0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ZT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},wm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ek=(e,t,r)=>je(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";t(new Qu(wm(a),i,l))}).catch(()=>{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new Qu(l,i,a))});else{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new Qu(l,i,a))}}else t(new QT(wm(e),e))}),tk=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(ZT(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function rk(e,t,r,n,i,s){return je(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,tk(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>ek(c,l,n))})})}function Ar(e,t,r,n,i){return je(this,void 0,void 0,function*(){return rk(e,"POST",t,n,i,r)})}class nk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t0),r),this.fetch=r0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return je(this,void 0,void 0,function*(){try{return{data:(yield Ar(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}getIndex(t,r){return je(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jr(n))return{data:null,error:n};throw n}})}listIndexes(t){return je(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return je(this,void 0,void 0,function*(){try{return{data:(yield Ar(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jr(n))return{data:null,error:n};throw n}})}}class ik{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t0),r),this.fetch=r0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return je(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Ar(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}getVectors(t){return je(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}listVectors(t){return je(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Ar(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}queryVectors(t){return je(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}deleteVectors(t){return je(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Ar(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}}class sk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t0),r),this.fetch=r0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return je(this,void 0,void 0,function*(){try{return{data:(yield Ar(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}getBucket(t){return je(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}listBuckets(){return je(this,arguments,void 0,function*(t={}){try{return{data:yield Ar(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return je(this,void 0,void 0,function*(){try{return{data:(yield Ar(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jr(r))return{data:null,error:r};throw r}})}}class ak extends sk{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new ok(this.url,this.headers,t,this.fetch)}}class ok extends nk{constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return je(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return je(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return je(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return je(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new lk(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class lk extends ik{constructor(t,r,n,i,s){super(t,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return je(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return je(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return je(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return je(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return je(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class ck extends YT{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new XT(this.url,this.headers,t,this.fetch)}get vectors(){return new ak(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new qT(this.url+"/iceberg",this.headers,this.fetch)}}const uk="2.81.0";let Oa="";typeof Deno<"u"?Oa="deno":typeof document<"u"?Oa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oa="react-native":Oa="node";const dk={"X-Client-Info":`supabase-js-${Oa}/${uk}`},hk={headers:dk},fk={schema:"public"},pk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mk={},gk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),xk=()=>Headers,vk=(e,t,r)=>{const n=gk(r),i=xk();return async(s,a)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},a),{headers:u}))}};function yk(e){return e.endsWith("/")?e:e+"/"}function wk(e,t){var r,n;const{db:i,auth:s,realtime:a,global:l}=e,{db:c,auth:u,realtime:d,global:h}=t,p={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function _k(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(yk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const py="2.81.0",fs=30*1e3,Lh=3,Zu=Lh*fs,Sk="http://localhost:9999",Ek="supabase.auth.token",Tk={"X-Client-Info":`gotrue-js/${py}`},Mh="X-Supabase-Api-Version",my={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},kk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jk=10*60*1e3;class vo extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ae(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ak extends vo{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Ck(e){return Ae(e)&&e.name==="AuthApiError"}class Ci extends vo{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class gi extends vo{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Jr extends gi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Nk(e){return Ae(e)&&e.name==="AuthSessionMissingError"}class Zi extends gi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fl extends gi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class pl extends gi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bk(e){return Ae(e)&&e.name==="AuthImplicitGrantRedirectError"}class _m extends gi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bh extends gi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ed(e){return Ae(e)&&e.name==="AuthRetryableFetchError"}class Sm extends gi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Uh extends gi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const _c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Em=` 	
\r=`.split(""),Ok=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Em.length;t+=1)e[Em[t].charCodeAt(0)]=-2;for(let t=0;t<_c.length;t+=1)e[_c[t].charCodeAt(0)]=t;return e})();function Tm(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(_c[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(_c[n]),t.queuedBits-=6}}function gy(e,t,r){const n=Ok[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function km(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Rk(a,n,r)};for(let a=0;a<e.length;a+=1)gy(e.charCodeAt(a),i,s);return t.join("")}function Ik(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Pk(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Ik(n,t)}}function Rk(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Fs(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)gy(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Dk(e){const t=[];return Pk(e,r=>t.push(r)),new Uint8Array(t)}function Pi(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Tm(i,r,n)),Tm(null,r,n),t.join("")}function Fk(e){return Math.round(Date.now()/1e3)+e}function Lk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const qt=()=>typeof window<"u"&&typeof document<"u",wi={tested:!1,writable:!1},xy=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wi.tested)return wi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wi.tested=!0,wi.writable=!0}catch{wi.tested=!0,wi.writable=!1}return wi.writable};function Mk(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const vy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Bk=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ps=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},_i=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Dn=async(e,t)=>{await e.removeItem(t)};class su{constructor(){this.promise=new su.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}su.promiseConstructor=Promise;function td(e){const t=e.split(".");if(t.length!==3)throw new Uh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!kk.test(t[n]))throw new Uh("JWT not in base64url format");return{header:JSON.parse(km(t[0])),payload:JSON.parse(km(t[1])),signature:Fs(t[2]),raw:{header:t[0],payload:t[1]}}}async function Uk(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function $k(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Wk(e){return("0"+e.toString(16)).substr(-2)}function zk(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Wk).join("")}async function Hk(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Vk(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Hk(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function es(e,t,r=!1){const n=zk();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await ps(e,`${t}-code-verifier`,i);const s=await Vk(n);return[s,n===s?"plain":"s256"]}const Gk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Kk(e){const t=e.headers.get(Mh);if(!t||!t.match(Gk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Jk(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Xk(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Yk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ts(e){if(!Yk.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function rd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function qk(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function jm(e){return JSON.parse(JSON.stringify(e))}const ki=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qk=[502,503,504];async function Am(e){var t;if(!Bk(e))throw new Bh(ki(e),0);if(Qk.includes(e.status))throw new Bh(ki(e),e.status);let r;try{r=await e.json()}catch(s){throw new Ci(ki(s),s)}let n;const i=Kk(e);if(i&&i.getTime()>=my["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Sm(ki(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Jr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Sm(ki(r),e.status,r.weak_password.reasons);throw new Ak(ki(r),e.status||500,n)}const Zk=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function be(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Mh]||(s[Mh]=my["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await ej(e,t,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function ej(e,t,r,n,i,s){const a=Zk(t,n,i,s);let l;try{l=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new Bh(ki(c),0)}if(l.ok||await Am(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Am(c)}}function Xr(e){var t;let r=null;nj(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Fk(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Cm(e){const t=Xr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Vn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function tj(e){return{data:e,error:null}}function rj(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=ra(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function Nm(e){return e}function nj(e){return e.access_token&&e.refresh_token&&e.expires_in}const nd=["global","local","others"];class ij{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=vy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=nd[0]){if(nd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${nd.join(", ")}`);try{return await be(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await be(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Vn})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ra(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:rj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ae(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await be(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Vn})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Nm});if(d.error)throw d.error;const h=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(y=>{const f=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(y.split(";")[1].split("=")[1]);u[`${g}Page`]=f}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ae(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){ts(t);try{return await be(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Vn})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ts(t);try{return await be(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Vn})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ts(t);try{return await be(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Vn})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ts(t.userId);try{const{data:r,error:n}=await be(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ts(t.userId),ts(t.id);try{return{data:await be(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Nm});if(d.error)throw d.error;const h=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(y=>{const f=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(y.split(";")[1].split("=")[1]);u[`${g}Page`]=f}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ae(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}}function bm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const rs={debug:!!(globalThis&&xy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class yy extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sj extends yy{}async function aj(e,t,r){rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),rs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(rs.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function oj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function wy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function lj(e){return parseInt(e,16)}function cj(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function uj(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=wy(e.address),y=d?`${d}://${n}`:n,f=e.statement?`${e.statement}
`:"",g=`${y} wants you to sign in with your Ethereum account:
${m}

${f}`;let v=`URI: ${h}
Version: ${p}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),l&&(v+=`
Not Before: ${l.toISOString()}`),c&&(v+=`
Request ID: ${c}`),u){let x=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);x+=`
- ${w}`}v+=x}return`${g}
${v}`}class Tt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Sc extends Tt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function dj({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Tt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Tt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Tt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Tt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Tt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Tt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Tt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Tt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(_y(a)){if(s.rp.id!==a)return new Tt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Tt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function hj({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Tt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Tt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(_y(n)){if(r.rpId!==n)return new Tt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class fj{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const pj=new fj;function mj(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=ra(e,["challenge","user","excludeCredentials"]),s=Fs(t).buffer,a=Object.assign(Object.assign({},r),{id:Fs(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Fs(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function gj(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ra(e,["challenge","allowCredentials"]),i=Fs(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const l=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},l),{id:Fs(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function xj(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Pi(new Uint8Array(e.response.attestationObject)),clientDataJSON:Pi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function vj(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Pi(new Uint8Array(i.authenticatorData)),clientDataJSON:Pi(new Uint8Array(i.clientDataJSON)),signature:Pi(new Uint8Array(i.signature)),userHandle:i.userHandle?Pi(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function _y(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Om(){var e,t;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function yj(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sc("Browser returned unexpected credential type",t)}:{data:null,error:new Sc("Empty credential response",t)}}catch(t){return{data:null,error:dj({error:t,options:e})}}}async function wj(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sc("Browser returned unexpected credential type",t)}:{data:null,error:new Sc("Empty credential response",t)}}catch(t){return{data:null,error:hj({error:t,options:e})}}}const _j={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Sj={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ec(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const l=n[s];t(l)?n[s]=Ec(l,a):n[s]=Ec(a)}else n[s]=a}return n}function Ej(e,t){return Ec(_j,e,t||{})}function Tj(e,t){return Ec(Sj,e,t||{})}class kj{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:l};const c=i??pj.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=Ej(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:h}=await yj({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=Tj(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:h}=await wj(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(a){return Ae(a)?{data:null,error:a}:{data:null,error:new Ci("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new vo("rpId is required for WebAuthn authentication")};try{if(!Om())return{data:null,error:new Ci("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(a){return Ae(a)?{data:null,error:a}:{data:null,error:new Ci("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new vo("rpId is required for WebAuthn registration")};try{if(!Om())return{data:null,error:new Ci("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(a){return Ae(a)?{data:null,error:a}:{data:null,error:new Ci("Unexpected error in register",a)}}}}oj();const jj={url:Sk,storageKey:Ek,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Tk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Im(e,t,r){return await r()}const ns={};class yo{get jwks(){var t,r;return(r=(t=ns[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ns[this.storageKey]=Object.assign(Object.assign({},ns[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ns[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ns[this.storageKey]=Object.assign(Object.assign({},ns[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},jj),t);if(this.storageKey=s.storageKey,this.instanceID=(r=yo.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,yo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&qt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new ij({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=vy(s.fetch),this.lock=s.lock||Im,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:qt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=aj:this.lock=Im,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new kj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:xy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=bm(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=bm(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${py}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(qt()&&(r=Mk(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),qt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),bk(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ae(r)?this._returnResult({error:r}):this._returnResult({error:new Ci("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Xr}),{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:d,password:h,options:p}=t;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await es(this.storage,this.storageKey)),s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:y},xform:Xr})}else if("phone"in t){const{phone:d,password:h,options:p}=t;s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Xr})}else throw new fl("You must provide either an email or phone number and a password");const{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:l}=t;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Cm})}else if("phone"in t){const{phone:s,password:a,options:l}=t;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Cm})}else throw new fl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Zi;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,l,c,u,d,h,p;let m,y;if("message"in t)m=t.message,y=t.signature;else{const{chain:f,wallet:g,statement:v,options:x}=t;let w;if(qt())if(typeof g=="object")w=g;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")w=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const E=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href),C=await w.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=wy(C[0]);let k=(n=x==null?void 0:x.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const U=await w.request({method:"eth_chainId"});k=lj(U)}const O={domain:E.host,address:A,statement:v,uri:E.href,version:"1",chainId:k,nonce:(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=x==null?void 0:x.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=x==null?void 0:x.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=x==null?void 0:x.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=x==null?void 0:x.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=x==null?void 0:x.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=uj(O),y=await w.request({method:"personal_sign",params:[cj(m),A]})}try{const{data:f,error:g}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:y},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Xr});if(g)throw g;if(!f||!f.session||!f.user){const v=new Zi;return this._returnResult({data:{user:null,session:null},error:v})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:Object.assign({},f),error:g})}catch(f){if(Ae(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithSolana(t){var r,n,i,s,a,l,c,u,d,h,p,m;let y,f;if("message"in t)y=t.message,f=t.signature;else{const{chain:g,wallet:v,statement:x,options:w}=t;let E;if(qt())if(typeof v=="object")E=v;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))E=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=v}const C=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const A=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),x?{statement:x}:null));let k;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")k=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)k=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)y=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),f=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const A=await E.signMessage(new TextEncoder().encode(y),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=A}}try{const{data:g,error:v}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Pi(f)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Xr});if(v)throw v;if(!g||!g.session||!g.user){const x=new Zi;return this._returnResult({data:{user:null,session:null},error:x})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(Ae(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await _i(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Xr});if(await Dn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const l=new Zi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(Ae(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,l=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Xr}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new Zi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await es(this.storage,this.storageKey));const{error:h}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new fl("You must provide either an email or phone number.")}catch(l){if(Ae(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Xr});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;this.flowType==="pkce"&&([s,a]=await es(this.storage,this.storageKey));const l=await be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:tj});return this._returnResult(l)}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Jr;const{error:i}=await be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ae(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await be(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:l}=await be(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new fl("You must provide either an email or phone number and a type")}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await _i(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Zu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await _i(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=rd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=qk(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Vn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jr}:await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Vn})})}catch(r){if(Ae(r))return Nk(r)&&(await this._removeSession(),await Dn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Jr;const a=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await es(this.storage,this.storageKey));const{data:u,error:d}=await be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Vn});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(Ae(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Jr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=td(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Ae(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:l}=r;if(l)throw l;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Jr;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!qt())throw new pl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new pl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new _m("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new pl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new _m("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=t;if(!s||!l||!a||!u)throw new pl("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let p=d+h;c&&(p=parseInt(c));const m=p-d;m*1e3<=fs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const y=p-h;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:f,error:g}=await this._getUser(s);if(g)throw g;const v={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:p,refresh_token:a,token_type:u,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(n){if(Ae(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await _i(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(Ck(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Dn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Lk(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await es(this.storage,this.storageKey,!0));try{return await be(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,l,c,u,d;const{data:h,error:p}=s;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await be(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return qt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ae(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:l,token:c,access_token:u,nonce:d}=t,h=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Xr}),{data:p,error:m}=h;return m?this._returnResult({data:{user:null,session:null},error:m}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Zi}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:m}))}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await be(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await $k(async i=>(i>0&&await Uk(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Xr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&ed(s)&&Date.now()+a-n<fs})}catch(n){if(this._debug(r,"error",n),Ae(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),qt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await _i(this.storage,this.storageKey);if(i&&this.userStorage){let a=await _i(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await ps(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:rd()}else if(i&&!i.user&&!i.user){const a=await _i(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Dn(this.storage,this.storageKey+"-user"),await ps(this.storage,this.storageKey,i)):i.user=rd()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Zu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Zu}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),ed(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(i.access_token);!l&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Jr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new su;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Jr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),Ae(s)){const a={data:null,error:s};return ed(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(a),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ps(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=jm(i);await ps(this.storage,this.storageKey,s)}else{const i=jm(r);await ps(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Dn(this.storage,this.storageKey),await Dn(this.storage,this.storageKey+"-code-verifier"),await Dn(this.storage,this.storageKey+"-user"),this.userStorage&&await Dn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),fs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/fs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${fs}ms, refresh threshold is ${Lh} ticks`),i<=Lh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof yy)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await es(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await be(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await be(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?xj(t.webauthn.credential_response):vj(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:mj(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:gj(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=td(n.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await be(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Jr})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jr});const a=await be(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&qt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jr});const a=await be(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&qt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+jk>i)return n;const{data:s,error:a}=await be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:y}=await this.getSession();if(y||!m.session)return this._returnResult({data:null,error:y});n=m.session.access_token}const{header:i,payload:s,signature:a,raw:{header:l,payload:c}}=td(n);r!=null&&r.allowExpired||Jk(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:i,signature:a},error:null}}const d=Xk(i.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,Dk(`${l}.${c}`)))throw new Uh("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}}yo.nextInstanceID={};const Aj=yo;class Cj extends Aj{constructor(t){super(t)}}class Nj{constructor(t,r,n){var i,s,a;this.supabaseUrl=t,this.supabaseKey=r;const l=_k(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:fk,realtime:mk,auth:Object.assign(Object.assign({},pk),{storageKey:c}),global:hk},d=wk(n??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=vk(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new ST(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new ck(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new yT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:a,flowType:l,lock:c,debug:u,throwOnError:d},h,p){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Cj({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),h),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:l,lock:c,debug:u,throwOnError:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new BT(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Sy=(e,t,r)=>new Nj(e,t,r);function bj(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}bj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Oj="https://ybncxfvrzfcdwcwilkmv.supabase.co",Ij="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlibmN4ZnZyemZjZHdjd2lsa212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI2MjEzNjgsImV4cCI6MjA3ODE5NzM2OH0.MYFnt-nAinmBTrJ1_2umV5z7Eq1_wpmE0QV_bW6XYmQ",Pj=Sy(Oj,Ij),Pm=Pj,Rj={};function Dj(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function Fj(e){var r;return e?{admin:"Admin",seller:"Seller",worker:"Worker",hybrid:"Hybrid"}[e]||((r=e[0])==null?void 0:r.toUpperCase())+e.slice(1):""}function Rm(e=""){var n;const t=String(e||"").trim();if(!t)return"U";if(t.includes("@"))return t[0].toUpperCase();const r=t.split(/\s+/).filter(Boolean);return r.length===1?((n=r[0][0])==null?void 0:n.toUpperCase())||"U":(r[0][0]+r[r.length-1][0]).toUpperCase()}function Lj(){const e=nu(),t=ta(),r=Dj();if(!r)return null;const n={...r};n.name||(n.email&&n.email.includes("@")?n.name=n.email.split("@")[0]:n.name="User");const i=Fj(n.role),s=n.role==="seller",a=n.role==="worker",l=n.role==="hybrid",c=n.role==="admin",u="/logo.png",d=le=>t.pathname===le,h=le=>e(le),[p,m]=de.useState(!1),[y,f]=de.useState(!1),[g,v]=de.useState("light"),x=()=>{const xe=(document.documentElement.getAttribute("data-theme")||"dark")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",xe),localStorage.setItem("theme",xe),v(xe)};de.useEffect(()=>{const le=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",le),v(le)},[]),de.useEffect(()=>{m(!1),f(!1)},[t.pathname]),de.useEffect(()=>{const le=xe=>xe.key==="Escape"&&(m(!1),f(!1));return document.addEventListener("keydown",le),()=>document.removeEventListener("keydown",le)},[]),de.useEffect(()=>{const le=Pm.channel("realtime-all").on("postgres_changes",{event:"*",schema:"public"},()=>{window.dispatchEvent(new Event("db-refresh"))}).subscribe();return()=>{try{Pm.removeChannel(le)}catch{}}},[]);const w=()=>{var le;try{localStorage.removeItem("pane_user")}catch{}(le=window==null?void 0:window.location)!=null&&le.replace?window.location.replace("/login"):(e("/login",{replace:!0}),setTimeout(()=>window.location.reload(),50))},E=c?[{to:"/admin/home",label:"Home"},{to:"/admin/assign",label:"Assign"},{to:"/admin/past",label:"Past"},{to:"/admin/money",label:"Money"},{to:"/admin/employees",label:"Employees"}]:l?[{to:"/hybrid/home",label:"Home"},{to:"/hybrid/calendar",label:"My Calendar"},{to:"/finished",label:"Job Finished"},{to:"/seller",label:"Sales"},{to:"/hybrid/payments",label:"Payments"}]:s?[{to:"/seller/home",label:"Home"},{to:"/seller",label:"Sales"},{to:"/calendar/sellers",label:"My Calendar"}]:a?[{to:"/worker",label:"Home"},{to:"/calendar/workers",label:"My Calendar"},{to:"/finished",label:"Job Finished"}]:[],C={height:26,minHeight:26,width:30,minWidth:30,padding:0,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:10,fontSize:15,fontWeight:800,border:"1px solid var(--border)",background:"color-mix(in srgb, var(--bg) 70%, #000 30%)",color:"var(--text)",cursor:"pointer"},A={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",borderRadius:12,border:"1px solid var(--border)",background:"color-mix(in srgb, var(--bg) 80%, #000 20%)"},k={fontSize:11,fontWeight:850,lineHeight:1.05,letterSpacing:.15,whiteSpace:"nowrap",textAlign:"center"},O={height:26,width:26,borderRadius:"50%",border:"1px solid var(--border)",background:"color-mix(in srgb, var(--bg) 70%, #000 30%)",color:"var(--text)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:800,cursor:"pointer",userSelect:"none"},U={position:"fixed",inset:0,zIndex:70,background:"rgba(0,0,0,.45)",backdropFilter:"blur(4px)",display:"flex",alignItems:"flex-end",justifyContent:"center"},z={width:"100%",maxWidth:460,maxHeight:"82vh",overflowY:"auto",background:"var(--card)",backgroundImage:"linear-gradient(to bottom, rgba(51,199,230,0.14), transparent 28%)",border:"1px solid #33c7e6",borderTopLeftRadius:16,borderTopRightRadius:16,padding:12,paddingBottom:"calc(20px + env(safe-area-inset-bottom, 12px))",boxShadow:"0 -10px 28px rgba(0,0,0,.22)"},V=({to:le,label:xe})=>{const Be=d(le);return o.jsx("button",{onClick:()=>h(le),style:{textAlign:"left",padding:"12px 12px",borderRadius:10,border:"1px solid var(--border)",background:Be?"rgba(51,199,230,0.16)":"transparent",borderColor:Be?"#33c7e6":"var(--border)",fontWeight:800,cursor:"pointer"},className:"hover-row",children:xe})},G={textAlign:"left",padding:"12px 12px",borderRadius:10,border:"1px solid var(--border)",background:"transparent",fontWeight:800,cursor:"pointer",width:"100%"},ie=g==="light"?{position:"fixed",top:0,left:0,right:0,height:52,display:"grid",gridTemplateColumns:"auto 1fr auto",alignItems:"center",gap:8,padding:"0 18px",background:"rgba(255,255,255,0.72)",backdropFilter:"saturate(1.25) blur(10px)",WebkitBackdropFilter:"saturate(1.25) blur(10px)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 rgba(2,8,20,0.05), 0 8px 24px rgba(2,8,20,0.08)",zIndex:60}:{position:"fixed",top:0,left:0,right:0,height:52,display:"grid",gridTemplateColumns:"auto 1fr auto",alignItems:"center",gap:8,padding:"0 18px",background:"rgba(13,18,25,0.55)",backdropFilter:"saturate(1.1) blur(10px)",WebkitBackdropFilter:"saturate(1.1) blur(10px)",borderBottom:"1px solid var(--border)",boxShadow:"0 1px 0 rgba(0,0,0,0.4), 0 8px 24px rgba(0,0,0,0.35)",zIndex:60};return o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"topbar",style:ie,children:[o.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:o.jsx("button",{"aria-label":"Open navigation",onClick:()=>{m(!0),f(!1)},className:"btn outline",style:C,title:"Menu",children:""})}),o.jsx(oT,{to:"/",style:{justifySelf:"center",alignSelf:"center",textDecoration:"none",color:"inherit"},children:o.jsxs("span",{style:A,children:[o.jsx("img",{src:u,alt:"Pane in The Glass",style:{width:24,height:24,objectFit:"contain"}}),o.jsxs("span",{style:{...k,textAlign:"left"},children:[o.jsx("span",{style:{whiteSpace:"nowrap"},children:"Panein"}),o.jsx("br",{}),o.jsx("span",{style:{whiteSpace:"nowrap"},children:"TheGlass"})]})]})}),o.jsx("div",{style:{display:"flex",alignItems:"center",gap:6,justifySelf:"end"},children:o.jsx("div",{onClick:()=>{f(!0),m(!1)},title:`${n.name}  ${i}`,"aria-label":"User menu",style:O,children:Rm(n.name||n.email)})})]}),p&&o.jsx("div",{style:U,onClick:()=>m(!1),children:o.jsxs("div",{style:z,onClick:le=>le.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[o.jsxs("div",{style:{fontSize:12,color:"#33c7e6",fontWeight:800,letterSpacing:.4},children:["Navigation ",c?"(Admin)":l?"(Hybrid)":""]}),o.jsx("button",{onClick:()=>m(!1),className:"btn outline",style:{...C,width:26},children:""})]}),o.jsx("div",{style:{display:"grid",gap:6},children:E.map(le=>o.jsx(V,{to:le.to,label:le.label},le.to))}),c&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:8}}),o.jsx("div",{style:{fontSize:11,color:"#33c7e6",fontWeight:800,letterSpacing:.4,margin:"2px 0 4px"},children:"Admin Extras"}),o.jsxs("div",{style:{display:"grid",gap:6},children:[o.jsx(V,{to:"/seller",label:"Sales"}),o.jsx(V,{to:"/finished",label:"Job Finished"})]})]}),o.jsx("div",{style:{height:6}})]})}),y&&o.jsx("div",{style:U,onClick:()=>f(!1),children:o.jsxs("div",{style:z,onClick:le=>le.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:O,children:Rm(n.name||n.email)}),o.jsxs("div",{style:{lineHeight:1.1},children:[o.jsx("div",{style:{fontWeight:900,fontSize:13},children:n.name}),o.jsx("div",{style:{fontSize:11,color:"var(--muted)"},children:i})]})]}),o.jsx("button",{onClick:()=>f(!1),className:"btn outline",style:{...C,width:26},children:""})]}),o.jsxs("div",{style:{display:"grid",gap:6},children:[o.jsx("button",{onClick:x,className:"hover-row",style:G,"aria-label":"Toggle theme",title:"Toggle light/dark",children:g==="dark"?"Light Mode":"Dark Mode"}),o.jsx("button",{onClick:w,className:"hover-row",style:{...G,borderColor:"var(--danger)",color:"var(--danger)"},children:" Logout"})]})]})})]})}const Mj="https://ybncxfvrzfcdwcwilkmv.supabase.co",Bj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlibmN4ZnZyemZjZHdjd2lsa212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI2MjEzNjgsImV4cCI6MjA3ODE5NzM2OH0.MYFnt-nAinmBTrJ1_2umV5z7Eq1_wpmE0QV_bW6XYmQ",ms=Sy(Mj,Bj,{auth:{persistSession:!1}}),Uj={};function Dm(e){if(!e)return"/login";switch(e.role){case"seller":return"/seller/home";case"worker":return"/worker";case"hybrid":return"/hybrid/home";case"admin":return"/admin/home";default:return"/login"}}function $j(){const e=nu(),[t,r]=X.useState(""),[n,i]=X.useState(""),[s,a]=X.useState("");X.useEffect(()=>{const h=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",h)},[]),X.useEffect(()=>{try{const h=JSON.parse(localStorage.getItem("pane_user")||"null");h&&typeof h=="object"&&h.role&&window.location.pathname==="/login"?e(Dm(h),{replace:!0}):(!h||!h.role)&&localStorage.removeItem("pane_user")}catch{localStorage.removeItem("pane_user")}},[e]),X.useEffect(()=>{const h=document.documentElement.style.overflow,p=document.body.style.overflow;return document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",()=>{document.documentElement.style.overflow=h||"",document.body.style.overflow=p||""}},[]);const l=()=>{const p=(document.documentElement.getAttribute("data-theme")||"dark")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",p),localStorage.setItem("theme",p)},c=async h=>{h.preventDefault(),a("");const{data:p,error:m}=await ms.from("users").select("*").eq("email",(t||"").toLowerCase().trim()).maybeSingle();if(m||!p||String(p.pin||"")!==String(n||"")){a("Incorrect email or PIN.");return}try{localStorage.setItem("pane_user",JSON.stringify(p))}catch{}window.location.href=Dm(p)},u="/logo.png",d={WebkitTextSecurity:"disc",MozTextSecurity:"disc",textSecurity:"disc"};return o.jsx("div",{style:{position:"fixed",inset:0,height:"100svh",display:"grid",placeItems:"center",padding:16,overflow:"hidden",zIndex:11,background:"var(--bg)"},children:o.jsxs("form",{onSubmit:c,className:"card",style:{width:"min(92vw, 380px)",padding:20,borderRadius:12,transform:"translateY(-3vh)",willChange:"transform"},autoComplete:"off","data-lpignore":"true","data-1p-ignore":!0,spellCheck:!1,children:[o.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[o.jsx("img",{src:u,alt:"Pane in The Glass logo",style:{width:60,height:60,display:"block",margin:"0 auto 8px"}}),o.jsx("div",{style:{fontWeight:800,fontSize:20},children:"Pane in The Glass"})]}),o.jsxs("div",{style:{textAlign:"left"},children:[o.jsx("label",{children:"Email"}),o.jsx("input",{type:"text",inputMode:"email",value:t,onChange:h=>r(h.target.value),placeholder:"you@example.com",required:!0}),o.jsx("label",{style:{marginTop:10},children:"PIN"}),o.jsx("input",{type:"text",inputMode:"numeric",value:n,onChange:h=>i(h.target.value),placeholder:"",style:d,required:!0})]}),s&&o.jsx("div",{style:{color:"var(--danger)",marginTop:8,fontSize:13},children:s}),o.jsxs("div",{className:"row",style:{marginTop:14,alignItems:"center",gap:6},children:[o.jsx("button",{className:"btn",type:"submit",style:{flex:1},children:"Log In"}),o.jsx("button",{type:"button",className:"btn outline",onClick:l,children:"Toggle Theme"})]})]})})}function Ey(e,t){try{return JSON.parse(localStorage.getItem(e)||JSON.stringify(t))}catch{return t}}function Wj(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function zj(){return Ey("assignments",[])}function Hj(){return Ey("sales",[])}function n0(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Ty(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r}function Vj(){const e=n0(new Date);return Array.from({length:7},(t,r)=>Ty(e,r))}function Vl(e){return n0(e).toISOString().slice(0,10)}function Gj(e){return e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}const Fm=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Lm(e){if(!e)return{dateISO:null,hours:null};const t=String(e).trim(),r=t.match(/^(\d{4}-\d{2}-\d{2})(?:\s+([0-9:\-apmAPM\s]+))?/);if(r)return{dateISO:r[1],hours:(r[2]||"").trim()||null};const n=Fm.find(i=>t.toLowerCase().startsWith(i.toLowerCase())||t.toLowerCase().includes(` ${i.toLowerCase()} `)||t.toLowerCase().includes(`${i.toLowerCase()}:`)||t.toLowerCase().includes(`${i.toLowerCase()}-`));if(n){const i=Fm.indexOf(n),s=n0(new Date),a=s.getDay();let l=i-a;l<0&&(l+=7);const c=Ty(s,l),d=(t.split(new RegExp(n,"i"))[1]||"").replace(/^[^\dA-Za-z]*/,"").trim()||null;return{dateISO:Vl(c),hours:d}}return{dateISO:null,hours:null}}const Mm=e=>(e==null?void 0:e.address)||(e==null?void 0:e.addr)||(e==null?void 0:e.location)||(e==null?void 0:e.street)||(e==null?void 0:e.addressLine)||""||"",Bm=e=>(e==null?void 0:e.notes)||"-",Um=e=>{var t;return(e==null?void 0:e.sellerEmail)||((t=e==null?void 0:e.seller)==null?void 0:t.email)||(e==null?void 0:e.salespersonEmail)||""||""};function Kj(){const e=Wj(),t=(e==null?void 0:e.email)||"",r=de.useMemo(()=>zj(),[]),n=de.useMemo(()=>Hj(),[]),i=de.useMemo(()=>{const c=new Map;for(const u of n)u&&u.id!==void 0&&u.id!==null&&c.set(String(u.id),u);return c},[n]),s=de.useMemo(()=>{const c=Vj();return new Map(c.map(d=>[Vl(d),{date:d,rows:[]}]))},[]);de.useEffect(()=>{for(const c of r){const u=c&&c.saleId!=null?i.get(String(c.saleId)):null,d=Um(u);if(!d||d.toLowerCase()!==t.toLowerCase())continue;let h=c.dateISO||null,p=c.hours||null;if(!h||!p){const m=Lm(c.when);h=h||m.dateISO,p=p||m.hours}h&&s.has(h)&&s.get(h).rows.push({hours:p||"-",notes:Bm(u),address:Mm(u)})}for(const c of n){const u=Um(c);if(!u||u.toLowerCase()!==t.toLowerCase())continue;let d=c.dateISO||null,h=c.hours||null;if(!d||!h){const p=Lm(c.when);d=d||p.dateISO,h=h||p.hours}d&&s.has(d)&&s.get(d).rows.push({hours:h||"-",notes:Bm(c),address:Mm(c)})}l(Array.from(s.values()).map(c=>({date:c.date,rows:c.rows})))},[r,n,t]);const[a,l]=de.useState([]);return o.jsx("div",{className:"grid",children:o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"My Week (Seller)"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{className:"table",style:{minWidth:700},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:180},children:"Date"}),o.jsx("th",{style:{width:140},children:"Hours"}),o.jsx("th",{children:"Address To Go"}),o.jsx("th",{children:"Notes"})]})}),o.jsxs("tbody",{children:[a.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,style:{color:"var(--muted)"},children:"No scheduled items in the next 7 days."})}),a.map(({date:c,rows:u})=>{const d=Gj(c);return u.length===0?o.jsxs("tr",{children:[o.jsx("td",{children:d}),o.jsx("td",{colSpan:3,style:{color:"var(--muted)"},children:""})]},Vl(c)):u.map((h,p)=>o.jsxs("tr",{children:[p===0?o.jsx("td",{rowSpan:u.length,style:{verticalAlign:"top"},children:d}):null,o.jsx("td",{children:h.hours||"-"}),o.jsx("td",{children:h.address||"-"}),o.jsx("td",{children:h.notes||"-"})]},Vl(c)+"#"+p))})]})]})})]})})}function ky(){const e=localStorage.getItem("admin_show_name_on_cal")!=="false";let t=null;try{t=JSON.parse(localStorage.getItem("pane_user")||"null")}catch{}return!t||t.role!=="admin"||!e?null:o.jsxs("div",{style:{margin:"-10px 0 6px 0",fontSize:14,color:"var(--muted)",fontWeight:600},children:["(Admin) ",t.name??"Admin"]})}const jy=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},Jj=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),Xj=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},Yj=()=>jy("users_seed",[]),Ay=()=>jy("availability",[]),qj=e=>Jj("availability",e),Cy=e=>{const t=new Date(e);return t.setHours(0,0,0,0),t},Qj=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+t),r},Zj=e=>Cy(e).toISOString().slice(0,10),eA=e=>e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),$m=e=>e.toLocaleDateString([],{weekday:"short"}).slice(0,3),tA=e=>e&&(e.role==="seller"||e.role==="hybrid");function rA(e,t,r){const i=Ay().find(s=>s.userEmail===e&&t.includes(s.role)&&s.day===r);return(i==null?void 0:i.hours)||""}function nA(e,t,r){const n=Ay(),i=n.findIndex(s=>s.userEmail===e&&s.role==="seller"&&s.day===t);i===-1?n.push({userEmail:e,role:"seller",day:t,hours:(r||"").trim()}):n[i]={...n[i],hours:(r||"").trim()},qj(n)}function iA(){const e=Xj(),t=(e==null?void 0:e.email)||"",r=de.useMemo(()=>{const l=Cy(new Date);return Array.from({length:14},(c,u)=>Qj(l,u))},[]),n=de.useMemo(()=>{const l=Yj().filter(tA);return(e==null?void 0:e.role)==="admin"&&t&&!l.some(c=>c.email===t)&&l.unshift({email:t,name:e.name||"Admin",role:"hybrid"}),l},[e,t]),i=l=>l!==t,s=(l,c,u)=>{if(l!==t)return;const d=$m(c);nA(l,d,u)},a=localStorage.getItem("admin_show_name_on_cal")!=="false";return o.jsxs("div",{className:"grid",children:[(e==null?void 0:e.role)==="admin"&&o.jsx(ky,{}),o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"Sellers Calendar (Rolling 2 Weeks)"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{className:"table",style:{minWidth:1200},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:220},children:"Seller"}),r.map(l=>o.jsx("th",{children:eA(l)},l.toISOString()))]})}),o.jsxs("tbody",{children:[n.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:1+r.length,style:{color:"var(--muted)"},children:"No sellers."})}),n.map(l=>{const c=l.email===t,u=c&&(e==null?void 0:e.role)==="admin"&&a?`${l.name} (Admin)`:l.name;return o.jsxs("tr",{children:[o.jsxs("td",{style:{fontWeight:c?700:500},children:[u,c?" (You)":""]}),r.map(d=>{const h=$m(d),p=rA(l.email,["seller","hybrid"],h),m=i(l.email);return o.jsx("td",{children:o.jsx("input",{value:p,onChange:y=>s(l.email,d,y.target.value),placeholder:"hours",disabled:m,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:c?600:400}})},l.email+Zj(d))})]},l.email)})]})]})})]})]})}const Ny=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},sA=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},aA=()=>Ny("sales",[]),oA=()=>Ny("seller_calendar",[]),ml=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-";function lA(){const e=new Date,r=(5-e.getDay()+7)%7||7,n=new Date(e);return n.setDate(e.getDate()+r),n.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}function cA(e){if(!e)return 0;const t=String(e).toLowerCase();let r=t.match(/(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)\s*[-]\s*(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)/i)||t.match(/(\d{1,2}:\d{2})\s*-\s*(\d{1,2}:\d{2})/)||t.match(/(\d{1,2})\s*-\s*(\d{1,2})/i);if(!r)return 0;const n=a=>{let l=a.trim(),c=/pm/.test(l),u=/am/.test(l);l=l.replace(/\s*(am|pm)/g,"");let[d,h="0"]=l.split(":"),p=parseInt(d),m=parseInt(h)||0;return c&&p<12&&(p+=12),u&&p===12&&(p=0),p*60+m},i=n(r[1]),s=n(r[2]);return Math.max(0,(s-i)/60)}function uA(e,t){let r=0;for(const n of e)!(n!=null&&n.sellerEmail)||n.sellerEmail.toLowerCase()!==(t||"").toLowerCase()||(r+=cA(n.time||""));return r}function dA(){const e=sA();e==null||e.role;const t=(e==null?void 0:e.role)==="seller",r=(e==null?void 0:e.email)||"",n=de.useMemo(()=>aA(),[]),i=de.useMemo(()=>oA(),[]),s=de.useMemo(()=>r?n.filter(u=>((u==null?void 0:u.sellerEmail)||"").toLowerCase()===r.toLowerCase()).map(u=>({id:u.id,date:u.soldAt||(u.createdAt?new Date(u.createdAt).toLocaleString():"-"),customer:u.name||"-",address:u.address||"-",price:isFinite(+u.price)?+u.price:null,yourShare:isFinite(+u.price)?+u.price*.3:null,notes:u.notes||"-",status:u.status||"unassigned"})).sort((u,d)=>(d.date||"").localeCompare(u.date||"")):[],[n,r]),a=s.reduce((u,d)=>u+(d.yourShare??0),0),l=lA(),c=de.useMemo(()=>uA(i,r),[i,r]);return o.jsxs("div",{className:"grid",children:[t&&o.jsxs("div",{className:"card",style:{paddingTop:0},children:[o.jsx("h2",{className:"section-title",style:{margin:"18px 0 0 0",lineHeight:0},children:"Paycheck"}),o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:10,marginTop:-54},children:[o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Total Paycheck"}),o.jsx("div",{style:{fontSize:24,fontWeight:900,marginTop:6},children:ml(a)}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)"},children:"Seller earnings @ 30%"})]}),o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Next Payday"}),o.jsx("div",{style:{fontSize:20,fontWeight:800,marginTop:6},children:l})]}),o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Hours (Seller)"}),o.jsx("div",{style:{fontSize:20,fontWeight:800,marginTop:6},children:isFinite(c)?`${c.toFixed(1)} hrs`:"-"}),o.jsx("div",{className:"muted",style:{fontSize:12},children:"From accepted neighborhood times"})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:12},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:2},children:"Payments (Seller)"}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date Sold"}),o.jsx("th",{children:"Customer"}),o.jsx("th",{children:"Address"}),o.jsx("th",{style:{textAlign:"right"},children:"Sale Price"}),o.jsx("th",{style:{textAlign:"right"},children:"Your 30%"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Notes"})]})}),o.jsxs("tbody",{children:[s.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,style:{color:"var(--muted)"},children:"No seller payments right now."})}),s.map(u=>o.jsxs("tr",{children:[o.jsx("td",{children:u.date}),o.jsx("td",{style:{fontWeight:600},children:u.customer}),o.jsx("td",{style:{fontSize:12,color:"var(--muted)"},children:u.address}),o.jsx("td",{style:{textAlign:"right"},children:u.price==null?"-":ml(u.price)}),o.jsx("td",{style:{textAlign:"right"},children:u.yourShare==null?"-":ml(u.yourShare)}),o.jsx("td",{children:u.status}),o.jsx("td",{style:{whiteSpace:"pre-wrap"},children:u.notes})]},u.id)),s.length>0&&o.jsxs("tr",{children:[o.jsx("td",{colSpan:4}),o.jsx("td",{style:{textAlign:"right"},children:o.jsx("strong",{children:ml(a)})}),o.jsx("td",{colSpan:2,children:o.jsx("span",{className:"chip",children:"Subtotal (Seller)"})})]})]})]})]})]})}function hA(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function i0(e,t){try{return JSON.parse(localStorage.getItem(e)||JSON.stringify(t))}catch{return t}}function fA(e,t){localStorage.setItem("item_"+e,JSON.stringify(t)),localStorage.setItem(e,JSON.stringify(t))}function id(){return i0("sales",[])}function pA(e){fA("sales",e)}function Wm(){return i0("assignments",[])}function mA(){return i0("users_seed",[])}function zm(){const e=new Date,t=l=>String(l).padStart(2,"0"),r=e.getFullYear(),n=t(e.getMonth()+1),i=t(e.getDate()),s=t(e.getHours()),a=t(e.getMinutes());return`${r}-${n}-${i}T${s}:${a}`}function gA(){const e=hA(),[t,r]=X.useState(id()),[n,i]=X.useState(Wm()),s=mA(),[a,l]=X.useState({name:"",phone:"",price:"",address:"",neighborhood:"",notes:"",soldAt:zm()});X.useEffect(()=>{r(id()),i(Wm())},[]);const c=f=>{const g=n.find(x=>String(x.saleId)===String(f));return g?[g.workerEmail,g.worker2Email].filter(Boolean).map(x=>{var w;return((w=s.find(E=>E.email===x))==null?void 0:w.name)||x}):[]},u=f=>{var v;const g=Number(((v=String(f.id||"").match(/\d+/))==null?void 0:v[0])||0);return Number(f.createdAt||f.updatedAt||g||0)},d=X.useMemo(()=>t.slice().sort((f,g)=>u(g)-u(f)).slice(0,50),[t]),h=()=>{const f=id(),v={id:Date.now(),name:a.name.trim(),phone:a.phone.trim(),price:a.price,address:a.address,neighborhood:a.neighborhood,notes:a.notes,sellerEmail:e.email,sellerName:e.name,status:"unassigned",createdAt:Date.now(),soldAt:a.soldAt};f.push(v),pA(f),r(f),l({name:"",phone:"",price:"",address:"",neighborhood:"",notes:"",soldAt:zm()}),alert("Sale added!")},p=()=>{if(!a.name.trim()||!a.phone.trim()||!a.soldAt.trim()){alert("Customer name, phone number, and Date & Time Sold are required.");return}h()},m=X.useMemo(()=>e?d.filter(f=>(f.sellerEmail===e.email||f.createdBy===e.email)&&f.status!=="finished"):[],[d,e]),y=f=>{const g=Number(f);return isFinite(g)?`$${(g*.3).toFixed(2)} (Total $${g.toFixed(2)})`:"-"};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsxs("h2",{className:"section-title",style:{marginTop:4,marginBottom:4,display:"flex",alignItems:"baseline",gap:10,flexWrap:"wrap"},children:[o.jsx("span",{children:"Record a New Sale"}),o.jsx("span",{style:{fontSize:12,fontWeight:800,letterSpacing:.3,textTransform:"uppercase",color:"var(--danger)"},children:"MUST BE CONFIRMED SALE  IF NOT, ADD IN NOTES"})]}),o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2,1fr)",gap:10,marginTop:0,paddingTop:0},children:[o.jsx("input",{placeholder:"Customer Name*",value:a.name,onChange:f=>l({...a,name:f.target.value})}),o.jsx("input",{placeholder:"Phone*",value:a.phone,onChange:f=>l({...a,phone:f.target.value})}),o.jsx("input",{placeholder:"Price ($)",value:a.price,onChange:f=>l({...a,price:f.target.value})}),o.jsx("input",{placeholder:"Address",value:a.address,onChange:f=>l({...a,address:f.target.value})}),o.jsx("input",{placeholder:"Neighborhood",value:a.neighborhood,onChange:f=>l({...a,neighborhood:f.target.value})}),o.jsx("input",{type:"datetime-local",placeholder:"Date & Time Sold*",value:a.soldAt,onChange:f=>l({...a,soldAt:f.target.value})}),o.jsx("textarea",{placeholder:"Notes (optional)",value:a.notes,onChange:f=>l({...a,notes:f.target.value}),style:{gridColumn:"1 / span 2"}})]}),o.jsx("div",{className:"toolbar",style:{marginTop:10},children:o.jsx("button",{className:"btn",onClick:p,children:"Add Sale"})}),o.jsx("p",{className:"muted",style:{marginTop:6,fontSize:12},children:"A timestamp is saved automatically when you add a sale."})]}),o.jsxs("div",{className:"card",style:{minHeight:"140px",padding:"10px"},children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6,textAlign:"center"},children:"Recent Sales"}),Array.isArray(m)&&m.length>0?o.jsx("div",{className:"grid",style:{gap:10,marginTop:"-65px"},children:[...m].sort((f,g)=>(g.createdAt||0)-(f.createdAt||0)).map(f=>{const g=c(f.id);return o.jsx("div",{className:"card",style:{padding:10},children:o.jsxs("div",{style:{display:"grid",gap:6},children:[o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Date Sold"}),o.jsx("div",{children:f.soldAt||(f.createdAt?new Date(f.createdAt).toLocaleString():"-")})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Customer"}),o.jsx("div",{children:f.name})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Address"}),o.jsx("div",{children:f.address||"-"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Neighborhood"}),o.jsx("div",{children:f.neighborhood||"-"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Pay for you (30%)"}),o.jsx("div",{children:y(f.price)})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Workers"}),o.jsx("div",{children:g.length?g.join(" & "):"-"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Status"}),o.jsx("div",{children:f.status||"unassigned"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700,textTransform:"uppercase"},children:"Notes"}),o.jsx("div",{children:f.notes||"-"})]})]})},f.id)})}):o.jsx("p",{className:"muted",style:{margin:0,textAlign:"center"},children:"No recent sales."})]})]})}function xA(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function vA(){try{return JSON.parse(localStorage.getItem("availability")||"[]")}catch{return[]}}function yA(){try{return JSON.parse(localStorage.getItem("assignments")||"[]")}catch{return[]}}function wA(){try{return JSON.parse(localStorage.getItem("sales")||"[]")}catch{return[]}}function _A(){try{return JSON.parse(localStorage.getItem("users_seed")||"[]")}catch{return[]}}function SA(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function EA(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r}function TA(e){return e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}function kA(e){return e.toLocaleDateString([],{weekday:"short"})}const Hm=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-";function jA({children:e,kind:t="muted"}){const r=t==="ok"?"var(--ok, #16a34a20)":t==="warn"?"var(--warn, #f59e0b20)":t==="info"?"var(--info, #3b82f620)":"var(--border)",n=t==="ok"?"#16a34a":t==="warn"?"#b45309":t==="info"?"#1d4ed8":"var(--muted)";return o.jsx("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:999,background:r,color:n,fontSize:12,fontWeight:600},children:e})}function Vm({customer:e,when:t,moneyText:r,address:n,otherWorker:i,notes:s,right:a}){return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:10,padding:"10px 12px",border:"1px solid var(--border)",borderRadius:12,background:"var(--card)"},children:[o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center"},children:[o.jsx("div",{style:{fontWeight:800,fontSize:15,overflow:"hidden",textOverflow:"ellipsis"},children:e||"-"}),r?o.jsx("div",{style:{fontWeight:800},children:r}):null]}),o.jsxs("div",{style:{marginTop:6,fontSize:12,color:"var(--muted)"},children:[t?o.jsxs("span",{children:[" ",t]}):null,n?o.jsxs("span",{style:{marginLeft:10},children:[" ",n]}):null,i?o.jsxs("span",{style:{marginLeft:10},children:[" with ",i]}):null,s?o.jsxs("span",{style:{marginLeft:10},children:[" note: ",s]}):null]})]}),o.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"flex-end"},children:a})]})}function AA(){const e=xA(),t=_A(),[r]=X.useState(vA()),[n,i]=X.useState(yA()),s=wA(),a=X.useMemo(()=>{const E=SA(new Date);return Array.from({length:7},(C,A)=>EA(E,A))},[]),l=E=>{const C=r.find(A=>A.userEmail===(e==null?void 0:e.email)&&A.role==="worker"&&A.day===E);return(C==null?void 0:C.hours)||""},c=E=>{var C;return((C=t.find(A=>A.email===E))==null?void 0:C.name)||E||"-"},u=X.useMemo(()=>n.filter(C=>(C.workerEmail===(e==null?void 0:e.email)||C.worker2Email===(e==null?void 0:e.email))&&C.status!=="offered").map(C=>{const A=s.find(z=>String(z.id)===String(C.saleId)),k=C.workerEmail===(e==null?void 0:e.email)?C.worker2Email:C.workerEmail,O=A!=null&&A.price?Number(A.price):null,U=O!=null?Hm(O*.2):"-";return{id:C.id,customer:(A==null?void 0:A.name)||C.saleId,address:(A==null?void 0:A.address)||"-",when:C.when||"-",otherWorker:k?c(k):"-",myMoney:U,notes:(A==null?void 0:A.notes)||""}}),[n,s,e==null?void 0:e.email]),d=X.useMemo(()=>n.filter(E=>{const C=Array.isArray(E.offeredTo)&&E.offeredTo.includes(e==null?void 0:e.email);return E.status==="offered"&&C}).map(E=>{const C=s.find(U=>String(U.id)===String(E.saleId)),A=C!=null&&C.price?Number(C.price):null,k=A!=null?Hm(A*.2):"-",O=E.workerEmail&&E.workerEmail!==(e==null?void 0:e.email)?E.workerEmail:E.worker2Email&&E.worker2Email!==(e==null?void 0:e.email)?E.worker2Email:null;return{id:E.id,customer:(C==null?void 0:C.name)||E.saleId,address:(C==null?void 0:C.address)||"-",when:E.when||"-",otherWorker:O?c(O):"-",myMoney:k,notes:(C==null?void 0:C.notes)||""}}),[n,s,e==null?void 0:e.email]),h=E=>{const C=JSON.parse(localStorage.getItem("assignments")||"[]"),A=C.findIndex(V=>V.id===E);if(A===-1)return;const k=C[A];let O=k.workerEmail,U=k.worker2Email;!O&&!U?O=e.email:O&&!U?U=e.email:!O&&U&&(O=e.email);const z={...k,workerEmail:O,worker2Email:U,status:"assigned",offeredTo:(k.offeredTo||[]).filter(V=>V!==e.email)};C[A]=z,localStorage.setItem("assignments",JSON.stringify(C)),i(C),alert("Offer accepted.")},[p,m]=X.useState(null),[y,f]=X.useState(""),g=E=>{m(E),f("")},v=()=>{m(null),f("")},x=()=>{if(!y.trim()){alert("Please enter a reason.");return}const E=JSON.parse(localStorage.getItem("assignments")||"[]"),C=E.findIndex(O=>O.id===p);if(C===-1)return;const A=E[C],k={...A,denied:[...A.denied||[],{email:e.email,reason:y.trim(),ts:Date.now()}],offeredTo:(A.offeredTo||[]).filter(O=>O!==e.email)};E[C]=k,localStorage.setItem("assignments",JSON.stringify(E)),i(E),m(null),f(""),alert("Offer denied.")},w=X.useMemo(()=>{const E=n.filter(k=>k.status!=="offered"&&(k.workerEmail===(e==null?void 0:e.email)||k.worker2Email===(e==null?void 0:e.email))),C={},A=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];for(const k of E){const O=s.find(V=>String(V.id)===String(k.saleId)),U=k.when||"",z=A.find(V=>U.toLowerCase().includes(V.toLowerCase()));z&&(C[z]||(C[z]=[])).push({customer:(O==null?void 0:O.name)||k.saleId,when:k.when||"-"})}return C},[n,s,e==null?void 0:e.email]);return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"My Upcoming Assignments"}),o.jsxs("div",{style:{display:"grid",gap:10},children:[u.length===0&&o.jsx("div",{className:"muted",style:{padding:"8px 0"},children:"No upcoming assignments."}),u.map(E=>o.jsx(Vm,{customer:E.customer,when:E.when,moneyText:E.myMoney,address:E.address,otherWorker:E.otherWorker,notes:E.notes,right:o.jsx(jA,{kind:"info",children:"Assigned"})},E.id))]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"Offered Assignments"}),o.jsxs("div",{style:{display:"grid",gap:10},children:[d.length===0&&o.jsx("div",{className:"muted",style:{padding:"8px 0"},children:"No offers."}),d.map(E=>o.jsx(Vm,{customer:E.customer,when:E.when,moneyText:E.myMoney,address:E.address,otherWorker:E.otherWorker,notes:E.notes,right:o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn",onClick:()=>h(E.id),children:"Accept"}),o.jsx("button",{className:"btn outline",onClick:()=>g(E.id),children:"Deny"})]})},E.id))]}),p!=null&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:o.jsxs("div",{className:"card",style:{width:420,maxWidth:"90vw"},children:[o.jsx("h3",{className:"section-title",style:{marginTop:0},children:"Why are you denying?"}),o.jsx("textarea",{rows:4,value:y,onChange:E=>f(E.target.value),placeholder:"Type the reason..."}),o.jsxs("div",{className:"row",style:{justifyContent:"flex-end",marginTop:10},children:[o.jsx("button",{className:"btn outline",onClick:v,children:"Cancel"}),o.jsx("button",{className:"btn",onClick:x,children:"Submit"})]})]})})]}),o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"My Weekly Hours (Next 7 Days)  Scheduled"}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsx("tr",{children:a.map(E=>o.jsx("th",{children:TA(E)},E.toISOString()))})}),o.jsx("tbody",{children:o.jsx("tr",{children:a.map(E=>{const C=kA(E).slice(0,3),A=l(C),k=w[C]||[];return o.jsxs("td",{children:[o.jsx("input",{value:A,readOnly:!0,disabled:!0,style:{width:"100%",opacity:.8,cursor:"not-allowed"}}),k.length>0&&o.jsx("div",{style:{marginTop:6,fontSize:12,color:"#8fb7c9"},children:k.map((O,U)=>o.jsxs("div",{children:[" ",O.customer,"  ",O.when]},U))})]},E.toISOString())})})})]})]})]})}const au=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},CA=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),NA=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},bA=()=>au("users_seed",[]),by=()=>au("availability",[]),OA=e=>CA("availability",e),IA=()=>au("assignments",[]),PA=()=>au("sales",[]),Gl=e=>{const t=new Date(e);return t.setHours(0,0,0,0),t},RA=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+t),r},DA=e=>Gl(e).toISOString().slice(0,10),FA=e=>e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),sd=e=>e.toLocaleDateString([],{weekday:"short"}).slice(0,3),LA=e=>e&&(e.role==="worker"||e.role==="hybrid");function MA(e,t,r){const i=by().find(s=>s.userEmail===e&&t.includes(s.role)&&s.day===r);return(i==null?void 0:i.hours)||""}function BA(e,t,r){const n=by(),i=n.findIndex(s=>s.userEmail===e&&s.role==="worker"&&s.day===t);i===-1?n.push({userEmail:e,role:"worker",day:t,hours:(r||"").trim()}):n[i]={...n[i],hours:(r||"").trim()},OA(n)}function UA(){var y;const e=NA(),t=(e==null?void 0:e.email)||"";if((typeof window<"u"&&((y=window.location)==null?void 0:y.pathname)||"").startsWith("/admin")&&(e==null?void 0:e.role)!=="admin")return typeof window<"u"&&(window.location.href="/"),null;const i=de.useMemo(()=>{const f=Gl(new Date);return Array.from({length:14},(g,v)=>RA(f,v))},[]),s=de.useMemo(()=>{const f=bA().filter(LA);return(e==null?void 0:e.role)==="admin"&&t&&!f.some(g=>g.email===t)&&f.unshift({email:t,name:e.name||"Admin",role:"hybrid"}),f},[e,t]),a=de.useMemo(()=>PA(),[]),l=()=>IA(),[c,u]=de.useState(l());de.useEffect(()=>{const f=setInterval(()=>u(l()),1500);return()=>clearInterval(f)},[]);const d=de.useMemo(()=>{const f=new Map,g=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];for(const v of c)for(const x of[v.workerEmail,v.worker2Email]){if(!x)continue;const w=(v.when||"").toLowerCase(),E=g.find(O=>w.includes(O.toLowerCase()));if(!E)continue;const C=a.find(O=>String(O.id)===String(v.saleId)),A=`${x}|${E}`,k=f.get(A)||[];k.push({customer:(C==null?void 0:C.name)||v.saleId,address:(C==null?void 0:C.address)||"-",when:v.when||"-"}),f.set(A,k)}return f},[c,a]),h=(f,g)=>{if(f!==t)return!0;const v=Gl(new Date),x=Gl(g),w=Math.round((x-v)/(24*60*60*1e3)),E=w<=2&&w>=0,C=sd(g),A=(d.get(`${f}|${C}`)||[]).length>0;return E||A},p=(f,g,v)=>{if(f!==t||h(f,g))return;const x=sd(g);BA(f,x,v)},m=localStorage.getItem("admin_show_name_on_cal")!=="false";return o.jsxs("div",{className:"grid",children:[(e==null?void 0:e.role)==="admin"&&o.jsx(ky,{}),o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"Workers Calendar (Rolling 2 Weeks)"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{className:"table",style:{minWidth:1200},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:220},children:"Worker"}),i.map(f=>o.jsx("th",{children:FA(f)},f.toISOString()))]})}),o.jsxs("tbody",{children:[s.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:1+i.length,style:{color:"var(--muted)"},children:"No workers."})}),s.map(f=>{const g=f.email===t,v=g&&(e==null?void 0:e.role)==="admin"&&m?`${f.name} (Admin)`:f.name;return o.jsxs("tr",{children:[o.jsxs("td",{style:{fontWeight:g?700:500},children:[v,g?" (You)":""]}),i.map(x=>{const w=sd(x),E=MA(f.email,["worker","hybrid"],w),C=d.get(`${f.email}|${w}`)||[],A=h(f.email,x);return o.jsxs("td",{children:[o.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[A&&g&&o.jsx("span",{title:"Locked",children:o.jsx("span",{role:"img","aria-label":"locked",children:""})}),o.jsx("input",{value:E,onChange:k=>p(f.email,x,k.target.value),placeholder:"hours",disabled:A,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:g?600:400}})]}),C.length>0&&o.jsx("div",{style:{marginTop:6,fontSize:12,color:"var(--muted)"},children:C.map((k,O)=>o.jsxs("div",{children:[" ",o.jsx("strong",{children:k.customer}),k.address?`  ${k.address}`:"","  ",k.when]},O))})]},f.email+DA(x))})]},f.email)})]})]})})]})]})}const Oy=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},$A=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},WA=()=>Oy("assignments",[]),zA=()=>Oy("sales",[]),ad=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-",HA=()=>{const e=new Date,r=(5-e.getDay()+7)%7||7,n=new Date(e);return n.setDate(e.getDate()+r),n.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})},VA=e=>{if(!e)return 0;const t=String(e).toLowerCase();let r=t.match(/(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)\s*[-]\s*(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)/i);if(r||(r=t.match(/(\d{1,2}:\d{2})\s*-\s*(\d{1,2}:\d{2})/)),r||(r=t.match(/(?:mon|tue|wed|thu|fri|sat|sun)?\s*(\d{1,2})\s*-\s*(\d{1,2})/i)),!r)return 0;const n=(c,u=null)=>{let d=c.replace(/\s*(am|pm)/g,"").trim(),[h,p="0"]=d.split(":"),m=parseInt(h,10),y=parseInt(p,10)||0;const f=/pm/.test(c),g=/am/.test(c);return f&&m<12&&(m+=12),!f&&!g&&u&&(m+=12),m*60+y},i=r[1],s=r[2];let a=n(i),l=n(s);return l<=a&&(l=n(s,!0)),Math.max(0,(l-a)/60)},GA=(e,t)=>{let r=0;for(const n of e)(n.workerEmail===t||n.worker2Email===t)&&n.status!=="offered"&&(r+=VA(n.when));return r};function KA(){const e=$A(),t=(e==null?void 0:e.email)||"",r=de.useMemo(()=>WA(),[]),n=de.useMemo(()=>zA(),[]),i=HA(),s=de.useMemo(()=>GA(r,t),[r,t]),a=de.useMemo(()=>{const c=new Map(n.map(u=>[String(u.id),u]));return r.filter(u=>(u.workerEmail===t||u.worker2Email===t)&&u.status!=="offered").map(u=>{const d=c.get(String(u.saleId)),h=isFinite(+(d==null?void 0:d.price))?+d.price:null,p=h!=null?h*.2:null;return{id:u.id,date:u.when||"-",customer:(d==null?void 0:d.name)||u.saleId,address:(d==null?void 0:d.address)||"-",yourShare:p,notes:(d==null?void 0:d.notes)||"-"}})},[r,n,t]),l=a.reduce((c,u)=>c+(u.yourShare??0),0);return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Paycheck"}),o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3,1fr)",gap:8,marginTop:0,paddingTop:0},children:[o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Total Paycheck"}),o.jsx("div",{style:{fontSize:24,fontWeight:900,marginTop:6},children:ad(l)}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)"},children:"= 20% (Worker)"})]}),o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Next Payday"}),o.jsx("div",{style:{fontSize:20,fontWeight:800,marginTop:6},children:i})]}),o.jsxs("div",{className:"card",style:{padding:"12px 14px"},children:[o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:"Hours Worked"}),o.jsx("div",{style:{fontSize:20,fontWeight:800,marginTop:6},children:isFinite(s)?`${s.toFixed(1)} hrs`:"-"}),o.jsx("div",{className:"muted",style:{fontSize:12},children:"Based on job times"})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Next Payments"}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date & Time"}),o.jsx("th",{children:"Customer"}),o.jsx("th",{children:"Address"}),o.jsx("th",{children:"Your Share (20%)"}),o.jsx("th",{children:"Notes"})]})}),o.jsxs("tbody",{children:[a.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,style:{color:"var(--muted)"},children:"No worker payments yet."})}),a.map(c=>o.jsxs("tr",{children:[o.jsx("td",{children:c.date}),o.jsx("td",{children:c.customer}),o.jsx("td",{children:c.address}),o.jsx("td",{children:c.yourShare==null?"-":ad(c.yourShare)}),o.jsx("td",{style:{maxWidth:280,whiteSpace:"pre-wrap"},children:c.notes})]},c.id)),a.length>0&&o.jsxs("tr",{children:[o.jsx("td",{colSpan:3}),o.jsx("td",{children:o.jsx("strong",{children:ad(l)})}),o.jsx("td",{children:o.jsx("span",{className:"chip",children:"Subtotal (Worker)"})})]})]})]})]})]})}function JA(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function Gm(){try{return JSON.parse(localStorage.getItem("finished_jobs")||"[]")}catch{return[]}}function XA(e){localStorage.setItem("finished_jobs",JSON.stringify(e))}function YA(){const e=JA(),[t,r]=X.useState(Gm()),[n,i]=X.useState({name:"",address:"",notes:"",otherWorker:""}),s=()=>{if(!n.name.trim()||!n.address.trim()||!n.otherWorker.trim()){alert("Customer Name, Address, and Other Worker are required.");return}const a=Gm();a.push({...n,addedBy:e==null?void 0:e.email,ts:Date.now()}),XA(a),r(a),i({name:"",address:"",notes:"",otherWorker:""}),alert("Job marked finished!")};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Job Finished"}),o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2,1fr)",gap:10,marginTop:0,paddingTop:0},children:[o.jsx("input",{placeholder:"Customer Name*",value:n.name,onChange:a=>i({...n,name:a.target.value})}),o.jsx("input",{placeholder:"Address*",value:n.address,onChange:a=>i({...n,address:a.target.value})}),o.jsx("input",{placeholder:"Other Worker*",value:n.otherWorker,onChange:a=>i({...n,otherWorker:a.target.value}),required:!0}),o.jsx("textarea",{placeholder:"Notes (optional)",style:{gridColumn:"1 / span 2"},value:n.notes,onChange:a=>i({...n,notes:a.target.value})})]}),o.jsx("div",{className:"toolbar",style:{marginTop:10},children:o.jsx("button",{className:"btn",onClick:s,children:"Submit Finished Job"})})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Past Jobs (7 Days)"}),t.filter(a=>Date.now()-a.ts<=7*24*60*60*1e3).length===0?o.jsx("p",{style:{color:"var(--muted)"},children:"No finished jobs yet."}):t.filter(a=>Date.now()-a.ts<=7*24*60*60*1e3).sort((a,l)=>l.ts-a.ts).map((a,l)=>o.jsx("table",{className:"table",style:{marginBottom:12},children:o.jsxs("tbody",{children:[o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left"},children:"Date & Time"})}),o.jsx("tr",{children:o.jsx("td",{children:new Date(a.ts).toLocaleString([],{dateStyle:"short",timeStyle:"short"})})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left"},children:"Customer"})}),o.jsx("tr",{children:o.jsx("td",{children:a.name||"-"})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left"},children:"Address"})}),o.jsx("tr",{children:o.jsx("td",{children:a.address||"-"})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left"},children:"Other Worker"})}),o.jsx("tr",{children:o.jsx("td",{children:a.otherWorker||"-"})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left"},children:"Notes"})}),o.jsx("tr",{children:o.jsx("td",{children:a.notes||"-"})})]})},l))]})]})}const sa=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},qA=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},QA=()=>sa("users_seed",[]),ZA=()=>sa("availability",[]),Km=()=>sa("assignments",[]),eC=()=>sa("sales",[]),tC=()=>sa("seller_calendar",[]),rC=()=>sa("neighborhoodAssignments",[]),Iy=e=>{const t=new Date(e);return t.setHours(0,0,0,0),t},nC=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+t),r},od=e=>Iy(e).toISOString().slice(0,10),iC=e=>e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),Jm=e=>e.toLocaleDateString([],{weekday:"short"}).slice(0,3);function sC(){const e=qA(),t=(e==null?void 0:e.email)||"",r=de.useMemo(()=>{const f=Iy(new Date);return Array.from({length:5},(g,v)=>nC(f,v))},[]),n=de.useMemo(()=>tC(),[]),i=de.useMemo(()=>ZA().filter(f=>f.role==="seller"),[]),s=de.useMemo(()=>{const f=new Map(r.map(g=>[od(g),{date:g,rows:[]}]));for(const g of n)!(g!=null&&g.sellerEmail)||g.sellerEmail.toLowerCase()!==t.toLowerCase()||!g.dateISO||!f.has(g.dateISO)||f.get(g.dateISO).rows.push({hours:g.time||"-",name:g.neighborhood||g.title||"",address:g.address||"-",notes:g.notes||"",locked:!0});for(const g of r){const v=od(g),x=Jm(g),w=i.find(E=>E.userEmail===t&&E.day===x);w&&(f.get(v).rows||[]).length===0&&f.get(v).rows.push({hours:w.hours||"-",name:"",address:"-",notes:"",locked:!1})}return f},[t,i,n,r]),[a,l]=de.useState(Km()),c=de.useMemo(()=>eC(),[]),u=de.useMemo(()=>QA(),[]);de.useEffect(()=>{const f=setInterval(()=>l(Km()),1200);return()=>clearInterval(f)},[]);const d=f=>{var g;return((g=u.find(v=>v.email===f))==null?void 0:g.name)||f||"-"},h=de.useMemo(()=>a.filter(g=>(g.workerEmail===t||g.worker2Email===t)&&g.status==="assigned").map(g=>{const v=c.find(C=>String(C.id)===String(g.saleId)),x=g.workerEmail===t?g.worker2Email:g.workerEmail,w=v!=null&&v.price?Number(v.price):null,E=w!=null?`$${(w*.2).toFixed(2)}`:"-";return{id:g.id,when:g.when||"-",customer:(v==null?void 0:v.name)||g.saleId,address:(v==null?void 0:v.address)||"-",otherWorker:x?d(x):"-",myMoney:E}}),[a,c,t,u]),p=de.useMemo(()=>a.filter(f=>{const g=Array.isArray(f.offeredTo)&&f.offeredTo.includes(t);return f.status==="offered"&&g}).map(f=>{const g=c.find(E=>String(E.id)===String(f.saleId)),v=g!=null&&g.price?Number(g.price):null,x=v!=null?`$${(v*.2).toFixed(2)}`:"-",w=f.workerEmail&&f.workerEmail!==t?f.workerEmail:f.worker2Email&&f.worker2Email!==t?f.worker2Email:null;return{id:f.id,raw:f,when:f.when||"-",customer:(g==null?void 0:g.name)||f.saleId,address:(g==null?void 0:g.address)||"-",otherWorker:w?d(w):"-",myMoney:x}}),[a,c,t,u]),m=de.useMemo(()=>rC(),[]),y=de.useMemo(()=>(m||[]).filter(g=>g.sellerEmail===t).filter(g=>!g.accepted&&!(g.denied||[]).some(v=>v.email===t)).sort((g,v)=>String(g.dateISO||"").localeCompare(String(v.dateISO||""))),[m,t]);return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",children:"This Week (Both)"}),o.jsx("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat("+r.length+",1fr)",fontSize:12},children:r.map(f=>{var w;const g=od(f),v=((w=s.get(g))==null?void 0:w.rows)||[],x=h.filter(E=>(E.when||"").toLowerCase().includes(Jm(f).toLowerCase()));return o.jsxs("div",{className:"card",style:{padding:"6px 8px"},children:[o.jsx("div",{style:{fontWeight:800,marginBottom:4,fontSize:12},children:iC(f)}),v.length===0?o.jsx("div",{className:"muted",style:{fontSize:11},children:"Seller: "}):v.map((E,C)=>o.jsxs("div",{style:{fontSize:11,marginBottom:3},children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Seller:"})," ",E.hours||"-"," ",E.name?`(${E.name})`:""]}),E.locked&&o.jsxs("div",{style:{color:"var(--muted)"},children:[" Locked  ",E.address,E.notes?`  ${E.notes}`:""]})]},C)),x.length===0?o.jsx("div",{className:"muted",style:{fontSize:11},children:"Worker: "}):x.map((E,C)=>o.jsx("div",{style:{fontSize:11},children:o.jsxs("div",{children:[o.jsx("strong",{children:"Worker:"})," ",E.when," (",E.customer,E.address?`  ${E.address}`:"",")"]})},"w"+C))]},g)})})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",children:"Offered Neighborhoods (Seller)"}),o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"33%"},children:"Date & Time"}),o.jsx("th",{style:{width:"33%"},children:"Street(s)"}),o.jsx("th",{style:{width:"33%"},children:"Notes"})]})}),o.jsxs("tbody",{children:[y.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:3,style:{color:"var(--muted)"},children:"No neighborhood offers right now."})}),y.map(f=>o.jsxs("tr",{children:[o.jsx("td",{children:f.dateISO?new Date(f.dateISO).toLocaleString():"-"}),o.jsx("td",{children:f.neighborhood||f.address||"-"}),o.jsx("td",{children:f.notes||"-"})]},f.id))]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",children:"Offered Assignments (Worker)"}),o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"33%"},children:"Date & Time"}),o.jsx("th",{style:{width:"33%"},children:"Customer / Address"}),o.jsx("th",{style:{width:"33%"},children:"Other Worker"})]})}),o.jsxs("tbody",{children:[p.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:3,style:{color:"var(--muted)"},children:"No offers."})}),p.map(f=>o.jsxs("tr",{children:[o.jsx("td",{children:f.when}),o.jsxs("td",{children:[o.jsx("div",{style:{fontWeight:600},children:f.customer}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)"},children:f.address})]}),o.jsx("td",{children:f.otherWorker})]},f.id))]})]})]})]})}const aC={fontSize:12,padding:"2px 8px",borderRadius:999,border:"1px solid var(--border)",color:"var(--muted)",background:"transparent",lineHeight:"18px",display:"inline-block",verticalAlign:"middle"};function Xm({label:e}){return o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[o.jsx("h2",{className:"section-title",style:{margin:0},children:e}),o.jsx("span",{style:aC,children:"next 14 days"})]})}function oC({text:e="Workers Calendar"}){return o.jsx("div",{style:{margin:"24px 0 12px"},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("div",{style:{height:1,background:"var(--border)",flex:1}}),o.jsxs("span",{style:{border:"1px solid #33c7e6",color:"#33c7e6",fontWeight:800,fontSize:11,letterSpacing:1,textTransform:"uppercase",padding:"6px 10px",borderRadius:999,background:"rgba(51,199,230,0.12)"},children:[e," starts here"]}),o.jsx("div",{style:{height:1,background:"var(--border)",flex:1}})]})})}const Po=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},lC=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),cC=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},uC=()=>Po("users_seed",[]),dC=()=>Po("availability",[]),hC=e=>lC("availability",e),fC=()=>Po("assignments",[]),pC=()=>Po("sales",[]),mC=()=>Po("seller_calendar",[]),Tc=e=>{const t=new Date(e);return t.setHours(0,0,0,0),t},gC=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+t),r},_a=e=>Tc(e).toISOString().slice(0,10),gl=e=>e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),is=e=>e.toLocaleDateString([],{weekday:"short"}).slice(0,3),xC=(e,t)=>Math.round((Tc(e)-Tc(t))/(24*60*60*1e3)),vC=3,yC=e=>e&&(e.role==="seller"||e.role==="hybrid"),wC=e=>e&&(e.role==="worker"||e.role==="hybrid");function _C(){const e=cC(),t=(e==null?void 0:e.email)||"",[r]=de.useState(()=>{const A=Tc(new Date);return Array.from({length:14},(k,O)=>gC(A,O))}),n=de.useMemo(()=>uC(),[]),i=de.useMemo(()=>n.filter(yC),[n]),s=de.useMemo(()=>n.filter(wC),[n]),a=de.useMemo(()=>mC(),[]),l=de.useMemo(()=>fC(),[]),c=de.useMemo(()=>pC(),[]),u=(A,k,O)=>`${A}|${k}|${O}`,[d,h]=de.useState(()=>{const A=dC(),k=new Map;for(const O of A)O!=null&&O.userEmail&&(O!=null&&O.role)&&(O!=null&&O.day)&&k.set(u(O.userEmail,O.role,O.day),O.hours||"");return k}),p=de.useCallback((A,k,O)=>d.get(u(A,k,O))||"",[d]),m=de.useCallback((A,k,O,U)=>{h(z=>{const V=new Map(z);V.set(u(A,k,O),(U||"").trim());const G=Array.from(V.entries()).map(([ie,le])=>{const[xe,Be,Ne]=ie.split("|");return{userEmail:xe,role:Be,day:Ne,hours:le}});return hC(G),V})},[]),[y,f]=de.useState(()=>{try{return window.matchMedia("(max-width: 720px)").matches}catch{return!1}});de.useEffect(()=>{try{const A=window.matchMedia("(max-width: 720px)"),k=O=>f(O.matches);return A.addEventListener?A.addEventListener("change",k):A.addListener&&A.addListener(k),()=>{A.removeEventListener?A.removeEventListener("change",k):A.removeListener&&A.removeListener(k)}}catch{}},[]);const g=de.useMemo(()=>{const A=new Map;for(const k of i)for(const O of r)A.set(`${k.email}|${_a(O)}`,{locked:[],hoursFromAvail:p(k.email,"seller",is(O))});for(const k of a){if(!(k!=null&&k.sellerEmail)||!k.dateISO)continue;const O=`${k.sellerEmail}|${k.dateISO}`;A.has(O)&&A.get(O).locked.push({time:k.time||"-",address:k.address||"-",notes:k.notes||""})}for(const k of A.values())k.locked.sort((O,U)=>String(O.time||"").localeCompare(String(U.time||"")));return A},[i,r,a,d]),v=(A,k)=>A!==t?!1:((k==null?void 0:k.length)||0)===0,x=de.useMemo(()=>{const A=new Map,k=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];for(const O of l)for(const U of[O.workerEmail,O.worker2Email]){if(!U)continue;const z=(O.when||"").toLowerCase(),V=k.find(xe=>z.includes(xe.toLowerCase()));if(!V)continue;const G=c.find(xe=>String(xe.id)===String(O.saleId)),ie=`${U}|${V}`,le=A.get(ie)||[];le.push({customer:(G==null?void 0:G.name)||O.saleId,address:(G==null?void 0:G.address)||"-",when:O.when||"-"}),A.set(ie,le)}return A},[l,c]),w=(A,k)=>{if(A!==t)return!1;const O=xC(k,new Date);if(O>=0&&O<vC)return!1;const z=is(k);return!((x.get(`${A}|${z}`)||[]).length>0)},E=(A,k,O)=>{if(A!==t)return;const U=is(k);m(A,"worker",U,O)},C=(A,k,O)=>{if(A!==t)return;const U=is(k);m(A,"seller",U,O)};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx(Xm,{label:"Sellers"}),y?o.jsx("div",{children:r.map(A=>{const k=_a(A);return o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{style:{fontWeight:800,fontSize:14,marginBottom:6,textAlign:"left"},children:gl(A)}),o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Seller"}),o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Hours"}),o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Streets"})]})}),o.jsx("tbody",{children:i.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:3,style:{color:"var(--muted)"},children:"No sellers."})}):i.map(O=>{const U=`${O.email}|${k}`,z=g.get(U)||{locked:[],hoursFromAvail:""},V=z.locked||[],G=z.hoursFromAvail||"",ie=v(O.email,V);return o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:O.email===t?700:500,textAlign:"left"},children:O.name}),o.jsx("td",{children:o.jsx("input",{value:G,onChange:le=>ie&&C(O.email,A,le.target.value),placeholder:"hours",readOnly:!ie,disabled:!ie,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:O.email===t?600:400,opacity:ie?1:.75,cursor:ie?"text":"not-allowed",fontSize:13}})}),o.jsx("td",{style:{fontSize:12,textAlign:"left",wordBreak:"break-word"},children:(()=>{const le=(V||[]).map(xe=>xe==null?void 0:xe.address).filter(Boolean);return le.length>0?le.join(", "):""})()})]},O.email)})})]})]},k)})}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{className:"table",style:{minWidth:1200},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:220,position:"sticky",left:0,zIndex:2,background:"var(--card)"},children:"Seller"}),r.map(A=>o.jsx("th",{style:{position:"sticky",top:0,zIndex:1,background:"var(--card)",borderBottom:"1px solid var(--border)"},children:gl(A)},A.toISOString()))]})}),o.jsxs("tbody",{children:[i.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:1+r.length,style:{color:"var(--muted)"},children:"No sellers."})}),i.map(A=>o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:A.email===t?700:500,position:"sticky",left:0,zIndex:1,background:"var(--card)"},children:A.name}),r.map(k=>{const O=_a(k),U=`${A.email}|${O}`,z=g.get(U)||{locked:[],hoursFromAvail:""},V=z.locked||[],G=z.hoursFromAvail||"",ie=v(A.email,V);return o.jsxs("td",{children:[o.jsx("input",{value:G,onChange:le=>ie&&C(A.email,k,le.target.value),placeholder:"hours",readOnly:!ie,disabled:!ie,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:A.email===t?600:400,opacity:ie?1:.75,cursor:ie?"text":"not-allowed"}}),V.length>0&&o.jsx("div",{style:{marginTop:6,fontSize:12,color:"var(--muted)"},children:V.map((le,xe)=>o.jsxs("div",{children:[o.jsxs("div",{children:[" ",le.time||"-",le.address?`  ${le.address}`:""]}),le.notes?o.jsx("div",{style:{marginLeft:14},children:le.notes}):null]},xe))})]},U)})]},A.email))]})]})})]}),o.jsx(oC,{text:"Workers Calendar"}),o.jsxs("div",{className:"card",style:{marginTop:16,border:"1px solid #33c7e6",background:"linear-gradient(180deg, rgba(51,199,230,0.06), rgba(51,199,230,0.02))",boxShadow:"0 0 0 3px rgba(51,199,230,0.08) inset"},children:[o.jsx(Xm,{label:"Workers"}),y?o.jsx("div",{children:r.map(A=>{const k=_a(A);return o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{style:{fontWeight:800,fontSize:14,marginBottom:6,textAlign:"left"},children:gl(A)}),o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Worker"}),o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Hours"}),o.jsx("th",{style:{width:"33.33%",fontSize:12},children:"Scheduled"})]})}),o.jsx("tbody",{children:s.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:3,style:{color:"var(--muted)"},children:"No workers."})}):s.map(O=>{const U=is(A),z=x.get(`${O.email}|${U}`)||[],V=p(O.email,"worker",U),G=w(O.email,A);return o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:O.email===t?700:500,textAlign:"left"},children:O.name}),o.jsx("td",{children:o.jsx("input",{value:V,onChange:ie=>G&&E(O.email,A,ie.target.value),placeholder:"hours",readOnly:!G,disabled:!G,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:O.email===t?600:400,opacity:G?1:.6,cursor:G?"text":"not-allowed",fontSize:13}})}),o.jsxs("td",{style:{fontSize:12,color:"var(--muted)",textAlign:"left"},children:[z.length>0?z.map((ie,le)=>o.jsxs("div",{children:[o.jsx("strong",{children:ie.customer}),o.jsx("div",{style:{color:"var(--muted)"},children:ie.address})]},le)):o.jsx("span",{children:""}),O.email===t&&!G?o.jsx("div",{style:{marginTop:4,fontSize:11},children:""}):null]})]},O.email)})})]})]},k)})}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{className:"table",style:{minWidth:1200},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:220,position:"sticky",left:0,zIndex:2,background:"var(--card)"},children:"Worker"}),r.map(A=>o.jsx("th",{style:{position:"sticky",top:0,zIndex:1,background:"var(--card)",borderBottom:"1px solid var(--border)"},children:gl(A)},A.toISOString()))]})}),o.jsxs("tbody",{children:[s.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:1+r.length,style:{color:"var(--muted)"},children:"No workers."})}),s.map(A=>o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:A.email===t?700:500,position:"sticky",left:0,zIndex:1,background:"var(--card)"},children:A.name}),r.map(k=>{const O=is(k),U=x.get(`${A.email}|${O}`)||[],z=p(A.email,"worker",O),V=w(A.email,k);return o.jsxs("td",{children:[o.jsx("input",{value:z,onChange:G=>V&&E(A.email,k,G.target.value),placeholder:"hours",readOnly:!V,disabled:!V,style:{width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:A.email===t?600:400,opacity:V?1:.6,cursor:V?"text":"not-allowed"}}),U.length>0&&o.jsx("div",{style:{marginTop:6,fontSize:12,color:"var(--muted)"},children:U.map((G,ie)=>o.jsxs("div",{children:[o.jsx("strong",{children:G.customer}),o.jsx("div",{style:{color:"var(--muted)"},children:G.address})]},ie))}),A.email===t&&!V&&o.jsx("div",{style:{marginTop:6,fontSize:11,color:"var(--muted)"},children:""})]},A.email+_a(k))})]},A.email))]})]})})]})]})}const Py=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},SC=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},EC=()=>Py("sales",[]),TC=()=>Py("assignments",[]),Fn=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-";function Ym(e){if(!e)return"-";const t=typeof e=="number"?new Date(e):new Date(e);return isNaN(t.getTime())?String(e):t.toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}function Ry(){const e=localStorage.getItem("hybrid_next_payday");if(e)return e;const t="2025-11-01";return localStorage.setItem("hybrid_next_payday",t),t}function kC(e){const t=new Date(`${e}T00:00:00`);return isNaN(t.getTime())?e:t.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric",year:"numeric"})}function jC(){const e=Ry(),t=new Date(`${e}T00:00:00`);t.setDate(t.getDate()+14);const r=t.toISOString().slice(0,10);localStorage.setItem("hybrid_next_payday",r),localStorage.setItem("hybrid_payroll_clear_ts",String(Date.now()))}typeof window<"u"&&!window.__adminMarkPayrollPaid&&(window.__adminMarkPayrollPaid=()=>{jC(),alert("Payroll marked paid. Tables cleared and next payday advanced by 14 days."),location.reload()});function AC(e){if(!e)return 0;const t=String(e).toLowerCase();let r=t.match(/(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)\s*[-]\s*(\d{1,2}(?::\d{2})?\s*(?:am|pm)?)/i)||t.match(/(\d{1,2}:\d{2})\s*-\s*(\d{1,2}:\d{2})/)||t.match(/(?:mon|tue|wed|thu|fri|sat|sun)?\s*(\d{1,2})\s*-\s*(\d{1,2})/i);if(!r)return 0;const n=(c,u=null)=>{let d=c.trim(),h=/am/.test(d),p=/pm/.test(d);d=d.replace(/\s*(am|pm)/g,"").trim();let[m,y="0"]=d.split(":"),f=parseInt(m,10),g=parseInt(y,10)||0,v=!1;return h?v=!1:p?v=!0:u!=null&&(v=u),v&&f<12&&(f+=12),!v&&/am/.test(c)&&f===12&&(f=0),f*60+g},[i,s]=[r[1],r[2]];let a=n(i),l=n(s);return!/(am|pm)/.test(i+s)&&l<=a&&(l=n(s,!0)),Math.max(0,(l-a)/60)}function CC(e,t){let r=0;for(const n of e)n&&(n.workerEmail===t||n.worker2Email===t)&&n.status==="finished"&&(r+=AC(n.when||""));return r}function NC(){const e=SC(),t=(e==null?void 0:e.email)||"",r=de.useMemo(()=>EC(),[]),n=de.useMemo(()=>TC(),[]),i=+(localStorage.getItem("hybrid_payroll_clear_ts")||0),s=Ry(),a=kC(s),l=de.useMemo(()=>{const f=n.filter(v=>(v.workerEmail===t||v.worker2Email===t)&&v.status==="finished"),g=new Set(f.map(v=>v.saleId));return r.filter(v=>g.has(v.id)).filter(v=>((v==null?void 0:v.createdAt)||0)>i).map(v=>{const x=isFinite(+v.price)?+v.price:null;return{id:v.id,dateLabel:v.soldAt?Ym(v.soldAt):v.createdAt?Ym(v.createdAt):"-",customer:v.name||"-",address:v.address||"-",sale:x??null,your30:x==null?null:x*.3,notes:v.notes||"-"}}).sort((v,x)=>String(x.dateLabel||"").localeCompare(String(v.dateLabel||"")))},[r,n,t,i]),c=de.useMemo(()=>l.reduce((f,g)=>f+(g.your30??0),0),[l]),u=de.useMemo(()=>{const f=new Map(r.map(g=>[String(g.id),g]));return n.filter(g=>(g.workerEmail===t||g.worker2Email===t)&&g.status==="finished").filter(g=>(typeof g.id=="number"?g.id:0)>i).map(g=>{const v=f.get(String(g.saleId)),x=isFinite(+(v==null?void 0:v.price))?+v.price:null,w=x==null?null:x*.2;return{id:g.id,dateTime:g.when||"-",customer:(v==null?void 0:v.name)||g.saleId,address:(v==null?void 0:v.address)||"-",your20:w,notes:(v==null?void 0:v.notes)||"-"}})},[n,t,i,r]),d=de.useMemo(()=>u.reduce((f,g)=>f+(g.your20??0),0),[u]),h=c+d,p=de.useMemo(()=>CC(n,t),[n,t]),m={fontSize:11,fontWeight:800,letterSpacing:.2,textTransform:"uppercase"},y={fontSize:13,lineHeight:1.25};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",style:{paddingTop:16},children:[o.jsx("h2",{className:"section-title",style:{margin:"0 0 8px 0",lineHeight:1.1,textAlign:"center"},children:"Paycheck"}),o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:6,marginTop:-100},children:[o.jsxs("div",{className:"card",style:{padding:"6px 8px",textAlign:"center"},children:[o.jsx("div",{className:"muted",style:{fontSize:10,textTransform:"uppercase",letterSpacing:.3},children:"Total Paycheck"}),o.jsx("div",{style:{fontSize:15,fontWeight:900,marginTop:4},children:Fn(h)}),o.jsxs("div",{style:{fontSize:11.5,color:"var(--muted)"},children:["= ",o.jsx("strong",{children:"30% (Seller)"})," + ",o.jsx("strong",{children:"20% (Worker)"})]})]}),o.jsxs("div",{className:"card",style:{padding:"6px 8px",textAlign:"center"},children:[o.jsx("div",{className:"muted",style:{fontSize:10,textTransform:"uppercase",letterSpacing:.3},children:"Next Payday"}),o.jsx("div",{style:{fontSize:18,fontWeight:800,marginTop:4},children:a})]}),o.jsxs("div",{className:"card",style:{padding:"6px 8px",textAlign:"center"},children:[o.jsx("div",{className:"muted",style:{fontSize:10,textTransform:"uppercase",letterSpacing:.3},children:"Hours (Worker)"}),o.jsx("div",{style:{fontSize:15,fontWeight:800,marginTop:4},children:isFinite(p)?`${p.toFixed(1)} hrs`:"-"})]}),o.jsxs("div",{className:"card",style:{padding:"6px 8px",textAlign:"center"},children:[o.jsx("div",{className:"muted",style:{fontSize:8,textTransform:"uppercase",letterSpacing:.3},children:"Breakdown"}),o.jsxs("div",{style:{fontSize:11,marginTop:4,lineHeight:1.35},children:[o.jsxs("div",{children:["Seller 30%: ",o.jsx("strong",{children:Fn(c)})]}),o.jsxs("div",{children:["Worker 20%: ",o.jsx("strong",{children:Fn(d)})]})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:12,padding:"10px 12px"},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:6,textAlign:"center"},children:"Payments (Seller)"}),l.length===0?o.jsx("p",{className:"muted",style:{margin:0,textAlign:"center"},children:"No seller payments right now."}):o.jsxs("div",{className:"grid",style:{gap:8},children:[l.map(f=>o.jsx("div",{className:"card",style:{padding:"8px 10px"},children:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6},children:[o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Date Sold"}),o.jsx("div",{style:y,children:f.dateLabel})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Customer"}),o.jsx("div",{style:y,children:f.customer})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Address"}),o.jsx("div",{style:y,children:f.address})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Sale"}),o.jsx("div",{style:y,children:f.sale==null?"-":Fn(f.sale)})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Your 30%"}),o.jsx("div",{style:{...y,fontWeight:800},children:f.your30==null?"-":Fn(f.your30)})]}),o.jsxs("div",{style:{gridColumn:"1 / -1"},children:[o.jsx("div",{className:"muted",style:m,children:"Notes"}),o.jsx("div",{style:{...y,whiteSpace:"pre-wrap"},children:f.notes})]})]})},f.id)),o.jsx("div",{className:"card",style:{padding:"8px 10px",textAlign:"right"},children:o.jsxs("strong",{children:["Subtotal (Seller): ",Fn(c)]})})]})]}),o.jsxs("div",{className:"card",style:{marginTop:12,padding:"10px 12px"},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:6,textAlign:"center"},children:"Payments (Worker)"}),u.length===0?o.jsx("p",{className:"muted",style:{margin:0,textAlign:"center"},children:"No worker payments right now."}):o.jsxs("div",{className:"grid",style:{gap:8},children:[u.map(f=>o.jsx("div",{className:"card",style:{padding:"8px 10px"},children:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6},children:[o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Date & Time"}),o.jsx("div",{style:y,children:f.dateTime})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Customer"}),o.jsx("div",{style:y,children:f.customer})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Address"}),o.jsx("div",{style:y,children:f.address})]}),o.jsxs("div",{children:[o.jsx("div",{className:"muted",style:m,children:"Your 20%"}),o.jsx("div",{style:{...y,fontWeight:800},children:f.your20==null?"-":Fn(f.your20)})]}),o.jsxs("div",{style:{gridColumn:"1 / -1"},children:[o.jsx("div",{className:"muted",style:m,children:"Notes"}),o.jsx("div",{style:{...y,whiteSpace:"pre-wrap"},children:f.notes})]})]})},f.id)),o.jsx("div",{className:"card",style:{padding:"8px 10px",textAlign:"right"},children:o.jsxs("strong",{children:["Subtotal (Worker): ",Fn(d)]})})]})]})]})}const ou=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},s0=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),Ln=()=>ou("sales",[]),ss=e=>s0("sales",e),as=()=>ou("assignments",[]),xl=e=>s0("assignments",e),bC=()=>ou("users_seed",[]),os=()=>ou("neighborhoodAssignments",[]),vl=e=>s0("neighborhoodAssignments",e),qm=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-",ls=e=>{if(e==null||e==="")return"-";const t=Pe(e);return t?t.toLocaleDateString([],{month:"short",day:"numeric"}):"-"},et=()=>{const e=new Date;e.setHours(0,0,0,0);const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},nr=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))return"";const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},Rr=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))return"";const t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${t}:${r}`};function Pe(e){if(e==null||e==="")return null;if(typeof e=="number"){const p=e<1e12?e*1e3:e,m=new Date(p);return isNaN(m.getTime())?null:m}const t=String(e).trim(),r=t.match(/^(\d{4})-(\d{2})-(\d{2})(?:[T\s](\d{2}):(\d{2}))?$/);if(r){const p=+r[1],m=+r[2],y=+r[3],f=+(r[4]??0),g=+(r[5]??0),v=new Date(p,m-1,y,f,g,0,0);return isNaN(v.getTime())?null:v}const n=t.match(/^(\d{4})-(\d{2})-(\d{2})[T\s](\d{2}):(\d{2})(?::(\d{2}))?(?:\.\d+)?(?:Z|[+-]\d{2}:?\d{2})?$/i);if(n){const p=+n[1],m=+n[2],y=+n[3],f=+n[4],g=+n[5],v=+(n[6]??0),x=new Date(p,m-1,y,f,g,v,0);return isNaN(x.getTime())?null:x}const i=["jan","feb","mar","apr","may","jun","jul","aug","sep","sept","oct","nov","dec"],s=new RegExp(`\\b(${i.join("|")})[a-z]*\\b`,"i"),a=/\b([0-2]?\d|3[01])\b/,l=/(\d{1,2})(?::(\d{2}))?\s*([ap]m)?/i,c=t.match(s),u=t.match(a),d=t.match(l);if(c&&u){const p=c[1].toLowerCase(),m=["jan","feb","mar","apr","may","jun","jul","aug","sep","sept","oct","nov","dec"].indexOf(p),y=+u[1];let f=new Date().getFullYear(),g=0,v=0;if(d){g=+d[1],v=+(d[2]??0);const w=(d[3]||"").toLowerCase(),E=!w&&g>=1&&g<=8;w==="pm"||E?g<12&&(g+=12):w==="am"&&g===12&&(g=0)}let x=new Date(f,m,y,g,v,0,0);if(!isNaN(x.getTime())){const w=new Date,E=1e3*60*60*24*30*10;return x.getTime()+E<w.getTime()&&(x=new Date(f+1,m,y,g,v,0,0)),x}}const h=new Date(t);return isNaN(h.getTime())?null:new Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds())}function yl(e){if(!e)return et();const t=Pe(e);return t?nr(t):et()}const Se={padding:"8px 10px",textAlign:"center",verticalAlign:"middle"},we={width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:600,textAlign:"center"};function OC(){const[e,t]=X.useState(Ln()),[r,n]=X.useState(as()),[i,s]=X.useState(os());function a(){t(Ln()),n(as()),s(os())}const l=X.useMemo(()=>bC(),[]),c=X.useMemo(()=>l.filter(_=>_.role==="seller"||_.role==="hybrid"||_.role==="admin"),[l]),u=X.useMemo(()=>l.filter(_=>_.role==="worker"||_.role==="hybrid"||_.role==="admin"),[l]);X.useEffect(()=>{const _=()=>a();return window.addEventListener("db-refresh",_),a(),()=>window.removeEventListener("db-refresh",_)},[]),X.useEffect(()=>{let _=!1;const T=as().map(Y=>{if(typeof Y.when=="string"&&Y.when){const re=Pe(Y.when);if(re)return _=!0,{...Y,when:re.getTime()}}return Y});_&&xl(T);const S=os().map(Y=>{if(typeof Y.day=="string"&&Y.day){const re=Pe(Y.day);if(re)return _=!0,{...Y,day:re.getTime()}}return Y});_&&vl(S);const W=Ln().map(Y=>{if(typeof Y.createdAt=="string"&&Y.createdAt){const re=Pe(Y.createdAt);if(re)return _=!0,{...Y,createdAt:new Date(re.getFullYear(),re.getMonth(),re.getDate(),0,0,0,0).getTime()}}return Y});_&&ss(W),_&&a()},[]);const[d,h]=X.useState(()=>{try{return window.matchMedia("(max-width: 720px)").matches}catch{return!1}});X.useEffect(()=>{try{const _=window.matchMedia("(max-width: 720px)"),b=T=>h(T.matches);return _.addEventListener?_.addEventListener("change",b):_.addListener&&_.addListener(b),()=>{_.removeEventListener?_.removeEventListener("change",b):_.removeListener&&_.removeListener(b)}}catch{}},[]);const p=X.useMemo(()=>[...e].sort((_,b)=>((b==null?void 0:b.createdAt)||0)-((_==null?void 0:_.createdAt)||0)).slice(0,20),[e]),m=X.useMemo(()=>{const _=Date.now();return r.filter(b=>b.status==="assigned").map(b=>{var S,R;const T=e.find(W=>String(W.id)===String(b.saleId)),B=Pe(b.when||"");return{...b,_sale:T,_whenDate:B,_worker1Name:((S=l.find(W=>W.email===b.workerEmail))==null?void 0:S.name)||b.workerEmail||"-",_worker2Name:((R=l.find(W=>W.email===b.worker2Email))==null?void 0:R.name)||b.worker2Email||"-",salesmanName:(T==null?void 0:T.sellerName)||(T==null?void 0:T.sellerEmail)||"-",salesmanEmail:(T==null?void 0:T.sellerEmail)||""}}).filter(b=>!b._whenDate||b._whenDate.getTime()>=_).sort((b,T)=>{const B=b._whenDate?b._whenDate.getTime():1/0,S=T._whenDate?T._whenDate.getTime():1/0;return B-S}).slice(0,30)},[r,e,l]),y=X.useMemo(()=>{const _=Date.now();return(i||[]).map(b=>({...b,_whenDate:Pe(b.day||b.dateISO||"")})).filter(b=>!b._whenDate||b._whenDate.getTime()>=_).sort((b,T)=>{const B=b._whenDate?b._whenDate.getTime():1/0,S=T._whenDate?T._whenDate.getTime():1/0;return B-S}).slice(0,50)},[i]),[f,g]=X.useState(!1),[v,x]=X.useState(!1),[w,E]=X.useState(!1);function C(_,b,T){const B=Ln().map(S=>{if(String(S.id)!==String(_))return S;if(b==="createdAt"){const R=Pe(T),W=R?new Date(R.getFullYear(),R.getMonth(),R.getDate(),0,0,0,0).getTime():S.createdAt;return{...S,createdAt:W}}return b==="status"?{...S,status:T}:{...S,[b]:T}});ss(B),t(B)}function A(_,b,T){const B=as().map(S=>{if(S.id!==_)return S;if(b==="when"){const R=Pe(T),W=R?R.getTime():S.when;return{...S,when:W}}return["workerEmail","worker2Email","status","salesmanEmail"].includes(b)?{...S,[b]:T}:S});xl(B),n(B)}function k(_){if(!window.confirm("Delete this assignment?"))return;const b=as().filter(T=>T.id!==_);xl(b),n(b)}function O(_,b,T){const B=os().map(S=>{if(S.id!==_)return S;if(b==="sellerEmail"){const R=l.find(W=>W.email===T);return{...S,sellerEmail:T,sellerName:(R==null?void 0:R.name)||T}}if(b==="neighborhood")return{...S,neighborhood:T};if(b==="day"){const R=Pe(T),W=R?R.getTime():S.day;return{...S,day:W}}return b==="notes"?{...S,notes:T}:S});vl(B),s(B)}function U(_){if(!window.confirm("Delete this neighborhood?"))return;const b=os().filter(T=>T.id!==_);vl(b),s(b)}const[z,V]=X.useState({name:"",sellerEmail:"",phone:"",address:"",price:"",notes:"",status:"unassigned",createdAt:""}),[G,ie]=X.useState({when:"",salesmanEmail:"",customer:"",address:"",workerEmail:"",worker2Email:""}),[le,xe]=X.useState({day:"",sellerEmail:"",neighborhood:"",notes:""});function Be(){if(!z.name&&!z.address)return;const _=l.find(S=>S.email===z.sellerEmail);let b;if(z.createdAt){const S=Pe(z.createdAt);b=S?new Date(S.getFullYear(),S.getMonth(),S.getDate(),0,0,0,0).getTime():Date.now()}else{const S=Pe(`${et()} 00:00`);b=S?S.getTime():Date.now()}const B=[{...z,id:String(Date.now())+Math.random().toString(36).slice(2,6),sellerName:(_==null?void 0:_.name)||"",createdAt:b,status:z.status||"unassigned"},...Ln()];ss(B),t(B),V({name:"",sellerEmail:"",phone:"",address:"",price:"",notes:"",status:"unassigned",createdAt:""})}function Ne(_){if(!window.confirm("Delete this sale?"))return;const b=Ln().filter(T=>String(T.id)!==String(_));ss(b),t(b)}function F(){var W,Y,re;if(!G.customer&&!G.address)return;const _=e.find(te=>G.customer&&te.name===G.customer||G.address&&te.address===G.address),b=G.salesmanEmail||(_==null?void 0:_.sellerEmail)||"",T=((W=l.find(te=>te.email===b))==null?void 0:W.name)||"";let B="";if(G.when){const te=Pe(G.when);B=te?te.getTime():""}const R=[{id:String(Date.now())+Math.random().toString(36).slice(2,6),when:B,saleId:(_==null?void 0:_.id)||"",status:"assigned",workerEmail:G.workerEmail,worker2Email:G.worker2Email,salesmanEmail:b,salesmanName:T,_sale:_,_worker1Name:((Y=l.find(te=>te.email===G.workerEmail))==null?void 0:Y.name)||G.workerEmail||"-",_worker2Name:((re=l.find(te=>te.email===G.worker2Email))==null?void 0:re.name)||G.worker2Email||"-"},...as()];xl(R),n(R),ie({when:"",salesmanEmail:"",customer:"",address:"",workerEmail:"",worker2Email:""})}function ae(){if(!le.neighborhood)return;const _=l.find(S=>S.email===le.sellerEmail);let b="";if(le.day){const S=Pe(le.day);b=S?S.getTime():""}const B=[{id:String(Date.now())+Math.random().toString(36).slice(2,6),day:b,sellerEmail:le.sellerEmail,sellerName:(_==null?void 0:_.name)||"",neighborhood:le.neighborhood,notes:le.notes},...os()];vl(B),s(B),xe({day:"",sellerEmail:"",neighborhood:"",notes:""})}return o.jsxs("div",{className:"grid",style:{paddingTop:"calc(var(--topbar, 60px) + 40px)"},children:[o.jsxs("div",{className:"card",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Recent Sales"}),o.jsx("button",{className:"btn outline",onClick:()=>g(_=>!_),children:f?"Done":"Edit"})]}),d?o.jsxs("div",{children:[p.length===0&&o.jsx("div",{style:{color:"var(--muted)",padding:"8px 0"},children:"No sales."}),p.map(_=>o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:_.name||"Customer"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),f?o.jsxs("select",{style:we,value:_.sellerEmail||"",onChange:b=>{const T=l.find(S=>S.email===b.target.value),B=Ln().map(S=>String(S.id)!==String(_.id)?S:{...S,sellerEmail:b.target.value,sellerName:(T==null?void 0:T.name)||b.target.value});ss(B),t(B)},children:[o.jsx("option",{value:"",children:""}),c.map(b=>o.jsx("option",{value:b.email,children:b.name||b.email},b.email))]}):o.jsx("div",{children:_.sellerName||_.sellerEmail||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Phone"}),f?o.jsx("input",{style:we,value:_.phone||"",onChange:b=>C(_.id,"phone",b.target.value)}):o.jsx("div",{children:_.phone||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Address"}),f?o.jsx("input",{style:we,value:_.address||"",onChange:b=>C(_.id,"address",b.target.value)}):o.jsx("div",{children:_.address||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Price"}),f?o.jsx("input",{style:we,value:_.price??"",onChange:b=>C(_.id,"price",b.target.value)}):o.jsx("div",{children:_.price?qm(_.price):"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Notes"}),f?o.jsx("input",{style:we,value:_.notes||"",onChange:b=>C(_.id,"notes",b.target.value)}):o.jsx("div",{children:_.notes||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Status"}),f?o.jsxs("select",{style:we,value:_.status||"unassigned",onChange:b=>C(_.id,"status",b.target.value),children:[o.jsx("option",{value:"unassigned",children:"Unassigned"}),o.jsx("option",{value:"assigned",children:"Assigned"}),o.jsx("option",{value:"worked",children:"Worked"}),o.jsx("option",{value:"contacted",children:"Contacted"})]}):o.jsx("div",{children:_.status||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),f?o.jsx("input",{type:"date",style:we,value:_.createdAt?nr(Pe(_.createdAt)):et(),onChange:b=>{const T=b.target.value;if(!T)return;const B=Pe(`${T} 00:00`);C(_.id,"createdAt",B?B.getTime():void 0)}}):o.jsx("div",{children:ls(_.createdAt)}),f&&o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>Ne(_.id),children:"delete"})})]},_.id)),f&&o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:"Add Sale"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Customer"}),o.jsx("input",{style:we,value:z.name,onChange:_=>V(b=>({...b,name:_.target.value})),placeholder:"Customer"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),o.jsxs("select",{style:we,value:z.sellerEmail,onChange:_=>V(b=>({...b,sellerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Phone"}),o.jsx("input",{style:we,value:z.phone,onChange:_=>V(b=>({...b,phone:_.target.value})),placeholder:"Phone"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Address"}),o.jsx("input",{style:we,value:z.address,onChange:_=>V(b=>({...b,address:_.target.value})),placeholder:"Address"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Price"}),o.jsx("input",{style:we,value:z.price,onChange:_=>V(b=>({...b,price:_.target.value})),placeholder:"Price"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Notes"}),o.jsx("input",{style:we,value:z.notes,onChange:_=>V(b=>({...b,notes:_.target.value})),placeholder:"Notes"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Status"}),o.jsxs("select",{style:we,value:z.status||"unassigned",onChange:_=>V(b=>({...b,status:_.target.value})),children:[o.jsx("option",{value:"unassigned",children:"Unassigned"}),o.jsx("option",{value:"assigned",children:"Assigned"}),o.jsx("option",{value:"worked",children:"Worked"}),o.jsx("option",{value:"contacted",children:"Contacted"})]}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),o.jsx("input",{type:"date",style:we,value:z.createdAt?yl(z.createdAt):et(),onChange:_=>V(b=>({...b,createdAt:yl(_.target.value)}))}),o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:Be,children:"Add Row"})})]})]}):o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Se,children:"Customer"}),o.jsx("th",{style:Se,children:"Salesman"}),o.jsx("th",{style:Se,children:"Phone"}),o.jsx("th",{style:Se,children:"Address"}),o.jsx("th",{style:Se,children:"Price"}),o.jsx("th",{style:Se,children:"Notes"}),o.jsx("th",{style:Se,children:"Status"}),o.jsx("th",{style:Se,children:"Date"}),f&&o.jsx("th",{style:Se})]})}),o.jsxs("tbody",{children:[p.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:f?9:8,style:{...Se,color:"var(--muted)"},children:"No sales."})}),p.map(_=>o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:f?o.jsx("input",{style:we,value:_.name||"",onChange:b=>C(_.id,"name",b.target.value)}):_.name||"-"}),o.jsx("td",{style:Se,children:f?o.jsxs("select",{style:we,value:_.sellerEmail||"",onChange:b=>{const T=l.find(S=>S.email===b.target.value),B=Ln().map(S=>String(S.id)!==String(_.id)?S:{...S,sellerEmail:b.target.value,sellerName:(T==null?void 0:T.name)||b.target.value});ss(B),t(B)},children:[o.jsx("option",{value:"",children:""}),c.map(b=>o.jsx("option",{value:b.email,children:b.name||b.email},b.email))]}):`${_.sellerName||"-"}${_.sellerEmail?` (${_.sellerEmail})`:""}`}),o.jsx("td",{style:Se,children:f?o.jsx("input",{style:we,value:_.phone||"",onChange:b=>C(_.id,"phone",b.target.value)}):_.phone||"-"}),o.jsx("td",{style:Se,children:f?o.jsx("input",{style:we,value:_.address||"",onChange:b=>C(_.id,"address",b.target.value)}):_.address||"-"}),o.jsx("td",{style:Se,children:f?o.jsx("input",{style:we,value:_.price??"",onChange:b=>C(_.id,"price",b.target.value)}):_.price?qm(_.price):"-"}),o.jsx("td",{style:Se,children:f?o.jsx("input",{style:we,value:_.notes||"",onChange:b=>C(_.id,"notes",b.target.value)}):_.notes||"-"}),o.jsx("td",{style:Se,children:f?o.jsxs("select",{style:we,value:_.status||"unassigned",onChange:b=>C(_.id,"status",b.target.value),children:[o.jsx("option",{value:"unassigned",children:"Unassigned"}),o.jsx("option",{value:"assigned",children:"Assigned"}),o.jsx("option",{value:"worked",children:"Worked"}),o.jsx("option",{value:"contacted",children:"Contacted"})]}):_.status||"-"}),o.jsx("td",{style:Se,children:f?o.jsx("input",{type:"date",style:we,value:_.createdAt?nr(Pe(_.createdAt)):et(),onChange:b=>{const T=b.target.value;if(!T)return;const B=Pe(`${T} 00:00`);C(_.id,"createdAt",B?B.getTime():void 0)}}):ls(_.createdAt)}),f&&o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>Ne(_.id),children:"delete"})})]},_.id)),f&&o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:z.name,onChange:_=>V(b=>({...b,name:_.target.value})),placeholder:"Customer"})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:z.sellerEmail,onChange:_=>V(b=>({...b,sellerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:z.phone,onChange:_=>V(b=>({...b,phone:_.target.value})),placeholder:"Phone"})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:z.address,onChange:_=>V(b=>({...b,address:_.target.value})),placeholder:"Address"})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:z.price,onChange:_=>V(b=>({...b,price:_.target.value})),placeholder:"Price"})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:z.notes,onChange:_=>V(b=>({...b,notes:_.target.value})),placeholder:"Notes"})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:z.status||"unassigned",onChange:_=>V(b=>({...b,status:_.target.value})),children:[o.jsx("option",{value:"unassigned",children:"Unassigned"}),o.jsx("option",{value:"assigned",children:"Assigned"}),o.jsx("option",{value:"worked",children:"Worked"}),o.jsx("option",{value:"contacted",children:"Contacted"})]})}),o.jsx("td",{style:Se,children:o.jsx("input",{type:"date",style:we,value:z.createdAt?yl(z.createdAt):et(),onChange:_=>V(b=>({...b,createdAt:yl(_.target.value)}))})}),o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:Be,children:"Add Row"})})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:16},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Upcoming Assignments"}),o.jsx("button",{className:"btn outline",onClick:()=>x(_=>!_),children:v?"Done":"Edit"})]}),d?o.jsxs("div",{children:[m.length===0&&o.jsx("div",{style:{color:"var(--muted)",padding:"8px 0"},children:"No upcoming assignments."}),m.map(_=>{var B,S,R,W;let b="",T="";if(_.when){const Y=Pe(_.when);Y&&!isNaN(Y.getTime())&&(b=nr(Y),T=Rr(Y))}return o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:((B=_._sale)==null?void 0:B.name)||_.saleId||"Assignment"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),v?o.jsx("input",{type:"date",style:we,value:b||et(),onChange:Y=>{const te=`${Y.target.value}T${T||"00:00"}`;A(_.id,"when",te)}}):o.jsx("div",{children:_.when?ls(_.when):"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Time"}),v?o.jsx("input",{type:"time",style:we,value:T,onChange:Y=>{const re=Y.target.value,te=`${b||et()}T${re}`;A(_.id,"when",te)}}):o.jsx("div",{children:_.when&&T?(S=Pe(_.when))==null?void 0:S.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),v?o.jsxs("select",{style:we,value:_.salesmanEmail||"",onChange:Y=>A(_.id,"salesmanEmail",Y.target.value),children:[o.jsx("option",{value:"",children:""}),c.map(Y=>o.jsx("option",{value:Y.email,children:Y.name||Y.email},Y.email))]}):o.jsx("div",{children:_.salesmanName||_.salesmanEmail||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Customer"}),o.jsx("div",{children:((R=_._sale)==null?void 0:R.name)||_.saleId||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Address"}),o.jsx("div",{children:((W=_._sale)==null?void 0:W.address)||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Worker 1"}),v?o.jsxs("select",{style:we,value:_.workerEmail||"",onChange:Y=>A(_.id,"workerEmail",Y.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(Y=>o.jsx("option",{value:Y.email,children:Y.name||Y.email},Y.email))]}):o.jsx("div",{children:_._worker1Name}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Worker 2"}),v?o.jsxs("select",{style:we,value:_.worker2Email||"",onChange:Y=>A(_.id,"worker2Email",Y.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(Y=>o.jsx("option",{value:Y.email,children:Y.name||Y.email},Y.email))]}):o.jsx("div",{children:_._worker2Name}),v&&o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>k(_.id),children:"delete"})})]},_.id)}),v&&o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:"Add Assignment"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),o.jsx("input",{type:"date",style:we,value:G.when?(()=>{const _=Pe(G.when);return _?nr(_):et()})():et(),onChange:_=>{const b=_.target.value;let T="";if(G.when){const S=Pe(G.when);S&&!isNaN(S.getTime())&&(T=Rr(S))}const B=`${b}T${T||"00:00"}`;ie(S=>({...S,when:B}))}}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Time"}),o.jsx("input",{type:"time",style:we,value:G.when?(()=>{const _=Pe(G.when);return _?Rr(_):""})():"",onChange:_=>{const b=_.target.value;let T="";if(G.when){const S=Pe(G.when);S&&!isNaN(S.getTime())&&(T=nr(S))}T||(T=et());const B=`${T}T${b}`;ie(S=>({...S,when:B}))}}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),o.jsxs("select",{style:we,value:G.salesmanEmail,onChange:_=>ie(b=>({...b,salesmanEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Customer"}),o.jsx("input",{style:we,value:G.customer,onChange:_=>ie(b=>({...b,customer:_.target.value})),placeholder:"Customer"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Address"}),o.jsx("input",{style:we,value:G.address,onChange:_=>ie(b=>({...b,address:_.target.value})),placeholder:"Address"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Worker 1"}),o.jsxs("select",{style:we,value:G.workerEmail,onChange:_=>ie(b=>({...b,workerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),u.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Worker 2"}),o.jsxs("select",{style:we,value:G.worker2Email,onChange:_=>ie(b=>({...b,worker2Email:_.target.value})),children:[o.jsx("option",{value:"",children:""}),u.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]}),o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:F,children:"Add Row"})})]})]}):o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Se,children:"Date"}),o.jsx("th",{style:Se,children:"Time"}),o.jsx("th",{style:Se,children:"Salesman"}),o.jsx("th",{style:Se,children:"Customer"}),o.jsx("th",{style:Se,children:"Address"}),o.jsx("th",{style:Se,children:"Worker 1"}),o.jsx("th",{style:Se,children:"Worker 2"}),v&&o.jsx("th",{style:Se})]})}),o.jsxs("tbody",{children:[m.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:v?8:7,style:{...Se,color:"var(--muted)"},children:"No upcoming assignments."})}),m.map(_=>{var B,S,R,W,Y;let b="",T="";if(_.when){const re=Pe(_.when);re&&!isNaN(re.getTime())&&(b=nr(re),T=Rr(re))}return o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:v?o.jsx("input",{type:"date",style:we,value:b||et(),onChange:re=>{const he=`${re.target.value}T${T||"00:00"}`;A(_.id,"when",he)}}):_.when?ls(_.when):"-"}),o.jsx("td",{style:Se,children:v?o.jsx("input",{type:"time",style:we,value:T,onChange:re=>{const te=re.target.value,he=`${b||et()}T${te}`;A(_.id,"when",he)}}):_.when&&T?(B=Pe(_.when))==null?void 0:B.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"-"}),o.jsx("td",{style:Se,children:v?o.jsxs("select",{style:we,value:_.salesmanEmail||"",onChange:re=>A(_.id,"salesmanEmail",re.target.value),children:[o.jsx("option",{value:"",children:""}),c.map(re=>o.jsx("option",{value:re.email,children:re.name||re.email},re.email))]}):_.salesmanName||_.salesmanEmail||"-"}),o.jsx("td",{style:Se,children:v?o.jsx("input",{style:we,value:((S=_._sale)==null?void 0:S.name)||"",disabled:!0}):((R=_._sale)==null?void 0:R.name)||_.saleId}),o.jsx("td",{style:Se,children:v?o.jsx("input",{style:we,value:((W=_._sale)==null?void 0:W.address)||"",disabled:!0}):((Y=_._sale)==null?void 0:Y.address)||"-"}),o.jsx("td",{style:Se,children:v?o.jsxs("select",{style:we,value:_.workerEmail||"",onChange:re=>A(_.id,"workerEmail",re.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(re=>o.jsx("option",{value:re.email,children:re.name||re.email},re.email))]}):_._worker1Name}),o.jsx("td",{style:Se,children:v?o.jsxs("select",{style:we,value:_.worker2Email||"",onChange:re=>A(_.id,"worker2Email",re.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(re=>o.jsx("option",{value:re.email,children:re.name||re.email},re.email))]}):_._worker2Name}),v&&o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>k(_.id),children:"delete"})})]},_.id)}),v&&o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:o.jsx("input",{type:"date",style:we,value:G.when?(()=>{const _=Pe(G.when);return _?nr(_):et()})():et(),onChange:_=>{const b=_.target.value;let T="";if(G.when){const S=Pe(G.when);S&&!isNaN(S.getTime())&&(T=Rr(S))}const B=`${b}T${T||"00:00"}`;ie(S=>({...S,when:B}))}})}),o.jsx("td",{style:Se,children:o.jsx("input",{type:"time",style:we,value:G.when?(()=>{const _=Pe(G.when);return _?Rr(_):""})():"",onChange:_=>{const b=_.target.value;let T="";if(G.when){const S=Pe(G.when);S&&!isNaN(S.getTime())&&(T=nr(S))}T||(T=et());const B=`${T}T${b}`;ie(S=>({...S,when:B}))}})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:G.salesmanEmail,onChange:_=>ie(b=>({...b,salesmanEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:G.customer,onChange:_=>ie(b=>({...b,customer:_.target.value})),placeholder:"Customer"})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:G.address,onChange:_=>ie(b=>({...b,address:_.target.value})),placeholder:"Address"})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:G.workerEmail,onChange:_=>ie(b=>({...b,workerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),u.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:G.worker2Email,onChange:_=>ie(b=>({...b,worker2Email:_.target.value})),children:[o.jsx("option",{value:"",children:""}),u.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]})}),o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:F,children:"Add Row"})})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:16},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Upcoming Neighborhoods"}),o.jsx("button",{className:"btn outline",onClick:()=>E(_=>!_),children:w?"Done":"Edit"})]}),d?o.jsxs("div",{children:[y.length===0&&o.jsx("div",{style:{color:"var(--muted)",padding:"8px 0"},children:"No upcoming neighborhoods."}),y.map(_=>{var B;let b="",T="";if(_.day||_.dateISO){const S=Pe(_.day||_.dateISO);S&&!isNaN(S.getTime())&&(b=nr(S),T=Rr(S))}return o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:_.neighborhood||"Neighborhood"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),w?o.jsx("input",{type:"date",style:we,value:b||et(),onChange:S=>{const W=`${S.target.value}T${T||"00:00"}`;O(_.id,"day",W)}}):o.jsx("div",{children:_.day||_.dateISO?ls(_.day||_.dateISO):"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Time"}),w?o.jsx("input",{type:"time",style:we,value:T,onChange:S=>{const R=S.target.value,W=`${b||et()}T${R}`;O(_.id,"day",W)}}):o.jsx("div",{children:(_.day||_.dateISO)&&T?(B=Pe(_.day||_.dateISO))==null?void 0:B.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),w?o.jsxs("select",{style:we,value:_.sellerEmail||"",onChange:S=>O(_.id,"sellerEmail",S.target.value),children:[o.jsx("option",{value:"",children:""}),c.map(S=>o.jsx("option",{value:S.email,children:S.name||S.email},S.email))]}):o.jsx("div",{children:_.sellerName||_.sellerEmail||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Street(s)"}),w?o.jsx("input",{style:we,value:_.neighborhood||"",onChange:S=>O(_.id,"neighborhood",S.target.value),placeholder:"Street(s)"}):o.jsx("div",{children:_.neighborhood||"-"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Notes"}),w?o.jsx("input",{style:we,value:_.notes||"",onChange:S=>O(_.id,"notes",S.target.value),placeholder:"Meet at HOA lot; gate 1234"}):o.jsx("div",{children:_.notes||"-"}),w&&o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>U(_.id),children:"delete"})})]},_.id)}),w&&o.jsxs("div",{className:"card",style:{marginBottom:12},children:[o.jsx("div",{className:"section-title",style:{marginBottom:8},children:"Add Neighborhood"}),o.jsx("div",{className:"muted",style:{fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Date"}),o.jsx("input",{type:"date",style:we,value:le.day?(()=>{const _=Pe(le.day);return _?nr(_):et()})():et(),onChange:_=>{let b="";if(le.day){const S=Pe(le.day);S&&!isNaN(S.getTime())&&(b=Rr(S))}const B=`${_.target.value}T${b||"00:00"}`;xe(S=>({...S,day:B}))}}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Time"}),o.jsx("input",{type:"time",style:we,value:le.day?(()=>{const _=Pe(le.day);return _?Rr(_):""})():"",onChange:_=>{let b="";if(le.day){const S=Pe(le.day);S&&!isNaN(S.getTime())&&(b=nr(S))}b||(b=et());const T=_.target.value,B=`${b}T${T}`;xe(S=>({...S,day:B}))}}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Salesman"}),o.jsxs("select",{style:we,value:le.sellerEmail,onChange:_=>xe(b=>({...b,sellerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Street(s)"}),o.jsx("input",{style:we,value:le.neighborhood,onChange:_=>xe(b=>({...b,neighborhood:_.target.value})),placeholder:"Street(s)"}),o.jsx("div",{className:"muted",style:{marginTop:10,fontSize:12,textTransform:"uppercase",fontWeight:700},children:"Notes"}),o.jsx("input",{style:we,value:le.notes,onChange:_=>xe(b=>({...b,notes:_.target.value})),placeholder:"Notes"}),o.jsx("div",{style:{marginTop:10},children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:ae,children:"Add Row"})})]})]}):o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Se,children:"Date"}),o.jsx("th",{style:Se,children:"Time"}),o.jsx("th",{style:Se,children:"Salesman"}),o.jsx("th",{style:Se,children:"Street(s)"}),o.jsx("th",{style:Se,children:"Notes"}),w&&o.jsx("th",{style:Se})]})}),o.jsxs("tbody",{children:[y.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:w?6:5,style:{...Se,color:"var(--muted)"},children:"No upcoming neighborhoods."})}),y.map(_=>{var B;let b="",T="";if(_.day||_.dateISO){const S=Pe(_.day||_.dateISO);S&&!isNaN(S.getTime())&&(b=nr(S),T=Rr(S))}return o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:w?o.jsx("input",{type:"date",style:we,value:b||et(),onChange:S=>{const W=`${S.target.value}T${T||"00:00"}`;O(_.id,"day",W)}}):_.day||_.dateISO?ls(_.day||_.dateISO):"-"}),o.jsx("td",{style:Se,children:w?o.jsx("input",{type:"time",style:we,value:T,onChange:S=>{const R=S.target.value,W=`${b||et()}T${R}`;O(_.id,"day",W)}}):(_.day||_.dateISO)&&T?(B=Pe(_.day||_.dateISO))==null?void 0:B.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"-"}),o.jsx("td",{style:Se,children:w?o.jsxs("select",{style:we,value:_.sellerEmail||"",onChange:S=>O(_.id,"sellerEmail",S.target.value),children:[o.jsx("option",{value:"",children:""}),c.map(S=>o.jsx("option",{value:S.email,children:S.name||S.email},S.email))]}):_.sellerName||_.sellerEmail||"-"}),o.jsx("td",{style:Se,children:w?o.jsx("input",{style:we,value:_.neighborhood||"",onChange:S=>O(_.id,"neighborhood",S.target.value),placeholder:"Street(s)"}):_.neighborhood||"-"}),o.jsx("td",{style:Se,children:w?o.jsx("input",{style:we,value:_.notes||"",onChange:S=>O(_.id,"notes",S.target.value),placeholder:"Meet at HOA lot; gate 1234"}):_.notes||"-"}),w&&o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>U(_.id),children:"delete"})})]},_.id)}),w&&o.jsxs("tr",{children:[o.jsx("td",{style:Se,children:o.jsx("input",{type:"date",style:we,value:le.day?(()=>{const _=Pe(le.day);return _?nr(_):et()})():et(),onChange:_=>{let b="";if(le.day){const S=Pe(le.day);S&&!isNaN(S.getTime())&&(b=Rr(S))}const B=`${_.target.value}T${b||"00:00"}`;xe(S=>({...S,day:B}))}})}),o.jsx("td",{style:Se,children:o.jsx("input",{type:"time",style:we,value:le.day?(()=>{const _=Pe(le.day);return _?Rr(_):""})():"",onChange:_=>{let b="";if(le.day){const S=Pe(le.day);S&&!isNaN(S.getTime())&&(b=nr(S))}b||(b=et());const T=_.target.value,B=`${b}T${T}`;xe(S=>({...S,day:B}))}})}),o.jsx("td",{style:Se,children:o.jsxs("select",{style:we,value:le.sellerEmail,onChange:_=>xe(b=>({...b,sellerEmail:_.target.value})),children:[o.jsx("option",{value:"",children:""}),c.map(_=>o.jsx("option",{value:_.email,children:_.name||_.email},_.email))]})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:le.neighborhood,onChange:_=>xe(b=>({...b,neighborhood:_.target.value})),placeholder:"Street(s)"})}),o.jsx("td",{style:Se,children:o.jsx("input",{style:we,value:le.notes,onChange:_=>xe(b=>({...b,notes:_.target.value})),placeholder:"Notes"})}),o.jsx("td",{style:Se,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:ae,children:"Add Row"})})]})]})]})]})]})}function St(){try{return JSON.parse(localStorage.getItem("sales")||"[]")}catch{return[]}}function Mn(e){localStorage.setItem("sales",JSON.stringify(e))}function $h(){try{return JSON.parse(localStorage.getItem("availability")||"[]")}catch{return[]}}function Yt(){try{return JSON.parse(localStorage.getItem("users_seed")||"[]")}catch{return[]}}function at(){try{return JSON.parse(localStorage.getItem("assignments")||"[]")}catch{return[]}}function gn(e){localStorage.setItem("assignments",JSON.stringify(e))}function wr(){try{return JSON.parse(localStorage.getItem("neighborhoodAssignments")||"[]")}catch{return[]}}function Bn(e){localStorage.setItem("neighborhoodAssignments",JSON.stringify(e))}function wl(){try{return JSON.parse(localStorage.getItem("jobFinishes")||"[]")}catch{return[]}}const IC=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],PC=e=>{if(!e)return"-";const t=typeof e=="number"?new Date(e):new Date(String(e));return isNaN(t.getTime())?"-":t.toLocaleDateString([],{month:"short",day:"numeric"})};function ld(e){if(!e)return null;let t=new Date(e);if(!Number.isNaN(t.getTime()))return t;const r=/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec)[a-z]*/i,n=/\b([0-2]?\d|3[01])\b/,i=/(\d{1,2}(?::\d{2})?)(?:\s*([ap]m))?/i,s=e.match(r),a=e.match(n),l=e.match(i);if(s&&a){const c=s[0],u=a[1],d=new Date().getFullYear();let h="00:00",p=null;if(l){const m=l[1];p=l[2]||null;const[y,f="00"]=m.includes(":")?m.split(":"):[m,"00"],g=parseInt(y,10),v=!p&&g>=1&&g<=8;h=`${y}:${f}`,t=new Date(`${c} ${u}, ${d} ${h} ${v?"PM":p?p.toUpperCase():""}`.trim())}else t=new Date(`${c} ${u}, ${d} 00:00`);if(!Number.isNaN(t.getTime())){const m=new Date,y=1e3*60*60*24*30*10;if(t.getTime()+y<m.getTime()&&(t=new Date(`${c} ${u}, ${d+1} ${h} ${p?p.toUpperCase():""}`.trim())),!Number.isNaN(t.getTime()))return t}}return null}function Ia(){const e=[],t=new Date;for(let r=0;r<7;r++){const n=new Date(t);n.setDate(t.getDate()+r);const i=n.toLocaleDateString([],{weekday:"short"}).slice(0,3),s=`${i} ${n.toLocaleDateString([],{month:"short",day:"numeric"})}`;e.push({key:i,label:s})}return e}function Wh(e,t){var s;const n=$h().filter(a=>a.userEmail===e&&a.role===t),i={};for(const a of IC)i[a]=((s=n.find(l=>l.day===a))==null?void 0:s.hours)||"";return i}function _l(e,t){try{if(!("Notification"in window)){alert(t);return}Notification.permission==="granted"?new Notification(e,{body:t}):Notification.permission!=="denied"?Notification.requestPermission().then(r=>{r==="granted"?new Notification(e,{body:t}):alert(t)}):alert(t)}catch{alert(t)}}function Sl(e,t){const r=Wh(e,t),n=Ia();for(const i of n){const s=(r[i.key]||"").trim();if(s&&s.toLowerCase()!=="off")return`${i.label}, ${s}`}return null}const cs={padding:"6px 8px",textAlign:"center",verticalAlign:"middle",fontSize:"11px"},Re={width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:600,textAlign:"center"},$e={fontSize:11,color:"var(--muted)"};({...$e});const RC=(e="gray")=>({display:"inline-block",padding:"2px 8px",borderRadius:999,fontSize:12,fontWeight:700,background:e==="green"?"var(--ok-bg)":e==="amber"?"var(--warn-bg)":"var(--muted-bg)",color:e==="green"?"var(--ok-fg)":e==="amber"?"var(--warn-fg)":"var(--muted)"});function DC(){const[e,t]=X.useState(St()),[r,n]=X.useState(at()),[i,s]=X.useState((wr()||[]).filter(N=>typeof N.day=="string"||typeof N.day>"u")),[a,l]=X.useState(wl()),c=Yt(),u=c.map(N=>({...N,role:typeof N.role=="string"?N.role.toLowerCase():N.role})),[d,h]=X.useState(!1),[p,m]=X.useState(!1),[y,f]=X.useState(!1),[g,v]=X.useState({name:"",sellerEmail:"",phone:"",address:"",price:"",notes:""}),[x,w]=X.useState({name:"",email:""}),E=X.useMemo(()=>u.filter(N=>N.role==="worker"||N.role==="hybrid"||N.role==="admin"),[u]),C=X.useMemo(()=>u.filter(N=>N.role==="seller"||N.role==="hybrid"||N.role==="admin"),[u]);X.useEffect(()=>{t(St()),n(at()),s(wr()),l(wl())},[]),X.useEffect(()=>{function N(H){H.key==="jobFinishes"&&l(wl())}window.addEventListener("storage",N);const K=setInterval(()=>l(wl()),15e3);return()=>{window.removeEventListener("storage",N),clearInterval(K)}},[]);const A=X.useMemo(()=>e.filter(N=>N.status==="unassigned"||!N.status),[e]),[k,O]=X.useState({saleId:"",worker1:"",worker2:"",when:""}),U=()=>{if(!k.saleId||!k.worker1||!k.worker2){alert("Pick a customer and two workers.");return}const N=St(),K=N.findIndex(ue=>String(ue.id)===String(k.saleId));if(K===-1){alert("Customer not found.");return}const H=c.find(ue=>ue.email===k.worker1),J=c.find(ue=>ue.email===k.worker2);N[K]={...N[K],status:"assigned",assignedTo:`${(H==null?void 0:H.name)||k.worker1} & ${(J==null?void 0:J.name)||k.worker2}`,when:k.when||""},Mn(N),t(N);const ne=[...at(),{id:Date.now(),saleId:k.saleId,workerEmail:k.worker1,worker2Email:k.worker2,when:k.when||"",status:"assigned",createdAt:Date.now()}];gn(ne),n(ne),O({saleId:"",worker1:"",worker2:"",when:""}),alert("Assigned.")},z=()=>{if(!k.saleId||!k.worker1||!k.worker2){alert("Pick a customer and two workers.");return}const N=St(),K=N.findIndex(J=>String(J.id)===String(k.saleId));if(K===-1){alert("Customer not found.");return}N[K]={...N[K],status:"offered",assignedTo:void 0,when:k.when||""},Mn(N),t(N);const H=[...at(),{id:Date.now(),saleId:k.saleId,workerEmail:k.worker1,worker2Email:k.worker2,when:k.when||"",status:"offered",offeredTo:[k.worker1,k.worker2],createdAt:Date.now()}];gn(H),n(H),O({saleId:"",worker1:"",worker2:"",when:""}),alert("Offered to selected workers.")},V=X.useMemo(()=>C.map(N=>{const K=e.filter(J=>J.sellerEmail===N.email),H=K.map(J=>J.name).filter(Boolean);return{...N,weekHours:Wh(N.email,"seller"),soldCount:K.length,soldNames:H}}),[C,e]),G=X.useMemo(()=>E.map(N=>{const K=new Date,H=r.filter(ue=>{const _e=ld(ue.when);return(ue.workerEmail===N.email||ue.worker2Email===N.email)&&(!_e||_e>=K)}),J=H.map(ue=>{const _e=e.find(De=>String(De.id)===String(ue.saleId));return(_e==null?void 0:_e.name)||"(customer)"}).filter(Boolean),ne=H.map(ue=>ue.when).filter(Boolean);return{...N,isScheduled:H.some(ue=>ue.status==="assigned")?"Yes":"No",customers:J,whens:ne,weekHours:Wh(N.email,"worker")}}),[E,r,e]);new Date().toLocaleDateString([],{weekday:"long",month:"short",day:"numeric",year:"numeric"});const[ie,le]=X.useState(""),[xe,Be]=X.useState(""),[Ne,F]=X.useState(""),[ae,_]=X.useState("");function b(){if(!ie||!xe){alert("need seller + neighborhood name");return}const N=c.find(J=>J.email===ie),K={id:crypto.randomUUID?crypto.randomUUID():String(Date.now()),sellerEmail:ie,sellerName:(N==null?void 0:N.name)||ie,neighborhood:xe,day:Ne,notes:ae,assignedAt:Date.now()},H=[...wr(),K];Bn(H),s(H),le(""),Be(""),F(""),_("")}const T=X.useMemo(()=>{const N=r.filter(H=>H.status==="assigned").map(H=>{const J=e.find(ue=>String(ue.id)===String(H.saleId)),ne=H.when||"-";return{kind:"JOB",id:H.id,saleId:J==null?void 0:J.id,when:ne,whenDate:ld(ne),salesmanEmail:(J==null?void 0:J.sellerEmail)||"",salesmanName:(J==null?void 0:J.sellerName)||(J==null?void 0:J.sellerEmail)||"-",street:(J==null?void 0:J.address)||"",notes:(J==null?void 0:J.notes)||"",customerName:(J==null?void 0:J.name)||"",price:(J==null?void 0:J.price)??null,paidFlag:(J==null?void 0:J.paid)??void 0}}),K=(i||[]).map(H=>{const J=H.day||"-";return{kind:"ROUTE",id:H.id,when:J,whenDate:ld(J),salesmanEmail:H.sellerEmail||"",salesmanName:H.sellerName||H.sellerEmail||"-",street:H.neighborhood||"",notes:H.notes||""}});return[...N,...K]},[r,e,i]),B=Date.now(),S=X.useMemo(()=>T.filter(N=>N.whenDate?N.whenDate.getTime()>=B:!0).sort((N,K)=>{const H=N.whenDate?N.whenDate.getTime():1/0,J=K.whenDate?K.whenDate.getTime():1/0;return H-J}),[T,B]),R=X.useMemo(()=>T.filter(N=>N.whenDate&&N.whenDate.getTime()<B).sort((N,K)=>K.whenDate.getTime()-N.whenDate.getTime()),[T,B]),[W,Y]=X.useState(!1),[re,te]=X.useState(!1);function he(N,K,H){if(N.kind==="JOB"){if(K==="when"){const J=at().map(ne=>ne.id===N.id?{...ne,when:H}:ne);gn(J),n(J)}else if(K==="salesman"){const J=St().map(ne=>{if(String(ne.id)!==String(N.saleId))return ne;const ue=c.find(_e=>_e.email===H);return{...ne,sellerEmail:H,sellerName:(ue==null?void 0:ue.name)||H}});Mn(J),t(J)}else if(K==="street"){const J=St().map(ne=>String(ne.id)===String(N.saleId)?{...ne,address:H}:ne);Mn(J),t(J)}else if(K==="notes"){const J=St().map(ne=>String(ne.id)===String(N.saleId)?{...ne,notes:H}:ne);Mn(J),t(J)}}else if(K==="when"){const J=wr().map(ne=>ne.id===N.id?{...ne,day:H}:ne);Bn(J),s(J)}else if(K==="salesman"){const J=wr().map(ne=>{if(ne.id!==N.id)return ne;const ue=c.find(_e=>_e.email===H);return{...ne,sellerEmail:H,sellerName:(ue==null?void 0:ue.name)||H}});Bn(J),s(J)}else if(K==="street"){const J=wr().map(ne=>ne.id===N.id?{...ne,neighborhood:H}:ne);Bn(J),s(J)}else if(K==="notes"){const J=wr().map(ne=>ne.id===N.id?{...ne,notes:H}:ne);Bn(J),s(J)}}function He(N){if(N.kind==="JOB"){const K=at().filter(H=>H.id!==N.id);gn(K),n(K)}else{const K=wr().filter(H=>H.id!==N.id);Bn(K),s(K)}}X.useEffect(()=>{const N=setInterval(()=>n(K=>K),45e3);return()=>clearInterval(N)},[]);function Le(N){const K=new Date(N);return K.setHours(0,0,0,0),K.getTime()}function vt(N){const K=new Date(N);return K.setHours(23,59,59,999),K.getTime()}function We(N){if(N.kind==="JOB"){const K=N.customerName||"(customer)";return{count:K?1:0,names:K?[K]:[]}}if(N.kind==="ROUTE"&&N.whenDate){const K=Le(N.whenDate),H=vt(N.whenDate),ne=St().filter(ue=>ue.sellerEmail===N.salesmanEmail&&ue.createdAt&&Number(new Date(ue.createdAt).getTime())>=K&&Number(new Date(ue.createdAt).getTime())<=H).map(ue=>ue.name).filter(Boolean);return{count:ne.length,names:ne}}return{count:0,names:[]}}return o.jsxs("div",{className:"grid",style:{marginTop:-52},children:[o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsxs("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Unassigned Customers"}),o.jsx("button",{className:"btn outline",onClick:()=>{h(N=>!N),d&&t(St())},children:d?"Done":"Edit"})]}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" UNASSIGNED CUSTOMERS START "}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,marginBottom:24},children:[A.length===0&&o.jsx("div",{style:{color:"#64748b",fontSize:13,flex:"1 1 100%"},children:"No unassigned customers."}),A.map(N=>o.jsxs("div",{className:"card",style:{minWidth:260,maxWidth:340,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px solid #e5e7eb",borderRadius:10,boxShadow:"0 1px 8px #e5e7eb"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:16,marginBottom:2},children:N.name}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Salesman:"})," ",N.sellerName]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Phone:"})," ",N.phone||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Address:"})," ",N.address||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Price:"})," ",N.price?`$${N.price}`:"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Notes:"})," ",N.notes||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Date:"})," ",PC(N.createdAt)]}),d&&o.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px",lineHeight:1,color:"var(--accent)"},onClick:()=>{if(window.confirm("Are you sure?")){const K=St().filter(H=>String(H.id)!==String(N.id));Mn(K),t(K)}},children:"Delete"}),o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px",lineHeight:1,color:"var(--danger)"},onClick:()=>{if(window.confirm("Permanently delete this customer row? This cannot be undone.")){const K=St().filter(H=>String(H.id)!==String(N.id));Mn(K),t(K)}},children:"Delete Row"})]})]},N.id)),d&&o.jsxs("div",{className:"card",style:{minWidth:260,maxWidth:340,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px dashed #cbd5e1",borderRadius:10,background:"#fafafa",boxShadow:"0 1px 8px #e5e7eb"},children:[o.jsx("input",{value:g.name,onChange:N=>v({...g,name:N.target.value}),style:Re,placeholder:"Name"}),o.jsxs("select",{value:g.sellerEmail,onChange:N=>v({...g,sellerEmail:N.target.value}),style:Re,children:[o.jsx("option",{value:"",children:"Salesman"}),u.filter(N=>N.role==="seller"||N.role==="hybrid"||N.role==="admin").map(N=>o.jsx("option",{value:N.email,children:N.name||N.email},N.email))]}),o.jsx("input",{value:g.phone,onChange:N=>v({...g,phone:N.target.value}),style:Re,placeholder:"Phone"}),o.jsx("input",{value:g.address,onChange:N=>v({...g,address:N.target.value}),style:Re,placeholder:"Address"}),o.jsx("input",{type:"number",value:g.price,onChange:N=>v({...g,price:N.target.value}),style:Re,placeholder:"Price"}),o.jsx("input",{value:g.notes,onChange:N=>v({...g,notes:N.target.value}),style:Re,placeholder:"Notes"}),o.jsx("button",{className:"btn outline",style:{marginTop:8},onClick:()=>{if(!g.name||!g.sellerEmail){alert("Name and Salesman required");return}const N=c.find(J=>J.email===g.sellerEmail),K={id:crypto.randomUUID?crypto.randomUUID():String(Date.now()),name:g.name,sellerEmail:g.sellerEmail,sellerName:(N==null?void 0:N.name)||g.sellerEmail,phone:g.phone,address:g.address,price:g.price,notes:g.notes,status:"unassigned",createdAt:Date.now()},H=[...St(),K];Mn(H),t(H),v({name:"",sellerEmail:"",phone:"",address:"",price:"",notes:""})},children:"Add Customer"})]})]}),o.jsx("div",{style:{margin:"0 0 24px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}}),o.jsxs("div",{className:"grid",style:{marginTop:-30,marginBottom:0},children:[o.jsxs("div",{className:"row",style:{display:"flex",flexWrap:"wrap",gap:16},children:[o.jsxs("div",{style:{flex:2,minWidth:220},children:[o.jsx("label",{children:"Select Customer"}),o.jsxs("select",{value:k.saleId,onChange:N=>O({...k,saleId:N.target.value}),style:Re,children:[o.jsx("option",{value:"",children:""}),A.map(N=>o.jsxs("option",{value:N.id,children:[N.name,"  ",N.address]},N.id))]})]}),o.jsxs("div",{style:{flex:2,minWidth:220},children:[o.jsx("label",{children:"Worker 1"}),o.jsxs("select",{value:k.worker1,onChange:N=>O({...k,worker1:N.target.value}),style:Re,children:[o.jsx("option",{value:"",children:""}),u.filter(N=>N.role==="worker"||N.role==="hybrid"||N.role==="admin").map(N=>o.jsx("option",{value:N.email,children:N.name||N.email},N.email))]})]}),o.jsxs("div",{style:{flex:2,minWidth:220},children:[o.jsx("label",{children:"Worker 2"}),o.jsxs("select",{value:k.worker2,onChange:N=>O({...k,worker2:N.target.value}),style:Re,children:[o.jsx("option",{value:"",children:""}),u.filter(N=>N.role==="worker"||N.role==="hybrid"||N.role==="admin").map(N=>o.jsx("option",{value:N.email,children:N.name||N.email},N.email))]})]}),o.jsxs("div",{style:{flex:2,minWidth:220},children:[o.jsx("label",{children:"Date & Time"}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("input",{type:"date",value:k.when&&k.when.includes("T")?k.when.split("T")[0]:"",onChange:N=>{const K=N.target.value,H=k.when&&k.when.includes("T")?k.when.split("T")[1]:"";O({...k,when:K&&H?`${K}T${H}`:K})},style:Re,placeholder:"Date"}),o.jsx("input",{type:"time",value:k.when&&k.when.includes("T")?k.when.split("T")[1]:"",onChange:N=>{const K=N.target.value,H=k.when&&k.when.includes("T")?k.when.split("T")[0]:k.when;O({...k,when:H&&K?`${H}T${K}`:H})},style:Re,placeholder:"Time"})]})]})]}),o.jsxs("div",{className:"toolbar",style:{display:"flex",gap:8,justifyContent:"center",marginTop:12},children:[o.jsx("button",{className:"btn",onClick:U,children:"Assign"}),o.jsx("button",{className:"btn outline",onClick:z,children:"Offer to Workers"})]})]})]}),o.jsx("div",{style:{margin:"32px 0 0 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}}),o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsxs("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Salesman Snapshot"}),o.jsx("button",{className:"btn outline",onClick:()=>{m(N=>!N),p&&(t(St()),n(at()),s(wr()))},children:p?"Done":"Edit"})]}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" SALESMAN SNAPSHOT START "}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,marginBottom:24},children:[V.length===0&&o.jsx("div",{style:{color:"#64748b",fontSize:13,flex:"1 1 100%"},children:"No salesmen."}),V.map(N=>o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px solid #e5e7eb",borderRadius:10,boxShadow:"0 1px 8px #e5e7eb",paddingBottom:10},children:p?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",value:(()=>{const K=Yt(),H=K.findIndex(J=>J.email===N.email);return H>=0&&typeof K[H].name=="string"?K[H].name:N.name||""})(),style:Re,placeholder:"Salesman Name",onChange:K=>{const H=K.target.value,J=Yt(),ne=J.findIndex(ue=>ue.email===N.email);if(ne>=0){let ue={...J[ne]};ue.name=H,J[ne]=ue,localStorage.setItem("users_seed",JSON.stringify(J)),t(St()),n(at())}}}),o.jsx("input",{type:"text",value:(()=>{var J;const K=Yt(),H=K.findIndex(ne=>ne.email===N.email);return H>=0&&K[H].salesmanSnapshot&&typeof K[H].salesmanSnapshot.soldNames=="string"?K[H].salesmanSnapshot.soldNames:((J=N.soldNames)==null?void 0:J.join(", "))||""})(),style:Re,placeholder:"Names, comma-separated",onChange:K=>{const H=K.target.value,J=Yt(),ne=J.findIndex(ue=>ue.email===N.email);if(ne>=0){let ue={...J[ne]};ue.salesmanSnapshot={...ue.salesmanSnapshot||{},soldNames:H},J[ne]=ue,localStorage.setItem("users_seed",JSON.stringify(J)),t(St()),n(at())}}}),o.jsx("input",{type:"number",value:(()=>{const K=Yt(),H=K.findIndex(J=>J.email===N.email);return H>=0&&K[H].salesmanSnapshot&&typeof K[H].salesmanSnapshot.soldCount<"u"?K[H].salesmanSnapshot.soldCount:N.soldCount||0})(),min:0,style:{...Re,marginTop:4},onChange:K=>{const H=parseInt(K.target.value,10),J=Yt(),ne=J.findIndex(ue=>ue.email===N.email);if(ne>=0){let ue={...J[ne]};ue.salesmanSnapshot={...ue.salesmanSnapshot||{},soldCount:H},J[ne]=ue,localStorage.setItem("users_seed",JSON.stringify(J)),t(St()),n(at())}},placeholder:"Sold count"}),o.jsx("div",{style:{marginTop:8,fontWeight:600,marginBottom:2},children:"Weekly Hours"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:Ia().map(K=>o.jsxs("div",{style:{flex:"1 1 80px"},children:[o.jsx("div",{style:$e,children:K.label}),o.jsx("input",{value:N.weekHours[K.key]||"",onChange:H=>{const J=$h(),ne=J.findIndex(_e=>_e.userEmail===N.email&&_e.role==="seller"&&_e.day===K.key);let ue;ne>=0?(ue=[...J],ue[ne]={...ue[ne],hours:H.target.value}):ue=[...J,{userEmail:N.email,role:"seller",day:K.key,hours:H.target.value}],localStorage.setItem("availability",JSON.stringify(ue)),t(St()),n(at())},style:Re,placeholder:"Hours"})]},K.label))}),o.jsx("button",{className:"btn outline",style:{marginTop:8},onClick:()=>{const K=Sl(N.email,"seller");_l("Next Shift",K?`${N.name}  ${K}`:`${N.name}: no upcoming hours found.`)},children:"Remind"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:N.name}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Customers sold:"})," ",(()=>{var ue;const K=Yt(),H=K.findIndex(_e=>_e.email===N.email);let J=null;H>=0&&K[H].salesmanSnapshot&&typeof K[H].salesmanSnapshot.soldNames=="string"&&(J=K[H].salesmanSnapshot.soldNames);const ne=J||((ue=N.soldNames)==null?void 0:ue.join(", "))||"";return o.jsxs(o.Fragment,{children:[o.jsx("span",{style:{fontWeight:700},children:H>=0&&K[H].salesmanSnapshot&&typeof K[H].salesmanSnapshot.soldCount<"u"?K[H].salesmanSnapshot.soldCount:N.soldCount||0}),ne&&o.jsx("div",{style:$e,children:ne})]})})()]}),o.jsx("div",{style:{marginTop:8,fontWeight:600,marginBottom:2},children:"Weekly Hours"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:Ia().map(K=>o.jsxs("div",{style:{flex:"1 1 80px"},children:[o.jsx("div",{style:$e,children:K.label}),o.jsx("div",{style:{fontSize:13,fontFamily:"monospace"},children:N.weekHours[K.key]||"-"})]},K.label))}),o.jsx("button",{className:"btn outline",style:{marginTop:8},onClick:()=>{const K=Sl(N.email,"seller");_l("Next Shift",K?`${N.name}  ${K}`:`${N.name}: no upcoming hours found.`)},children:"Remind"})]})},N.email))]}),o.jsx("div",{style:{margin:"0 0 24px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}})]}),o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsxs("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Worker Snapshot"}),o.jsx("button",{className:"btn outline",onClick:()=>{f(N=>!N),y&&(n(at()),t(St()))},children:y?"Done":"Edit"})]}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" WORKER SNAPSHOT START "}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,marginBottom:24},children:[G.length===0&&o.jsx("div",{style:{color:"#64748b",fontSize:13,flex:"1 1 100%"},children:"No workers."}),G.map(N=>{var K,H,J;return o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px solid #e5e7eb",borderRadius:10,boxShadow:"0 1px 8px #e5e7eb",paddingBottom:10},children:y?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",value:(()=>{const ne=Yt(),ue=ne.findIndex(_e=>_e.email===N.email);return ue>=0&&typeof ne[ue].name=="string"?ne[ue].name:N.name||""})(),style:Re,placeholder:"Worker Name",onChange:ne=>{const ue=ne.target.value,_e=Yt(),De=_e.findIndex(Me=>Me.email===N.email);if(De>=0){let Me={..._e[De]};Me.name=ue,_e[De]=Me,localStorage.setItem("users_seed",JSON.stringify(_e)),gn(at()),n(at())}}}),o.jsx("input",{type:"text",value:(()=>{var _e;const ne=Yt(),ue=ne.findIndex(De=>De.email===N.email);return ue>=0&&typeof ne[ue].workerSnapshot=="object"&&typeof ne[ue].workerSnapshot.isScheduled=="string"?ne[ue].workerSnapshot.isScheduled:N.isScheduled||(((_e=N.customers)==null?void 0:_e.length)>0?"Yes":"No")})(),style:Re,placeholder:"Scheduled?",onChange:ne=>{const ue=ne.target.value,_e=Yt(),De=_e.findIndex(Me=>Me.email===N.email);if(De>=0){let Me={..._e[De]};Me.workerSnapshot={...Me.workerSnapshot||{},isScheduled:ue},_e[De]=Me,localStorage.setItem("users_seed",JSON.stringify(_e)),gn(at()),n(at())}}}),o.jsx("input",{type:"text",value:(()=>{var _e;const ne=Yt(),ue=ne.findIndex(De=>De.email===N.email);return ue>=0&&ne[ue].workerSnapshot&&typeof ne[ue].workerSnapshot.customers=="string"?ne[ue].workerSnapshot.customers:((_e=N.customers)==null?void 0:_e.join(", "))||""})(),style:Re,placeholder:"Customers",onChange:ne=>{const ue=ne.target.value,_e=Yt(),De=_e.findIndex(Me=>Me.email===N.email);if(De>=0){let Me={..._e[De]};Me.workerSnapshot={...Me.workerSnapshot||{},customers:ue},_e[De]=Me,localStorage.setItem("users_seed",JSON.stringify(_e)),gn(at()),n(at())}}}),o.jsx("input",{type:"text",value:(()=>{var _e;const ne=Yt(),ue=ne.findIndex(De=>De.email===N.email);return ue>=0&&ne[ue].workerSnapshot&&typeof ne[ue].workerSnapshot.whens=="string"?ne[ue].workerSnapshot.whens:((_e=N.whens)==null?void 0:_e.join("  "))||""})(),style:Re,placeholder:"When(s)",onChange:ne=>{const ue=ne.target.value,_e=Yt(),De=_e.findIndex(Me=>Me.email===N.email);if(De>=0){let Me={..._e[De]};Me.workerSnapshot={...Me.workerSnapshot||{},whens:ue},_e[De]=Me,localStorage.setItem("users_seed",JSON.stringify(_e)),gn(at()),n(at())}}}),o.jsx("div",{style:{marginTop:8,fontWeight:600,marginBottom:2},children:"Weekly Hours"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:Ia().map(ne=>o.jsxs("div",{style:{flex:"1 1 80px"},children:[o.jsx("div",{style:$e,children:ne.label}),o.jsx("input",{value:N.weekHours[ne.key]||"",onChange:ue=>{const _e=$h(),De=_e.findIndex(Ze=>Ze.userEmail===N.email&&Ze.role==="worker"&&Ze.day===ne.key);let Me;De>=0?(Me=[..._e],Me[De]={...Me[De],hours:ue.target.value}):Me=[..._e,{userEmail:N.email,role:"worker",day:ne.key,hours:ue.target.value}],localStorage.setItem("availability",JSON.stringify(Me)),gn(at()),n(at())},style:Re,placeholder:"Hours"})]},ne.label))}),o.jsx("button",{className:"btn outline",style:{marginTop:8},onClick:()=>{const ne=Sl(N.email,"worker");_l("Next Shift",ne?`${N.name}  ${ne}`:`${N.name}: no upcoming hours found.`)},children:"Remind"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:N.name}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Scheduled:"})," ",o.jsx("span",{style:RC(((K=N.customers)==null?void 0:K.length)>0?"green":"amber"),children:((H=N.customers)==null?void 0:H.length)>0?"Yes":"No"})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Customers:"})," ",((J=N.customers)==null?void 0:J.length)>0?N.customers.join(", "):"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"When(s):"})," ",(()=>{var ue;return((ue=N.whens)==null?void 0:ue.length)>0?N.whens.map(_e=>{const De=new Date(_e);return isNaN(De)?_e:De.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}).join("  "):"-"})()]}),o.jsx("div",{style:{marginTop:8,fontWeight:600,marginBottom:2},children:"Weekly Hours"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:Ia().map(ne=>o.jsxs("div",{style:{flex:"1 1 80px"},children:[o.jsx("div",{style:$e,children:ne.label}),o.jsx("div",{style:{fontSize:13,fontFamily:"monospace"},children:N.weekHours[ne.key]||"-"})]},ne.label))}),o.jsx("button",{className:"btn outline",style:{marginTop:8},onClick:()=>{const ne=Sl(N.email,"worker");_l("Next Shift",ne?`${N.name}  ${ne}`:`${N.name}: no upcoming hours found.`)},children:"Remind"})]})},N.email)})]}),o.jsx("div",{style:{margin:"0 0 24px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}})]}),o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsx("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",alignItems:"center"},children:o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Assign Neighborhood"})}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" ASSIGN NEIGHBORHOOD START "}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(200px,1fr))",gap:12},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Seller"}),o.jsxs("select",{style:Re,value:ie,onChange:N=>le(N.target.value),children:[o.jsx("option",{value:"",children:"Choose seller"}),u.filter(N=>N.role==="seller"||N.role==="hybrid"||N.role==="admin").map(N=>o.jsx("option",{value:N.email,children:N.name},N.email))]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Neighborhood / Route Name"}),o.jsx("input",{style:Re,placeholder:"River Oaks / Spring Trails...",value:xe,onChange:N=>Be(N.target.value)})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Day / Time Window"}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("input",{type:"date",style:Re,placeholder:"Date",value:Ne&&Ne.includes("T")?Ne.split("T")[0]:"",onChange:N=>{const K=N.target.value,H=Ne&&Ne.includes("T")?Ne.split("T")[1]:"";F(K&&H?`${K}T${H}`:K)}}),o.jsx("input",{type:"time",style:Re,placeholder:"Time",value:Ne&&Ne.includes("T")?Ne.split("T")[1]:"",onChange:N=>{const K=N.target.value,H=Ne&&Ne.includes("T")?Ne.split("T")[0]:Ne;F(H&&K?`${H}T${K}`:H)}})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Notes"}),o.jsx("input",{style:Re,placeholder:"Meet at Starbucks lot / HOA ok'd",value:ae,onChange:N=>_(N.target.value)})]})]}),o.jsx("div",{style:{display:"flex",justifyContent:"center"},children:o.jsx("button",{className:"btn",style:{marginTop:12},onClick:b,children:"Save Neighborhood"})}),o.jsx("div",{style:{margin:"24px 0 0 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}})]}),o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsxs("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Future Neighborhood"}),o.jsx("button",{className:"btn outline",onClick:()=>{Y(N=>!N),W&&(s(wr()),n(at()),t(St()))},children:W?"Done":"Edit"})]}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" FUTURE NEIGHBORHOOD START "}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,marginBottom:24},children:[S.length===0&&o.jsx("div",{style:{color:"var(--muted)",fontSize:13,flex:"1 1 100%"},children:"Nothing scheduled yet."}),S.map(N=>o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px solid #e5e7eb",borderRadius:10,boxShadow:"0 1px 8px #e5e7eb",paddingBottom:10},children:W?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"When / Day:"}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("input",{type:"date",value:typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[0]:"",onChange:K=>{const H=K.target.value,J=typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[1]:"";he(N,"when",H&&J?`${H}T${J}`:H)},style:Re,placeholder:"Date"}),o.jsx("input",{type:"time",value:typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[1]:"",onChange:K=>{const H=K.target.value,J=typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[0]:N.when;he(N,"when",J&&H?`${J}T${H}`:J)},style:Re,placeholder:"Time"})]})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Salesman:"}),o.jsxs("select",{value:N.salesmanEmail||"",onChange:K=>he(N,"salesman",K.target.value),style:Re,children:[o.jsx("option",{value:"",children:""}),C.map(K=>o.jsx("option",{value:K.email,children:K.name||K.email},K.email))]})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Street:"}),o.jsx("input",{value:N.street||"",onChange:K=>he(N,"street",K.target.value),placeholder:"123 Main St / Midtown",style:Re})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Notes:"}),o.jsx("input",{value:N.notes||"",onChange:K=>he(N,"notes",K.target.value),placeholder:"Gate code 1234; meet at cul-de-sac",style:Re})]}),o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px",marginTop:8,lineHeight:1,color:"var(--accent)",alignSelf:"flex-start"},onClick:()=>{window.confirm("Delete this row?")&&He(N)},children:"Delete"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"When / Day:"})," ",N.when||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Salesman:"})," ",N.salesmanName||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Street:"})," ",N.street||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Notes:"})," ",N.notes||"-"]})]})},`${N.kind}-${N.id}`)),W&&o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px dashed #cbd5e1",borderRadius:10,background:"#fafafa",boxShadow:"0 1px 8px #e5e7eb"},children:o.jsx(Qm,{salesmen:C,onAdd:N=>{const K=[...wr(),N];Bn(K),s(K)}})})]}),o.jsxs("div",{style:{fontSize:12,color:"var(--muted)",marginTop:8,lineHeight:1.4,textAlign:"center"},children:["Tip: Use an ISO datetime (e.g., ",o.jsx("code",{children:"2025-11-07T16:00"}),") for ",o.jsx("strong",{children:"When"})," to guarantee correct futurepast movement."]}),o.jsx("div",{style:{margin:"24px 0 0 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1}})]}),o.jsxs("div",{className:"section-block",style:{borderTop:"4px solid var(--accent)",padding:"16px",marginBottom:32,marginTop:0},children:[o.jsxs("div",{style:{background:"#f3f4f6",boxShadow:"0 2px 8px #e5e7eb",borderRadius:8,padding:"10px 20px",marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",style:{margin:0,fontWeight:700,fontSize:"1.35em"},children:"Past Neighborhood"}),o.jsx("button",{className:"btn outline",onClick:()=>{te(N=>!N),re&&(s(wr()),n(at()),t(St()))},children:re?"Done":"Edit"})]}),o.jsx("div",{style:{margin:"0 0 16px 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" PAST NEIGHBORHOOD START "}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,marginBottom:24},children:[R.length===0&&o.jsx("div",{style:{color:"var(--muted)",fontSize:13,flex:"1 1 100%"},children:"No past neighborhoods yet."}),R.map(N=>{const K=We(N);return o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px solid #e5e7eb",borderRadius:10,boxShadow:"0 1px 8px #e5e7eb",paddingBottom:10},children:re?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"When / Day:"}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("input",{type:"date",value:typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[0]:"",onChange:H=>{const J=H.target.value,ne=typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[1]:"";he(N,"when",J&&ne?`${J}T${ne}`:J)},style:Re,placeholder:"Date"}),o.jsx("input",{type:"time",value:typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[1]:"",onChange:H=>{const J=H.target.value,ne=typeof N.when=="string"&&N.when.includes("T")?N.when.split("T")[0]:N.when;he(N,"when",ne&&J?`${ne}T${J}`:ne)},style:Re,placeholder:"Time"})]})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Salesman:"}),o.jsxs("select",{value:N.salesmanEmail||"",onChange:H=>he(N,"salesman",H.target.value),style:Re,children:[o.jsx("option",{value:"",children:""}),C.map(H=>o.jsx("option",{value:H.email,children:H.name||H.email},H.email))]})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Street:"}),o.jsx("input",{value:N.street||"",onChange:H=>he(N,"street",H.target.value),placeholder:"123 Main St / Midtown",style:Re})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Notes:"}),o.jsx("input",{value:N.notes||"",onChange:H=>he(N,"notes",H.target.value),placeholder:"Gate code 1234; meet at cul-de-sac",style:Re})]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Customers Sold:"}),o.jsx("input",{value:K.names.join(", "),onChange:()=>{},style:Re,placeholder:"Customers Sold",readOnly:!0})]}),o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px",marginTop:8,lineHeight:1,color:"var(--accent)",alignSelf:"flex-start"},onClick:()=>{window.confirm("Delete this row?")&&He(N)},children:"Delete"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"When / Day:"})," ",N.when||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Salesman:"})," ",N.salesmanName||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Street:"})," ",N.street||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Notes:"})," ",N.notes||"-"]}),o.jsxs("div",{children:[o.jsx("span",{style:$e,children:"Customers Sold:"}),o.jsx("span",{style:{fontWeight:700,marginLeft:4},children:K.count}),K.names.length>0&&o.jsx("div",{style:$e,children:K.names.join(", ")})]})]})},`past-${N.kind}-${N.id}`)}),re&&o.jsx("div",{className:"card",style:{minWidth:260,maxWidth:360,flex:"1 1 260px",display:"flex",flexDirection:"column",gap:4,border:"1px dashed #cbd5e1",borderRadius:10,background:"#fafafa",boxShadow:"0 1px 8px #e5e7eb"},children:o.jsx(Qm,{salesmen:C,onAdd:N=>{const K=[...wr(),N];Bn(K),s(K)},isPast:!0})})]}),o.jsx("div",{style:{margin:"24px 0 0 0",textAlign:"center",color:"#a3a3a3",fontWeight:600,fontSize:14,letterSpacing:1},children:" END "})]})]})}function FC(){try{const e=new Date,t=new Date(e.toLocaleString("en-US",{timeZone:"America/Chicago"})),r=c=>String(c).padStart(2,"0"),n=t.getFullYear(),i=r(t.getMonth()+1),s=r(t.getDate()),a=r(t.getHours()),l=r(t.getMinutes());return{date:`${n}-${i}-${s}`,time:`${a}:${l}`}}catch{const e=new Date,t=l=>String(l).padStart(2,"0"),r=e.getFullYear(),n=t(e.getMonth()+1),i=t(e.getDate()),s=t(e.getHours()),a=t(e.getMinutes());return{date:`${r}-${n}-${i}`,time:`${s}:${a}`}}}function Qm({salesmen:e,onAdd:t,isPast:r}){const n=FC(),[i,s]=X.useState(n.date),[a,l]=X.useState(n.time),[c,u]=X.useState(""),[d,h]=X.useState(""),[p,m]=X.useState(""),[y,f]=X.useState("");return o.jsxs("tr",{children:[o.jsx("td",{style:cs,children:o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("input",{type:"date",value:i,onChange:g=>s(g.target.value),style:Re,placeholder:"Date"}),o.jsx("input",{type:"time",value:a,onChange:g=>l(g.target.value),style:Re,placeholder:"Time"})]})}),o.jsx("td",{style:cs,children:o.jsxs("select",{value:c,onChange:g=>u(g.target.value),style:Re,children:[o.jsx("option",{value:"",children:"Add Salesman"}),e.map(g=>o.jsx("option",{value:g.email,children:g.name||g.email},g.email))]})}),o.jsx("td",{style:cs,children:o.jsx("input",{value:d,onChange:g=>h(g.target.value),style:Re,placeholder:"Add Street"})}),o.jsx("td",{style:cs,children:o.jsx("input",{value:p,onChange:g=>m(g.target.value),style:Re,placeholder:"Add Notes"})}),r&&o.jsx("td",{style:cs,children:o.jsx("input",{value:y,onChange:g=>f(g.target.value),style:Re,placeholder:"Customers Sold (optional)"})}),o.jsx("td",{style:cs,children:o.jsx("button",{className:"btn outline",onClick:()=>{var x;if(!i||!a||!c||!d){alert("Date, Time, Salesman, and Street required");return}const g=i&&a?`${i}T${a}`:i,v={id:crypto.randomUUID?crypto.randomUUID():String(Date.now()),sellerEmail:c,sellerName:((x=e.find(w=>w.email===c))==null?void 0:x.name)||c,neighborhood:d,day:g,notes:p,assignedAt:Date.now()};r&&y&&y.trim().length>0&&(v.customersSold=y.trim()),t(v),s(n.date),l(n.time),u(""),h(""),m(""),f("")},children:"Add Row"})})]})}const Ro=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},lu=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),Sa=()=>Ro("sales",[]),cd=e=>lu("sales",e),Ea=()=>Ro("assignments",[]),ud=e=>lu("assignments",e),LC=()=>Ro("users_seed",[]),Ta=()=>Ro("neighborhoods",[]),dd=e=>lu("neighborhoods",e),hd=()=>Ro("payouts",[]),Zm=e=>isFinite(+e)?`$${(+e).toFixed(2)}`:"-",fd=e=>{if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString([],{month:"short",day:"numeric"})};function rr(e){if(!e)return new Date().toISOString().slice(0,10);try{if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);return isNaN(t.getTime())?new Date().toISOString().slice(0,10):new Date(t.getTime()-t.getTimezoneOffset()*6e4).toISOString().slice(0,10)}catch{return new Date().toISOString().slice(0,10)}}function pd(e){if(!e)return null;let t=new Date(e);return Number.isNaN(t.getTime())?null:t}const Ce={padding:"8px 10px",textAlign:"center",verticalAlign:"middle"},Oe={width:"100%",padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,outline:"none",background:"var(--card)",color:"var(--text)",fontWeight:600,textAlign:"center"};function MC(){const[e,t]=X.useState(Ea()),[r,n]=X.useState(Sa()),[i,s]=X.useState(Ta()),[a,l]=X.useState(hd()),c=X.useMemo(()=>LC(),[]),u=X.useMemo(()=>c.filter(F=>["seller","hybrid","admin"].includes(F.role)),[c]),d=X.useMemo(()=>c.filter(F=>["worker","hybrid","admin"].includes(F.role)),[c]);X.useEffect(()=>{const F=setInterval(()=>t(Ea()),3e3);return()=>clearInterval(F)},[]),X.useEffect(()=>{const F=setInterval(()=>n(Sa()),3e3);return()=>clearInterval(F)},[]),X.useEffect(()=>{const F=setInterval(()=>s(Ta()),3e3);return()=>clearInterval(F)},[]),X.useEffect(()=>{const F=setInterval(()=>l(hd()),3e3);return()=>clearInterval(F)},[]);const h=X.useMemo(()=>e.filter(F=>F.status==="worked"),[e]),[p,m]=X.useState(!1),[y,f]=X.useState({customer:"",phone:"",address:"",salesmanEmail:"",price:"",when:rr(new Date)+" 12:00",workerEmail:"",worker2Email:"",notes:""});function g(F,ae,_){const b=Ea().map(T=>T.id!==F?T:{...T,[ae]:_});ud(b),t(b)}function v(F){if(!window.confirm("Delete this job?"))return;const ae=Ea().filter(_=>_.id!==F);ud(ae),t(ae)}function x(){const ae={id:Date.now(),...y,status:"worked"},_=[...Ea(),ae];ud(_),t(_),f({customer:"",phone:"",address:"",salesmanEmail:"",price:"",when:rr(new Date)+" 12:00",workerEmail:"",worker2Email:"",notes:""})}const[w,E]=X.useState(!1);function C(F,ae,_){const b=Sa().map(T=>T.id!==F?T:{...T,[ae]:_});cd(b),n(b)}function A(){const ae={id:Date.now(),customer:"",salesmanEmail:"",phone:"",address:"",price:"",notes:"",status:"",date:rr(new Date)},_=[...Sa(),ae];cd(_),n(_)}function k(F){if(!window.confirm("Delete this sale?"))return;const ae=Sa().filter(_=>_.id!==F);cd(ae),n(ae)}const[O,U]=X.useState(!1);function z(F,ae,_){const b=Ta().map(T=>T.id!==F?T:{...T,[ae]:_});dd(b),s(b)}function V(){const ae={id:Date.now(),date:rr(new Date),time:"",salesmanEmail:"",streets:"",notes:""},_=[...Ta(),ae];dd(_),s(_)}function G(F){if(!window.confirm("Delete this neighborhood?"))return;const ae=Ta().filter(_=>_.id!==F);dd(ae),s(ae)}const ie=h,[le,xe]=X.useState(!1);function Be(F){if(!window.confirm("Delete this payout?"))return;const ae=hd().filter(_=>(_.id??_.name)!==F);lu("payouts",ae),l(ae)}function Ne(F){const ae=F==null?void 0:F.xlsx;if(!ae){alert("No file data available.");return}const _=atob(ae),b=new Uint8Array(_.length);for(let R=0;R<_.length;R++)b[R]=_.charCodeAt(R);const T=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),B=URL.createObjectURL(T),S=document.createElement("a");S.href=B,S.download=F.name||"payout.xlsx",document.body.appendChild(S),S.click(),setTimeout(()=>{URL.revokeObjectURL(B),S.remove()},250)}return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"card",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Completed Jobs"}),o.jsx("button",{className:"btn outline",onClick:()=>m(F=>!F),children:p?"Done":"Edit"})]}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Ce,children:"Customer"}),o.jsx("th",{style:Ce,children:"Phone"}),o.jsx("th",{style:Ce,children:"Address"}),o.jsx("th",{style:Ce,children:"Salesman"}),o.jsx("th",{style:Ce,children:"Price"}),o.jsx("th",{style:Ce,children:"Date"}),o.jsx("th",{style:Ce,children:"Time"}),o.jsx("th",{style:Ce,children:"Worker 1"}),o.jsx("th",{style:Ce,children:"Worker 2"}),o.jsx("th",{style:Ce,children:"Notes"}),p&&o.jsx("th",{})]})}),o.jsxs("tbody",{children:[ie.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:p?11:10,style:{...Ce,color:"var(--muted)"},children:"No worked jobs."})}),ie.map(F=>{const ae=pd(F.when);let _="",b="";if(ae)_=rr(ae.toISOString().slice(0,10)),b=ae.toTimeString().slice(0,5);else if(typeof F.when=="string"){const T=F.when.match(/^(\d{4}-\d{2}-\d{2})[ T](\d{2}:\d{2})/);T&&(_=T[1],b=T[2])}return o.jsxs("tr",{children:[o.jsx("td",{style:Ce,children:p?o.jsx("input",{style:Oe,value:F.customer||"",onChange:T=>g(F.id,"customer",T.target.value)}):F.customer||"-"}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{style:Oe,value:F.phone||"",onChange:T=>g(F.id,"phone",T.target.value)}):F.phone||"-"}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{style:Oe,value:F.address||"",onChange:T=>g(F.id,"address",T.target.value)}):F.address||"-"}),o.jsx("td",{style:Ce,children:p?o.jsxs("select",{style:Oe,value:F.salesmanEmail||"",onChange:T=>g(F.id,"salesmanEmail",T.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(T=>o.jsx("option",{value:T.email,children:T.name||T.email},T.email))]}):(()=>{const T=u.find(B=>B.email===F.salesmanEmail);return T?T.name||T.email:F.salesmanEmail||"-"})()}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{style:Oe,value:F.price||"",onChange:T=>g(F.id,"price",T.target.value)}):F.price?Zm(F.price):"-"}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{type:"date",style:Oe,value:_||rr(new Date),onChange:T=>g(F.id,"when",`${T.target.value} ${b||"12:00"}`)}):fd(F.when)}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{type:"time",style:Oe,value:b||"",onChange:T=>g(F.id,"when",`${_||rr(new Date)} ${T.target.value}`)}):b||"-"}),o.jsx("td",{style:Ce,children:p?o.jsxs("select",{style:Oe,value:F.workerEmail||"",onChange:T=>g(F.id,"workerEmail",T.target.value),children:[o.jsx("option",{value:"",children:""}),d.map(T=>o.jsx("option",{value:T.email,children:T.name||T.email},T.email))]}):(()=>{const T=d.find(B=>B.email===F.workerEmail);return T?T.name||T.email:F.workerEmail||"-"})()}),o.jsx("td",{style:Ce,children:p?o.jsxs("select",{style:Oe,value:F.worker2Email||"",onChange:T=>g(F.id,"worker2Email",T.target.value),children:[o.jsx("option",{value:"",children:""}),d.map(T=>o.jsx("option",{value:T.email,children:T.name||T.email},T.email))]}):(()=>{const T=d.find(B=>B.email===F.worker2Email);return T?T.name||T.email:F.worker2Email||"-"})()}),o.jsx("td",{style:Ce,children:p?o.jsx("input",{style:Oe,value:F.notes||"",onChange:T=>g(F.id,"notes",T.target.value)}):F.notes||"-"}),p&&o.jsx("td",{style:Ce,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>v(F.id),children:"delete"})})]},F.id)}),p&&o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("input",{style:Oe,value:y.customer,placeholder:"Customer",onChange:F=>f(ae=>({...ae,customer:F.target.value}))})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:y.phone,placeholder:"Phone",onChange:F=>f(ae=>({...ae,phone:F.target.value}))})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:y.address,placeholder:"Address",onChange:F=>f(ae=>({...ae,address:F.target.value}))})}),o.jsx("td",{children:o.jsxs("select",{style:Oe,value:y.salesmanEmail,onChange:F=>f(ae=>({...ae,salesmanEmail:F.target.value})),children:[o.jsx("option",{value:"",children:""}),u.map(F=>o.jsx("option",{value:F.email,children:F.name||F.email},F.email))]})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:y.price,placeholder:"Price",onChange:F=>f(ae=>({...ae,price:F.target.value}))})}),o.jsx("td",{children:o.jsx("input",{type:"date",style:Oe,value:(()=>{const F=(y.when||"").match(/^(\d{4}-\d{2}-\d{2})/);return F?F[1]:rr(new Date)})(),onChange:F=>f(ae=>{const _=(ae.when||"").match(/^\d{4}-\d{2}-\d{2}[ T](\d{2}:\d{2})/),b=_?_[1]:"12:00";return{...ae,when:`${F.target.value} ${b}`}})})}),o.jsx("td",{children:o.jsx("input",{type:"time",style:Oe,value:(()=>{const F=(y.when||"").match(/^\d{4}-\d{2}-\d{2}[ T](\d{2}:\d{2})/);return F?F[1]:"12:00"})(),onChange:F=>f(ae=>{const _=(ae.when||"").match(/^(\d{4}-\d{2}-\d{2})/),b=_?_[1]:rr(new Date);return{...ae,when:`${b} ${F.target.value}`}})})}),o.jsx("td",{children:o.jsxs("select",{style:Oe,value:y.workerEmail,onChange:F=>f(ae=>({...ae,workerEmail:F.target.value})),children:[o.jsx("option",{value:"",children:""}),d.map(F=>o.jsx("option",{value:F.email,children:F.name||F.email},F.email))]})}),o.jsx("td",{children:o.jsxs("select",{style:Oe,value:y.worker2Email,onChange:F=>f(ae=>({...ae,worker2Email:F.target.value})),children:[o.jsx("option",{value:"",children:""}),d.map(F=>o.jsx("option",{value:F.email,children:F.name||F.email},F.email))]})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:y.notes,placeholder:"Notes",onChange:F=>f(ae=>({...ae,notes:F.target.value}))})}),o.jsx("td",{style:{textAlign:"center"},children:o.jsx("button",{className:"btn outline",style:{fontWeight:"bold"},onClick:x,children:"+ Add Row"})})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:32},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Sales History (All)"}),o.jsx("button",{className:"btn outline",onClick:()=>E(F=>!F),children:w?"Done":"Edit"})]}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Ce,children:"Customer"}),o.jsx("th",{style:Ce,children:"Salesman"}),o.jsx("th",{style:Ce,children:"Phone"}),o.jsx("th",{style:Ce,children:"Address"}),o.jsx("th",{style:Ce,children:"Price"}),o.jsx("th",{style:Ce,children:"Notes"}),o.jsx("th",{style:Ce,children:"Status"}),o.jsx("th",{style:Ce,children:"Date"}),w&&o.jsx("th",{})]})}),o.jsxs("tbody",{children:[r.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:w?9:8,style:{...Ce,color:"var(--muted)"},children:"No sales history."})}),r.map(F=>{const ae=pd(F.date),_=rr(ae?ae.toISOString().slice(0,10):new Date);return o.jsxs("tr",{children:[o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.customer||"",onChange:b=>C(F.id,"customer",b.target.value)}):F.customer||"-"}),o.jsx("td",{style:Ce,children:w?o.jsxs("select",{style:Oe,value:F.salesmanEmail||"",onChange:b=>C(F.id,"salesmanEmail",b.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(b=>o.jsx("option",{value:b.email,children:b.name||b.email},b.email))]}):F.salesmanEmail||"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.phone||"",onChange:b=>C(F.id,"phone",b.target.value)}):F.phone||"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.address||"",onChange:b=>C(F.id,"address",b.target.value)}):F.address||"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.price||"",onChange:b=>C(F.id,"price",b.target.value)}):F.price?Zm(F.price):"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.notes||"",onChange:b=>C(F.id,"notes",b.target.value)}):F.notes||"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{style:Oe,value:F.status||"",onChange:b=>C(F.id,"status",b.target.value)}):F.status||"-"}),o.jsx("td",{style:Ce,children:w?o.jsx("input",{type:"date",style:Oe,value:_,onChange:b=>C(F.id,"date",b.target.value)}):F.date?fd(F.date):"-"}),w&&o.jsx("td",{style:Ce,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>k(F.id),children:"delete"})})]},F.id)}),w&&o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Customer"})}),o.jsx("td",{children:o.jsx("select",{style:Oe,disabled:!0,children:o.jsx("option",{children:""})})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Phone"})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Address"})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Price"})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Notes"})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Status"})}),o.jsx("td",{children:o.jsx("input",{type:"date",style:Oe,value:rr(new Date),readOnly:!0})}),o.jsx("td",{style:{textAlign:"center"},children:o.jsx("button",{className:"btn outline",style:{fontWeight:"bold"},onClick:A,children:"+ Add Row"})})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:32},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Neighborhood History (All)"}),o.jsx("button",{className:"btn outline",onClick:()=>U(F=>!F),children:O?"Done":"Edit"})]}),o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:Ce,children:"Date"}),o.jsx("th",{style:Ce,children:"Time"}),o.jsx("th",{style:Ce,children:"Salesman"}),o.jsx("th",{style:Ce,children:"Street(s)"}),o.jsx("th",{style:Ce,children:"Notes"}),O&&o.jsx("th",{})]})}),o.jsxs("tbody",{children:[i.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:O?6:5,style:{...Ce,color:"var(--muted)"},children:"No neighborhood history."})}),i.map(F=>{const ae=pd(F.date),_=rr(ae?ae.toISOString().slice(0,10):new Date);return o.jsxs("tr",{children:[o.jsx("td",{style:Ce,children:O?o.jsx("input",{type:"date",style:Oe,value:_,onChange:b=>z(F.id,"date",b.target.value)}):F.date?fd(F.date):"-"}),o.jsx("td",{style:Ce,children:O?o.jsx("input",{type:"time",style:Oe,value:F.time||"",onChange:b=>z(F.id,"time",b.target.value)}):F.time||"-"}),o.jsx("td",{style:Ce,children:O?o.jsxs("select",{style:Oe,value:F.salesmanEmail||"",onChange:b=>z(F.id,"salesmanEmail",b.target.value),children:[o.jsx("option",{value:"",children:""}),u.map(b=>o.jsx("option",{value:b.email,children:b.name||b.email},b.email))]}):F.salesmanEmail||"-"}),o.jsx("td",{style:Ce,children:O?o.jsx("input",{style:Oe,value:F.streets||"",onChange:b=>z(F.id,"streets",b.target.value)}):F.streets||"-"}),o.jsx("td",{style:Ce,children:O?o.jsx("input",{style:Oe,value:F.notes||"",onChange:b=>z(F.id,"notes",b.target.value)}):F.notes||"-"}),O&&o.jsx("td",{style:Ce,children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>G(F.id),children:"delete"})})]},F.id)}),O&&o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("input",{type:"date",style:Oe,value:rr(new Date),readOnly:!0})}),o.jsx("td",{children:o.jsx("input",{type:"time",style:Oe,value:"",readOnly:!0})}),o.jsx("td",{children:o.jsx("select",{style:Oe,disabled:!0,children:o.jsx("option",{children:""})})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Street(s)"})}),o.jsx("td",{children:o.jsx("input",{style:Oe,value:"",readOnly:!0,placeholder:"Notes"})}),o.jsx("td",{style:{textAlign:"center"},children:o.jsx("button",{className:"btn outline",style:{fontWeight:"bold"},onClick:V,children:"+ Add Row"})})]})]})]})]}),o.jsxs("div",{className:"card",style:{marginTop:32},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{className:"section-title",children:"Past Payouts"}),o.jsx("button",{className:"btn outline",onClick:()=>xe(F=>!F),children:le?"Done":"Edit"})]}),a.length===0?o.jsx("p",{style:{textAlign:"center",color:"var(--muted)"},children:"No payouts exported yet."}):o.jsx("div",{children:a.map(F=>o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid var(--border)",padding:"10px 0"},children:[o.jsx("button",{className:"btn link",style:{padding:0,background:"none",color:"var(--link)",fontWeight:"bold",textDecoration:"underline",minWidth:0,margin:0},onClick:()=>Ne(F),title:"Open Excel export",children:F.name||"Pay Period Export"}),le&&o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px"},onClick:()=>Be(F.id??F.name),children:"delete"})]},F.id||F.name))})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kc={};kc.version="0.18.5";var Dy=1252,BC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Fy=function(e){BC.indexOf(e)!=-1&&(Dy=e)};function UC(){Fy(1252)}var wo=function(e){Fy(e)};function $C(){wo(1200),UC()}var El=function(t){return String.fromCharCode(t)},eg=function(t){return String.fromCharCode(t)},jc,Xn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _o(e){for(var t="",r=0,n=0,i=0,s=0,a=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=Xn.charAt(s)+Xn.charAt(a)+Xn.charAt(l)+Xn.charAt(c);return t}function bn(e){var t="",r=0,n=0,i=0,s=0,a=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Xn.indexOf(e.charAt(u++)),a=Xn.indexOf(e.charAt(u++)),r=s<<2|a>>4,t+=String.fromCharCode(r),l=Xn.indexOf(e.charAt(u++)),n=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Xn.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Wi(e){return Ge?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function tg(e){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var en=function(t){return Ge?Pn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function cu(e){if(typeof ArrayBuffer>"u")return en(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function WC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var $t=Ge?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zC(e){for(var t=[],r=0,n=e.length+250,i=Wi(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|l>>6&15|(a&3)<<4,i[r++]=128|l&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Wi(65535),n=65530)}return t.push(i.slice(0,r)),$t(t)}var Va=/\u0000/g,Tl=/[\u0001-\u0006]/g;function Ls(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function tn(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}function a0(e,t){var r=""+e;return r.length>=t?r:gt(" ",t-r.length)+r}function Ac(e,t){var r=""+e;return r.length>=t?r:r+gt(" ",t-r.length)}function HC(e,t){var r=""+Math.round(e);return r.length>=t?r:gt("0",t-r.length)+r}function VC(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}var rg=Math.pow(2,32);function us(e,t){if(e>rg||e<-rg)return HC(e,t);var r=Math.round(e);return VC(r,t)}function Cc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ng=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],md=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function GC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ig={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Nc(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,l=0,c=1,u=0,d=0,h=Math.floor(i);u<t&&(h=Math.floor(i),l=h*a+s,d=h*u+c,!(i-h<5e-8));)i=1/(i-h),s=a,a=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=a)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function kl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=e4(c,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var Ly=new Date(1899,11,31,0,0,0),JC=Ly.getTime(),XC=new Date(1900,2,1,0,0,0);function My(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=XC&&(r+=24*60*60*1e3),(r-(JC+(e.getTimezoneOffset()-Ly.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function o0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function YC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qC(e){var t=e<0?12:11,r=o0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function QC(e){var t=o0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ZC(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=qC(e):t===10?r=e.toFixed(10).substr(0,12):r=QC(e),o0(YC(r.toUpperCase()))}function zh(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ZC(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return li(14,My(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function e4(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function t4(e,t,r,n){var i="",s=0,a=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return md[r.m-1][1];case 5:return md[r.m-1][0];default:return md[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return ng[r.q][0];default:return ng[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?tn(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=tn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?tn(c,u):"";return d}function Yn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var By=/%/g;function r4(e,t,r){var n=t.replace(By,""),i=t.length-n.length;return En(e,n,r*Math.pow(10,2*i))+gt("%",i)}function n4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return En(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Uy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Uy(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $y=/# (\?+)( ?)\/( ?)(\d+)/;function i4(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(a===0?gt(" ",e[1].length+1+e[4].length):a0(a,e[1].length)+e[2]+"/"+e[3]+tn(l,e[4].length))}function s4(e,t,r){return r+(t===0?"":""+t)+gt(" ",e[1].length+2+e[4].length)}var Wy=/^#*0*\.([0#]+)/,zy=/\).*[0#]/,Hy=/\(###\) ###\\?-####/;function sr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function sg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ag(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function a4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function o4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dr("n",n,r):"("+Dr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return n4(e,t,r);if(t.indexOf("%")!==-1)return r4(e,t,r);if(t.indexOf("E")!==-1)return Uy(t,r);if(t.charCodeAt(0)===36)return"$"+Dr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+us(c,t.length);if(t.match(/^[#?]+$/))return i=us(r,0),i==="0"&&(i=""),i.length>t.length?i:sr(t.substr(0,t.length-i.length))+i;if(s=t.match($y))return i4(s,c,u);if(t.match(/^#+0+$/))return u+us(c,t.length-t.indexOf("0"));if(s=t.match(Wy))return i=sg(r,s[1].length).replace(/^([^\.]+)$/,"$1."+sr(s[1])).replace(/\.$/,"."+sr(s[1])).replace(/\.(\d*)$/,function(y,f){return"."+f+gt("0",sr(s[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+sg(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(us(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):Yn(""+(Math.floor(r)+a4(r,s[1].length)))+"."+tn(ag(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Dr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ls(Dr(e,t.replace(/[\\-]/g,""),r)),a=0,Ls(Ls(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(t.match(Hy))return i=Dr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=Nc(c,Math.pow(10,a)-1,!1),i=""+u,d=En("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Ac(l[2],a),d.length<s[4].length&&(d=sr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=Nc(c,Math.pow(10,a)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?a0(l[1],a)+s[2]+"/"+s[3]+Ac(l[2],a):gt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=us(r,0),t.length<=i.length?i:sr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,p=t.length-i.length-h;return sr(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=ag(r,s[1].length),r<0?"-"+Dr(e,t,-r):Yn(o4(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?tn(0,3-y.length):"")+y})+"."+tn(a,s[1].length);switch(t){case"###,##0.00":return Dr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Yn(us(c,0));return m!=="0"?u+m:"";case"###,###.00":return Dr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function l4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return En(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function c4(e,t,r){var n=t.replace(By,""),i=t.length-n.length;return En(e,n,r*Math.pow(10,2*i))+gt("%",i)}function Vy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vy(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ln("n",n,r):"("+ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return l4(e,t,r);if(t.indexOf("%")!==-1)return c4(e,t,r);if(t.indexOf("E")!==-1)return Vy(t,r);if(t.charCodeAt(0)===36)return"$"+ln(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+tn(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:sr(t.substr(0,t.length-i.length))+i;if(s=t.match($y))return s4(s,c,u);if(t.match(/^#+0+$/))return u+tn(c,t.length-t.indexOf("0"));if(s=t.match(Wy))return i=(""+r).replace(/^([^\.]+)$/,"$1."+sr(s[1])).replace(/\.$/,"."+sr(s[1])),i=i.replace(/\.(\d*)$/,function(y,f){return"."+f+gt("0",sr(s[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ln(e,t,-r):Yn(""+r)+"."+gt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ls(ln(e,t.replace(/[\\-]/g,""),r)),a=0,Ls(Ls(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(t.match(Hy))return i=ln(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=Nc(c,Math.pow(10,a)-1,!1),i=""+u,d=En("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Ac(l[2],a),d.length<s[4].length&&(d=sr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=Nc(c,Math.pow(10,a)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?a0(l[1],a)+s[2]+"/"+s[3]+Ac(l[2],a):gt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:sr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,p=t.length-i.length-h;return sr(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ln(e,t,-r):Yn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?tn(0,3-y.length):"")+y})+"."+tn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Yn(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return ln(e,t.slice(0,t.lastIndexOf(".")),r)+sr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function En(e,t,r){return(r|0)===r?ln(e,t,r):Dr(e,t,r)}function u4(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Gy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ky(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Cc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Gy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function d4(e,t,r,n){for(var i=[],s="",a=0,l="",c="t",u,d,h,p="H";a<e.length;)switch(l=e.charAt(a)){case"G":if(!Cc(e,a))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=e.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=kl(t,r,e.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},c=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=kl(t,r),u==null))return"";for(s=l;++a<e.length&&e.charAt(a).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var f={t:l,v:l};if(u==null&&(u=kl(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(f.v=u.H>=12?"P":"A"),f.t="T",p="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(f.v=u.H>=12?"PM":"AM"),f.t="T",a+=5,p="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(f.v=u.H>=12?"":""),f.t="T",a+=5,p="h"):(f.t="t",++a),u==null&&f.t==="T")return"";i[i.length]=f,c=l;break;case"[":for(s=l;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Gy)){if(u==null&&(u=kl(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ky(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++a<e.length&&(l=e.charAt(a))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++a<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(a))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++a)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++a;break}var g=0,v=0,x;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,c="h",g<1&&(g=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",E;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=t4(i[a].t.charCodeAt(0),i[a].v,u,v),i[a].t="t";break;case"n":case"?":for(E=a+1;i[E]!=null&&((l=i[E].t)==="?"||l==="D"||(l===" "||l==="t")&&i[E+1]!=null&&(i[E+1].t==="?"||i[E+1].t==="t"&&i[E+1].v==="/")||i[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[E].v==="/"||i[E].v===" "&&i[E+1]!=null&&i[E+1].t=="?"));)i[a].v+=i[E].v,i[E]={v:"",t:";"},++E;w+=i[a].v,a=E-1;break;case"G":i[a].t="t",i[a].v=zh(t,r);break}var C="",A,k;if(w.length>0){w.charCodeAt(0)==40?(A=t<0&&w.charCodeAt(0)===45?-t:t,k=En("n",w,A)):(A=t<0&&n>1?-t:t,k=En("n",w,A),A<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),E=k.length-1;var O=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){O=a;break}var U=i.length;if(O===i.length&&k.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(E>=i[a].v.length-1?(E-=i[a].v.length,i[a].v=k.substr(E+1,i[a].v.length)):E<0?i[a].v="":(i[a].v=k.substr(0,E+1),E=-1),i[a].t="t",U=a);E>=0&&U<i.length&&(i[U].v=k.substr(0,E+1)+i[U].v)}else if(O!==i.length&&k.indexOf("E")===-1){for(E=k.indexOf(".")-1,a=O;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")-1:i[a].v.length-1,C=i[a].v.substr(d+1);d>=0;--d)E>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(C=k.charAt(E--)+C);i[a].v=C,i[a].t="t",U=a}for(E>=0&&U<i.length&&(i[U].v=k.substr(0,E+1)+i[U].v),E=k.indexOf(".")+1,a=O;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==O)){for(d=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")+1:0,C=i[a].v.substr(0,d);d<i[a].v.length;++d)E<k.length&&(C+=k.charAt(E++));i[a].v=C,i[a].t="t",U=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(A=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=En(i[a].t,i[a].v,A),i[a].t="t");var z="";for(a=0;a!==i.length;++a)i[a]!=null&&(z+=i[a].v);return z}var og=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function h4(e,t){var r=u4(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(og),l=r[1].match(og);return lg(t,a)?[n,r[0]]:lg(t,l)?[n,r[1]]:[n,r[a!=null&&l!=null?2:1]]}return[n,s]}function li(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[e],n==null&&(n=r.table&&r.table[ig[e]]||xt[ig[e]]),n==null&&(n=KC[e]||"General");break}if(Cc(n,0))return zh(t,r);t instanceof Date&&(t=My(t,r.date1904));var i=h4(n,t);if(Cc(i[1]))return zh(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return d4(i[1],t,r,i[0])}function Jy(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xt[r]==null){t<0&&(t=r);continue}if(xt[r]==e){t=r;break}}t<0&&(t=391)}return xt[t]=e,t}function uu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Jy(e[t],t)}function du(){xt=GC()}var Xy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function f4(e){var t=typeof e=="number"?xt[e]:e;return t=t.replace(Xy,"(\\d+)"),new RegExp("^"+t+"$")}function p4(e,t,r){var n=-1,i=-1,s=-1,a=-1,l=-1,c=-1;(t.match(Xy)||[]).forEach(function(h,p){var m=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?l=m:i=m;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var m4=function(){var e={};e.version="1.2.0";function t(){for(var k=0,O=new Array(256),U=0;U!=256;++U)k=U,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,O[U]=k;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(k){var O=0,U=0,z=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)V[z]=k[z];for(z=0;z!=256;++z)for(U=k[z],O=256+z;O<4096;O+=256)U=V[O]=U>>>8^k[U&255];var G=[];for(z=1;z!=16;++z)G[z-1]=typeof Int32Array<"u"?V.subarray(z*256,z*256+256):V.slice(z*256,z*256+256);return G}var i=n(r),s=i[0],a=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],p=i[7],m=i[8],y=i[9],f=i[10],g=i[11],v=i[12],x=i[13],w=i[14];function E(k,O){for(var U=O^-1,z=0,V=k.length;z<V;)U=U>>>8^r[(U^k.charCodeAt(z++))&255];return~U}function C(k,O){for(var U=O^-1,z=k.length-15,V=0;V<z;)U=w[k[V++]^U&255]^x[k[V++]^U>>8&255]^v[k[V++]^U>>16&255]^g[k[V++]^U>>>24]^f[k[V++]]^y[k[V++]]^m[k[V++]]^p[k[V++]]^h[k[V++]]^d[k[V++]]^u[k[V++]]^c[k[V++]]^l[k[V++]]^a[k[V++]]^s[k[V++]]^r[k[V++]];for(z+=15;V<z;)U=U>>>8^r[(U^k[V++])&255];return~U}function A(k,O){for(var U=O^-1,z=0,V=k.length,G=0,ie=0;z<V;)G=k.charCodeAt(z++),G<128?U=U>>>8^r[(U^G)&255]:G<2048?(U=U>>>8^r[(U^(192|G>>6&31))&255],U=U>>>8^r[(U^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,ie=k.charCodeAt(z++)&1023,U=U>>>8^r[(U^(240|G>>8&7))&255],U=U>>>8^r[(U^(128|G>>2&63))&255],U=U>>>8^r[(U^(128|ie>>6&15|(G&3)<<4))&255],U=U>>>8^r[(U^(128|ie&63))&255]):(U=U>>>8^r[(U^(224|G>>12&15))&255],U=U>>>8^r[(U^(128|G>>6&63))&255],U=U>>>8^r[(U^(128|G&63))&255]);return~U}return e.table=r,e.bstr=E,e.buf=C,e.str=A,e}(),Qe=function(){var t={};t.version="1.2.1";function r(j,D){for(var I=j.split("/"),P=D.split("/"),L=0,M=0,Q=Math.min(I.length,P.length);L<Q;++L){if(M=I[L].length-P[L].length)return M;if(I[L]!=P[L])return I[L]<P[L]?-1:1}return I.length-P.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var D=j.lastIndexOf("/");return D===-1?j:j.slice(0,D+1)}function i(j){if(j.charAt(j.length-1)=="/")return i(j.slice(0,-1));var D=j.lastIndexOf("/");return D===-1?j:j.slice(D+1)}function s(j,D){typeof D=="string"&&(D=new Date(D));var I=D.getHours();I=I<<6|D.getMinutes(),I=I<<5|D.getSeconds()>>>1,j.write_shift(2,I);var P=D.getFullYear()-1980;P=P<<4|D.getMonth()+1,P=P<<5|D.getDate(),j.write_shift(2,P)}function a(j){var D=j.read_shift(2)&65535,I=j.read_shift(2)&65535,P=new Date,L=I&31;I>>>=5;var M=I&15;I>>>=4,P.setMilliseconds(0),P.setFullYear(I+1980),P.setMonth(M-1),P.setDate(L);var Q=D&31;D>>>=5;var oe=D&63;return D>>>=6,P.setHours(D),P.setMinutes(oe),P.setSeconds(Q<<1),P}function l(j){Er(j,0);for(var D={},I=0;j.l<=j.length-4;){var P=j.read_shift(2),L=j.read_shift(2),M=j.l+L,Q={};switch(P){case 21589:I=j.read_shift(1),I&1&&(Q.mtime=j.read_shift(4)),L>5&&(I&2&&(Q.atime=j.read_shift(4)),I&4&&(Q.ctime=j.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}j.l=M,D[P]=Q}return D}var c;function u(){return c||(c={})}function d(j,D){if(j[0]==80&&j[1]==75)return B0(j,D);if((j[0]|32)==109&&(j[1]|32)==105)return j_(j,D);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var I=3,P=512,L=0,M=0,Q=0,oe=0,q=0,Z=[],ee=j.slice(0,512);Er(ee,0);var fe=h(ee);switch(I=fe[0],I){case 3:P=512;break;case 4:P=4096;break;case 0:if(fe[1]==0)return B0(j,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}P!==512&&(ee=j.slice(0,P),Er(ee,28));var ye=j.slice(0,P);p(ee,I);var Te=ee.read_shift(4,"i");if(I===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);ee.l+=4,Q=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),oe=ee.read_shift(4,"i"),L=ee.read_shift(4,"i"),q=ee.read_shift(4,"i"),M=ee.read_shift(4,"i");for(var me=-1,Ee=0;Ee<109&&(me=ee.read_shift(4,"i"),!(me<0));++Ee)Z[Ee]=me;var Ie=m(j,P);g(q,M,Ie,P,Z);var lt=x(Ie,Q,Z,P);lt[Q].name="!Directory",L>0&&oe!==ie&&(lt[oe].name="!MiniFAT"),lt[Z[0]].name="!FAT",lt.fat_addrs=Z,lt.ssz=P;var ct={},Kt=[],ua=[],da=[];w(Q,lt,Ie,Kt,L,ct,ua,oe),y(ua,da,Kt),Kt.shift();var ha={FileIndex:ua,FullPaths:da};return D&&D.raw&&(ha.raw={header:ye,sectors:Ie}),ha}function h(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(le,"Header Signature: "),j.l+=16;var D=j.read_shift(2,"u");return[j.read_shift(2,"u"),D]}function p(j,D){var I=9;switch(j.l+=2,I=j.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function m(j,D){for(var I=Math.ceil(j.length/D)-1,P=[],L=1;L<I;++L)P[L-1]=j.slice(L*D,(L+1)*D);return P[I-1]=j.slice(I*D),P}function y(j,D,I){for(var P=0,L=0,M=0,Q=0,oe=0,q=I.length,Z=[],ee=[];P<q;++P)Z[P]=ee[P]=P,D[P]=I[P];for(;oe<ee.length;++oe)P=ee[oe],L=j[P].L,M=j[P].R,Q=j[P].C,Z[P]===P&&(L!==-1&&Z[L]!==L&&(Z[P]=Z[L]),M!==-1&&Z[M]!==M&&(Z[P]=Z[M])),Q!==-1&&(Z[Q]=P),L!==-1&&P!=Z[P]&&(Z[L]=Z[P],ee.lastIndexOf(L)<oe&&ee.push(L)),M!==-1&&P!=Z[P]&&(Z[M]=Z[P],ee.lastIndexOf(M)<oe&&ee.push(M));for(P=1;P<q;++P)Z[P]===P&&(M!==-1&&Z[M]!==M?Z[P]=Z[M]:L!==-1&&Z[L]!==L&&(Z[P]=Z[L]));for(P=1;P<q;++P)if(j[P].type!==0){if(oe=P,oe!=Z[oe])do oe=Z[oe],D[P]=D[oe]+"/"+D[P];while(oe!==0&&Z[oe]!==-1&&oe!=Z[oe]);Z[P]=-1}for(D[0]+="/",P=1;P<q;++P)j[P].type!==2&&(D[P]+="/")}function f(j,D,I){for(var P=j.start,L=j.size,M=[],Q=P;I&&L>0&&Q>=0;)M.push(D.slice(Q*G,Q*G+G)),L-=G,Q=Ni(I,Q*4);return M.length===0?se(0):$t(M).slice(0,j.size)}function g(j,D,I,P,L){var M=ie;if(j===ie){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Q=I[j],oe=(P>>>2)-1;if(!Q)return;for(var q=0;q<oe&&(M=Ni(Q,q*4))!==ie;++q)L.push(M);g(Ni(Q,P-4),D-1,I,P,L)}}function v(j,D,I,P,L){var M=[],Q=[];L||(L=[]);var oe=P-1,q=0,Z=0;for(q=D;q>=0;){L[q]=!0,M[M.length]=q,Q.push(j[q]);var ee=I[Math.floor(q*4/P)];if(Z=q*4&oe,P<4+Z)throw new Error("FAT boundary crossed: "+q+" 4 "+P);if(!j[ee])break;q=Ni(j[ee],Z)}return{nodes:M,data:gg([Q])}}function x(j,D,I,P){var L=j.length,M=[],Q=[],oe=[],q=[],Z=P-1,ee=0,fe=0,ye=0,Te=0;for(ee=0;ee<L;++ee)if(oe=[],ye=ee+D,ye>=L&&(ye-=L),!Q[ye]){q=[];var me=[];for(fe=ye;fe>=0;){me[fe]=!0,Q[fe]=!0,oe[oe.length]=fe,q.push(j[fe]);var Ee=I[Math.floor(fe*4/P)];if(Te=fe*4&Z,P<4+Te)throw new Error("FAT boundary crossed: "+fe+" 4 "+P);if(!j[Ee]||(fe=Ni(j[Ee],Te),me[fe]))break}M[ye]={nodes:oe,data:gg([q])}}return M}function w(j,D,I,P,L,M,Q,oe){for(var q=0,Z=P.length?2:0,ee=D[j].data,fe=0,ye=0,Te;fe<ee.length;fe+=128){var me=ee.slice(fe,fe+128);Er(me,64),ye=me.read_shift(2),Te=h0(me,0,ye-Z),P.push(Te);var Ee={name:Te,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Ie=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Ie!==0&&(Ee.ct=E(me,me.l-8));var lt=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);lt!==0&&(Ee.mt=E(me,me.l-8)),Ee.start=me.read_shift(4,"i"),Ee.size=me.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=ie,Ee.name=""),Ee.type===5?(q=Ee.start,L>0&&q!==ie&&(D[q].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",D[Ee.start]===void 0&&(D[Ee.start]=v(I,Ee.start,D.fat_addrs,D.ssz)),D[Ee.start].name=Ee.name,Ee.content=D[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:q!==ie&&Ee.start!==ie&&D[q]&&(Ee.content=f(Ee,D[q].data,(D[oe]||{}).data))),Ee.content&&Er(Ee.content,0),M[Te]=Ee,Q.push(Ee)}}function E(j,D){return new Date((kr(j,D+4)/1e7*Math.pow(2,32)+kr(j,D)/1e7-11644473600)*1e3)}function C(j,D){return u(),d(c.readFileSync(j),D)}function A(j,D){var I=D&&D.type;switch(I||Ge&&Buffer.isBuffer(j)&&(I="buffer"),I||"base64"){case"file":return C(j,D);case"base64":return d(en(bn(j)),D);case"binary":return d(en(j),D)}return d(j,D)}function k(j,D){var I=D||{},P=I.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=P+"/",j.FileIndex[0]={name:P,type:5}),I.CLSID&&(j.FileIndex[0].clsid=I.CLSID),O(j)}function O(j){var D="Sh33tJ5";if(!Qe.find(j,"/"+D)){var I=se(4);I[0]=55,I[1]=I[3]=50,I[2]=54,j.FileIndex.push({name:D,type:2,content:I,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+D),U(j)}}function U(j,D){k(j);for(var I=!1,P=!1,L=j.FullPaths.length-1;L>=0;--L){var M=j.FileIndex[L];switch(M.type){case 0:P?I=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(M.R*M.L*M.C)&&(I=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!D)){var Q=new Date(1987,1,19),oe=0,q=Object.create?Object.create(null):{},Z=[];for(L=0;L<j.FullPaths.length;++L)q[j.FullPaths[L]]=!0,j.FileIndex[L].type!==0&&Z.push([j.FullPaths[L],j.FileIndex[L]]);for(L=0;L<Z.length;++L){var ee=n(Z[L][0]);P=q[ee],P||(Z.push([ee,{name:i(ee).replace("/",""),type:1,clsid:Be,ct:Q,mt:Q,content:null}]),q[ee]=!0)}for(Z.sort(function(Te,me){return r(Te[0],me[0])}),j.FullPaths=[],j.FileIndex=[],L=0;L<Z.length;++L)j.FullPaths[L]=Z[L][0],j.FileIndex[L]=Z[L][1];for(L=0;L<Z.length;++L){var fe=j.FileIndex[L],ye=j.FullPaths[L];if(fe.name=i(ye).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||Be,L===0)fe.C=Z.length>1?1:-1,fe.size=0,fe.type=5;else if(ye.slice(-1)=="/"){for(oe=L+1;oe<Z.length&&n(j.FullPaths[oe])!=ye;++oe);for(fe.C=oe>=Z.length?-1:oe,oe=L+1;oe<Z.length&&n(j.FullPaths[oe])!=n(ye);++oe);fe.R=oe>=Z.length?-1:oe,fe.type=1}else n(j.FullPaths[L+1]||"")==n(ye)&&(fe.R=L+1),fe.type=2}}}function z(j,D){var I=D||{};if(I.fileType=="mad")return A_(j,I);switch(U(j),I.fileType){case"zip":return w_(j,I)}var P=function(Te){for(var me=0,Ee=0,Ie=0;Ie<Te.FileIndex.length;++Ie){var lt=Te.FileIndex[Ie];if(lt.content){var ct=lt.content.length;ct>0&&(ct<4096?me+=ct+63>>6:Ee+=ct+511>>9)}}for(var Kt=Te.FullPaths.length+3>>2,ua=me+7>>3,da=me+127>>7,ha=ua+Ee+Kt+da,yi=ha+127>>7,_u=yi<=109?0:Math.ceil((yi-109)/127);ha+yi+_u+127>>7>yi;)_u=++yi<=109?0:Math.ceil((yi-109)/127);var mn=[1,_u,yi,da,Kt,Ee,me,0];return Te.FileIndex[0].size=me<<6,mn[7]=(Te.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(j),L=se(P[7]<<9),M=0,Q=0;{for(M=0;M<8;++M)L.write_shift(1,xe[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,P[2]),L.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:ie),L.write_shift(4,P[3]),L.write_shift(-4,P[1]?P[0]-1:ie),L.write_shift(4,P[1]),M=0;M<109;++M)L.write_shift(-4,M<P[2]?P[1]+M:-1)}if(P[1])for(Q=0;Q<P[1];++Q){for(;M<236+Q*127;++M)L.write_shift(-4,M<P[2]?P[1]+M:-1);L.write_shift(-4,Q===P[1]-1?ie:Q+1)}var oe=function(Te){for(Q+=Te;M<Q-1;++M)L.write_shift(-4,M+1);Te&&(++M,L.write_shift(-4,ie))};for(Q=M=0,Q+=P[1];M<Q;++M)L.write_shift(-4,Ne.DIFSECT);for(Q+=P[2];M<Q;++M)L.write_shift(-4,Ne.FATSECT);oe(P[3]),oe(P[4]);for(var q=0,Z=0,ee=j.FileIndex[0];q<j.FileIndex.length;++q)ee=j.FileIndex[q],ee.content&&(Z=ee.content.length,!(Z<4096)&&(ee.start=Q,oe(Z+511>>9)));for(oe(P[6]+7>>3);L.l&511;)L.write_shift(-4,Ne.ENDOFCHAIN);for(Q=M=0,q=0;q<j.FileIndex.length;++q)ee=j.FileIndex[q],ee.content&&(Z=ee.content.length,!(!Z||Z>=4096)&&(ee.start=Q,oe(Z+63>>6)));for(;L.l&511;)L.write_shift(-4,Ne.ENDOFCHAIN);for(M=0;M<P[4]<<2;++M){var fe=j.FullPaths[M];if(!fe||fe.length===0){for(q=0;q<17;++q)L.write_shift(4,0);for(q=0;q<3;++q)L.write_shift(4,-1);for(q=0;q<12;++q)L.write_shift(4,0);continue}ee=j.FileIndex[M],M===0&&(ee.start=ee.size?ee.start-1:ie);var ye=M===0&&I.root||ee.name;if(Z=2*(ye.length+1),L.write_shift(64,ye,"utf16le"),L.write_shift(2,Z),L.write_shift(1,ee.type),L.write_shift(1,ee.color),L.write_shift(-4,ee.L),L.write_shift(-4,ee.R),L.write_shift(-4,ee.C),ee.clsid)L.write_shift(16,ee.clsid,"hex");else for(q=0;q<4;++q)L.write_shift(4,0);L.write_shift(4,ee.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ee.start),L.write_shift(4,ee.size),L.write_shift(4,0)}for(M=1;M<j.FileIndex.length;++M)if(ee=j.FileIndex[M],ee.size>=4096)if(L.l=ee.start+1<<9,Ge&&Buffer.isBuffer(ee.content))ee.content.copy(L,L.l,0,ee.size),L.l+=ee.size+511&-512;else{for(q=0;q<ee.size;++q)L.write_shift(1,ee.content[q]);for(;q&511;++q)L.write_shift(1,0)}for(M=1;M<j.FileIndex.length;++M)if(ee=j.FileIndex[M],ee.size>0&&ee.size<4096)if(Ge&&Buffer.isBuffer(ee.content))ee.content.copy(L,L.l,0,ee.size),L.l+=ee.size+63&-64;else{for(q=0;q<ee.size;++q)L.write_shift(1,ee.content[q]);for(;q&63;++q)L.write_shift(1,0)}if(Ge)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function V(j,D){var I=j.FullPaths.map(function(q){return q.toUpperCase()}),P=I.map(function(q){var Z=q.split("/");return Z[Z.length-(q.slice(-1)=="/"?2:1)]}),L=!1;D.charCodeAt(0)===47?(L=!0,D=I[0].slice(0,-1)+D):L=D.indexOf("/")!==-1;var M=D.toUpperCase(),Q=L===!0?I.indexOf(M):P.indexOf(M);if(Q!==-1)return j.FileIndex[Q];var oe=!M.match(Tl);for(M=M.replace(Va,""),oe&&(M=M.replace(Tl,"!")),Q=0;Q<I.length;++Q)if((oe?I[Q].replace(Tl,"!"):I[Q]).replace(Va,"")==M||(oe?P[Q].replace(Tl,"!"):P[Q]).replace(Va,"")==M)return j.FileIndex[Q];return null}var G=64,ie=-2,le="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Be="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function F(j,D,I){u();var P=z(j,I);c.writeFileSync(D,P)}function ae(j){for(var D=new Array(j.length),I=0;I<j.length;++I)D[I]=String.fromCharCode(j[I]);return D.join("")}function _(j,D){var I=z(j,D);switch(D&&D.type||"buffer"){case"file":return u(),c.writeFileSync(D.filename,I),I;case"binary":return typeof I=="string"?I:ae(I);case"base64":return _o(typeof I=="string"?I:ae(I));case"buffer":if(Ge)return Buffer.isBuffer(I)?I:Pn(I);case"array":return typeof I=="string"?en(I):I}return I}var b;function T(j){try{var D=j.InflateRaw,I=new D;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)b=j;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function B(j,D){if(!b)return L0(j,D);var I=b.InflateRaw,P=new I,L=P._processChunk(j.slice(j.l),P._finishFlushFlag);return j.l+=P.bytesRead,L}function S(j){return b?b.deflateRawSync(j):O0(j)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(j){var D=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(D>>16|D>>8|D)&255}for(var te=typeof Uint8Array<"u",he=te?new Uint8Array(256):[],He=0;He<256;++He)he[He]=re(He);function Le(j,D){var I=he[j&255];return D<=8?I>>>8-D:(I=I<<8|he[j>>8&255],D<=16?I>>>16-D:(I=I<<8|he[j>>16&255],I>>>24-D))}function vt(j,D){var I=D&7,P=D>>>3;return(j[P]|(I<=6?0:j[P+1]<<8))>>>I&3}function We(j,D){var I=D&7,P=D>>>3;return(j[P]|(I<=5?0:j[P+1]<<8))>>>I&7}function N(j,D){var I=D&7,P=D>>>3;return(j[P]|(I<=4?0:j[P+1]<<8))>>>I&15}function K(j,D){var I=D&7,P=D>>>3;return(j[P]|(I<=3?0:j[P+1]<<8))>>>I&31}function H(j,D){var I=D&7,P=D>>>3;return(j[P]|(I<=1?0:j[P+1]<<8))>>>I&127}function J(j,D,I){var P=D&7,L=D>>>3,M=(1<<I)-1,Q=j[L]>>>P;return I<8-P||(Q|=j[L+1]<<8-P,I<16-P)||(Q|=j[L+2]<<16-P,I<24-P)||(Q|=j[L+3]<<24-P),Q&M}function ne(j,D,I){var P=D&7,L=D>>>3;return P<=5?j[L]|=(I&7)<<P:(j[L]|=I<<P&255,j[L+1]=(I&7)>>8-P),D+3}function ue(j,D,I){var P=D&7,L=D>>>3;return I=(I&1)<<P,j[L]|=I,D+1}function _e(j,D,I){var P=D&7,L=D>>>3;return I<<=P,j[L]|=I&255,I>>>=8,j[L+1]=I,D+8}function De(j,D,I){var P=D&7,L=D>>>3;return I<<=P,j[L]|=I&255,I>>>=8,j[L+1]=I&255,j[L+2]=I>>>8,D+16}function Me(j,D){var I=j.length,P=2*I>D?2*I:D+5,L=0;if(I>=D)return j;if(Ge){var M=tg(P);if(j.copy)j.copy(M);else for(;L<j.length;++L)M[L]=j[L];return M}else if(te){var Q=new Uint8Array(P);if(Q.set)Q.set(j);else for(;L<I;++L)Q[L]=j[L];return Q}return j.length=P,j}function Ze(j){for(var D=new Array(j),I=0;I<j;++I)D[I]=0;return D}function $o(j,D,I){var P=1,L=0,M=0,Q=0,oe=0,q=j.length,Z=te?new Uint16Array(32):Ze(32);for(M=0;M<32;++M)Z[M]=0;for(M=q;M<I;++M)j[M]=0;q=j.length;var ee=te?new Uint16Array(q):Ze(q);for(M=0;M<q;++M)Z[L=j[M]]++,P<L&&(P=L),ee[M]=0;for(Z[0]=0,M=1;M<=P;++M)Z[M+16]=oe=oe+Z[M-1]<<1;for(M=0;M<q;++M)oe=j[M],oe!=0&&(ee[M]=Z[oe+16]++);var fe=0;for(M=0;M<q;++M)if(fe=j[M],fe!=0)for(oe=Le(ee[M],P)>>P-fe,Q=(1<<P+4-fe)-1;Q>=0;--Q)D[oe|Q<<fe]=fe&15|M<<4;return P}var vu=te?new Uint16Array(512):Ze(512),yu=te?new Uint16Array(32):Ze(32);if(!te){for(var vi=0;vi<512;++vi)vu[vi]=0;for(vi=0;vi<32;++vi)yu[vi]=0}(function(){for(var j=[],D=0;D<32;D++)j.push(5);$o(j,yu,32);var I=[];for(D=0;D<=143;D++)I.push(8);for(;D<=255;D++)I.push(9);for(;D<=279;D++)I.push(7);for(;D<=287;D++)I.push(8);$o(I,vu,288)})();var g_=function(){for(var D=te?new Uint8Array(32768):[],I=0,P=0;I<Y.length-1;++I)for(;P<Y[I+1];++P)D[P]=I;for(;P<32768;++P)D[P]=29;var L=te?new Uint8Array(259):[];for(I=0,P=0;I<W.length-1;++I)for(;P<W[I+1];++P)L[P]=I;function M(oe,q){for(var Z=0;Z<oe.length;){var ee=Math.min(65535,oe.length-Z),fe=Z+ee==oe.length;for(q.write_shift(1,+fe),q.write_shift(2,ee),q.write_shift(2,~ee&65535);ee-- >0;)q[q.l++]=oe[Z++]}return q.l}function Q(oe,q){for(var Z=0,ee=0,fe=te?new Uint16Array(32768):[];ee<oe.length;){var ye=Math.min(65535,oe.length-ee);if(ye<10){for(Z=ne(q,Z,+(ee+ye==oe.length)),Z&7&&(Z+=8-(Z&7)),q.l=Z/8|0,q.write_shift(2,ye),q.write_shift(2,~ye&65535);ye-- >0;)q[q.l++]=oe[ee++];Z=q.l*8;continue}Z=ne(q,Z,+(ee+ye==oe.length)+2);for(var Te=0;ye-- >0;){var me=oe[ee];Te=(Te<<5^me)&32767;var Ee=-1,Ie=0;if((Ee=fe[Te])&&(Ee|=ee&-32768,Ee>ee&&(Ee-=32768),Ee<ee))for(;oe[Ee+Ie]==oe[ee+Ie]&&Ie<250;)++Ie;if(Ie>2){me=L[Ie],me<=22?Z=_e(q,Z,he[me+1]>>1)-1:(_e(q,Z,3),Z+=5,_e(q,Z,he[me-23]>>5),Z+=3);var lt=me<8?0:me-4>>2;lt>0&&(De(q,Z,Ie-W[me]),Z+=lt),me=D[ee-Ee],Z=_e(q,Z,he[me]>>3),Z-=3;var ct=me<4?0:me-2>>1;ct>0&&(De(q,Z,ee-Ee-Y[me]),Z+=ct);for(var Kt=0;Kt<Ie;++Kt)fe[Te]=ee&32767,Te=(Te<<5^oe[ee])&32767,++ee;ye-=Ie-1}else me<=143?me=me+48:Z=ue(q,Z,1),Z=_e(q,Z,he[me]),fe[Te]=ee&32767,++ee}Z=_e(q,Z,0)-1}return q.l=(Z+7)/8|0,q.l}return function(q,Z){return q.length<8?M(q,Z):Q(q,Z)}}();function O0(j){var D=se(50+Math.floor(j.length*1.1)),I=g_(j,D);return D.slice(0,I)}var I0=te?new Uint16Array(32768):Ze(32768),P0=te?new Uint16Array(32768):Ze(32768),R0=te?new Uint16Array(128):Ze(128),D0=1,F0=1;function x_(j,D){var I=K(j,D)+257;D+=5;var P=K(j,D)+1;D+=5;var L=N(j,D)+4;D+=4;for(var M=0,Q=te?new Uint8Array(19):Ze(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,Z=te?new Uint8Array(8):Ze(8),ee=te?new Uint8Array(8):Ze(8),fe=Q.length,ye=0;ye<L;++ye)Q[R[ye]]=M=We(j,D),q<M&&(q=M),Z[M]++,D+=3;var Te=0;for(Z[0]=0,ye=1;ye<=q;++ye)ee[ye]=Te=Te+Z[ye-1]<<1;for(ye=0;ye<fe;++ye)(Te=Q[ye])!=0&&(oe[ye]=ee[Te]++);var me=0;for(ye=0;ye<fe;++ye)if(me=Q[ye],me!=0){Te=he[oe[ye]]>>8-me;for(var Ee=(1<<7-me)-1;Ee>=0;--Ee)R0[Te|Ee<<me]=me&7|ye<<3}var Ie=[];for(q=1;Ie.length<I+P;)switch(Te=R0[H(j,D)],D+=Te&7,Te>>>=3){case 16:for(M=3+vt(j,D),D+=2,Te=Ie[Ie.length-1];M-- >0;)Ie.push(Te);break;case 17:for(M=3+We(j,D),D+=3;M-- >0;)Ie.push(0);break;case 18:for(M=11+H(j,D),D+=7;M-- >0;)Ie.push(0);break;default:Ie.push(Te),q<Te&&(q=Te);break}var lt=Ie.slice(0,I),ct=Ie.slice(I);for(ye=I;ye<286;++ye)lt[ye]=0;for(ye=P;ye<30;++ye)ct[ye]=0;return D0=$o(lt,I0,286),F0=$o(ct,P0,30),D}function v_(j,D){if(j[0]==3&&!(j[1]&3))return[Wi(D),2];for(var I=0,P=0,L=tg(D||1<<18),M=0,Q=L.length>>>0,oe=0,q=0;!(P&1);){if(P=We(j,I),I+=3,P>>>1)P>>1==1?(oe=9,q=5):(I=x_(j,I),oe=D0,q=F0);else{I&7&&(I+=8-(I&7));var Z=j[I>>>3]|j[(I>>>3)+1]<<8;if(I+=32,Z>0)for(!D&&Q<M+Z&&(L=Me(L,M+Z),Q=L.length);Z-- >0;)L[M++]=j[I>>>3],I+=8;continue}for(;;){!D&&Q<M+32767&&(L=Me(L,M+32767),Q=L.length);var ee=J(j,I,oe),fe=P>>>1==1?vu[ee]:I0[ee];if(I+=fe&15,fe>>>=4,!(fe>>>8&255))L[M++]=fe;else{if(fe==256)break;fe-=257;var ye=fe<8?0:fe-4>>2;ye>5&&(ye=0);var Te=M+W[fe];ye>0&&(Te+=J(j,I,ye),I+=ye),ee=J(j,I,q),fe=P>>>1==1?yu[ee]:P0[ee],I+=fe&15,fe>>>=4;var me=fe<4?0:fe-2>>1,Ee=Y[fe];for(me>0&&(Ee+=J(j,I,me),I+=me),!D&&Q<Te&&(L=Me(L,Te+100),Q=L.length);M<Te;)L[M]=L[M-Ee],++M}}}return D?[L,I+7>>>3]:[L.slice(0,M),I+7>>>3]}function L0(j,D){var I=j.slice(j.l||0),P=v_(I,D);return j.l+=P[1],P[0]}function M0(j,D){if(j)typeof console<"u"&&console.error(D);else throw new Error(D)}function B0(j,D){var I=j;Er(I,0);var P=[],L=[],M={FileIndex:P,FullPaths:L};k(M,{root:D.root});for(var Q=I.length-4;(I[Q]!=80||I[Q+1]!=75||I[Q+2]!=5||I[Q+3]!=6)&&Q>=0;)--Q;I.l=Q+4,I.l+=4;var oe=I.read_shift(2);I.l+=6;var q=I.read_shift(4);for(I.l=q,Q=0;Q<oe;++Q){I.l+=20;var Z=I.read_shift(4),ee=I.read_shift(4),fe=I.read_shift(2),ye=I.read_shift(2),Te=I.read_shift(2);I.l+=8;var me=I.read_shift(4),Ee=l(I.slice(I.l+fe,I.l+fe+ye));I.l+=fe+ye+Te;var Ie=I.l;I.l=me+4,y_(I,Z,ee,M,Ee),I.l=Ie}return M}function y_(j,D,I,P,L){j.l+=2;var M=j.read_shift(2),Q=j.read_shift(2),oe=a(j);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var q=j.read_shift(4),Z=j.read_shift(4),ee=j.read_shift(4),fe=j.read_shift(2),ye=j.read_shift(2),Te="",me=0;me<fe;++me)Te+=String.fromCharCode(j[j.l++]);if(ye){var Ee=l(j.slice(j.l,j.l+ye));(Ee[21589]||{}).mt&&(oe=Ee[21589].mt),((L||{})[21589]||{}).mt&&(oe=L[21589].mt)}j.l+=ye;var Ie=j.slice(j.l,j.l+Z);switch(Q){case 8:Ie=B(j,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var lt=!1;M&8&&(q=j.read_shift(4),q==134695760&&(q=j.read_shift(4),lt=!0),Z=j.read_shift(4),ee=j.read_shift(4)),Z!=D&&M0(lt,"Bad compressed size: "+D+" != "+Z),ee!=I&&M0(lt,"Bad uncompressed size: "+I+" != "+ee),wu(P,Te,Ie,{unsafe:!0,mt:oe})}function w_(j,D){var I=D||{},P=[],L=[],M=se(1),Q=I.compression?8:0,oe=0,q=0,Z=0,ee=0,fe=0,ye=j.FullPaths[0],Te=ye,me=j.FileIndex[0],Ee=[],Ie=0;for(q=1;q<j.FullPaths.length;++q)if(Te=j.FullPaths[q].slice(ye.length),me=j.FileIndex[q],!(!me.size||!me.content||Te=="Sh33tJ5")){var lt=ee,ct=se(Te.length);for(Z=0;Z<Te.length;++Z)ct.write_shift(1,Te.charCodeAt(Z)&127);ct=ct.slice(0,ct.l),Ee[fe]=m4.buf(me.content,0);var Kt=me.content;Q==8&&(Kt=S(Kt)),M=se(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,oe),M.write_shift(2,Q),me.mt?s(M,me.mt):M.write_shift(4,0),M.write_shift(-4,Ee[fe]),M.write_shift(4,Kt.length),M.write_shift(4,me.content.length),M.write_shift(2,ct.length),M.write_shift(2,0),ee+=M.length,P.push(M),ee+=ct.length,P.push(ct),ee+=Kt.length,P.push(Kt),M=se(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,oe),M.write_shift(2,Q),M.write_shift(4,0),M.write_shift(-4,Ee[fe]),M.write_shift(4,Kt.length),M.write_shift(4,me.content.length),M.write_shift(2,ct.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,lt),Ie+=M.l,L.push(M),Ie+=ct.length,L.push(ct),++fe}return M=se(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,fe),M.write_shift(2,fe),M.write_shift(4,Ie),M.write_shift(4,ee),M.write_shift(2,0),$t([$t(P),$t(L),M])}var Wo={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function __(j,D){if(j.ctype)return j.ctype;var I=j.name||"",P=I.match(/\.([^\.]+)$/);return P&&Wo[P[1]]||D&&(P=(I=D).match(/[\.\\]([^\.\\])+$/),P&&Wo[P[1]])?Wo[P[1]]:"application/octet-stream"}function S_(j){for(var D=_o(j),I=[],P=0;P<D.length;P+=76)I.push(D.slice(P,P+76));return I.join(`\r
`)+`\r
`}function E_(j){var D=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var ee=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],P=D.split(`\r
`),L=0;L<P.length;++L){var M=P[L];if(M.length==0){I.push("");continue}for(var Q=0;Q<M.length;){var oe=76,q=M.slice(Q,Q+oe);q.charAt(oe-1)=="="?oe--:q.charAt(oe-2)=="="?oe-=2:q.charAt(oe-3)=="="&&(oe-=3),q=M.slice(Q,Q+oe),Q+=oe,Q<M.length&&(q+="="),I.push(q)}}return I.join(`\r
`)}function T_(j){for(var D=[],I=0;I<j.length;++I){for(var P=j[I];I<=j.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+j[++I];D.push(P)}for(var L=0;L<D.length;++L)D[L]=D[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return en(D.join(`\r
`))}function k_(j,D,I){for(var P="",L="",M="",Q,oe=0;oe<10;++oe){var q=D[oe];if(!q||q.match(/^\s*$/))break;var Z=q.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":P=Z[2].trim();break;case"content-type":M=Z[2].trim();break;case"content-transfer-encoding":L=Z[2].trim();break}}switch(++oe,L.toLowerCase()){case"base64":Q=en(bn(D.slice(oe).join("")));break;case"quoted-printable":Q=T_(D.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ee=wu(j,P.slice(I.length),Q,{unsafe:!0});M&&(ee.ctype=M)}function j_(j,D){if(ae(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=D&&D.root||"",P=(Ge&&Buffer.isBuffer(j)?j.toString("binary"):ae(j)).split(`\r
`),L=0,M="";for(L=0;L<P.length;++L)if(M=P[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),I||(I=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),M.slice(0,I.length)!=I););var Q=(P[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var oe="--"+(Q[1]||""),q=[],Z=[],ee={FileIndex:q,FullPaths:Z};k(ee);var fe,ye=0;for(L=0;L<P.length;++L){var Te=P[L];Te!==oe&&Te!==oe+"--"||(ye++&&k_(ee,P.slice(fe,L),I),fe=L)}return ee}function A_(j,D){var I=D||{},P=I.boundary||"SheetJS";P="------="+P;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],M=j.FullPaths[0],Q=M,oe=j.FileIndex[0],q=1;q<j.FullPaths.length;++q)if(Q=j.FullPaths[q].slice(M.length),oe=j.FileIndex[q],!(!oe.size||!oe.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var Z=oe.content,ee=Ge&&Buffer.isBuffer(Z)?Z.toString("binary"):ae(Z),fe=0,ye=Math.min(1024,ee.length),Te=0,me=0;me<=ye;++me)(Te=ee.charCodeAt(me))>=32&&Te<128&&++fe;var Ee=fe>=ye*4/5;L.push(P),L.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+Q),L.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),L.push("Content-Type: "+__(oe,Q)),L.push(""),L.push(Ee?E_(ee):S_(ee))}return L.push(P+`--\r
`),L.join(`\r
`)}function C_(j){var D={};return k(D,j),D}function wu(j,D,I,P){var L=P&&P.unsafe;L||k(j);var M=!L&&Qe.find(j,D);if(!M){var Q=j.FullPaths[0];D.slice(0,Q.length)==Q?Q=D:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+D).replace("//","/")),M={name:i(D),type:2},j.FileIndex.push(M),j.FullPaths.push(Q),L||Qe.utils.cfb_gc(j)}return M.content=I,M.size=I?I.length:0,P&&(P.CLSID&&(M.clsid=P.CLSID),P.mt&&(M.mt=P.mt),P.ct&&(M.ct=P.ct)),M}function N_(j,D){k(j);var I=Qe.find(j,D);if(I){for(var P=0;P<j.FileIndex.length;++P)if(j.FileIndex[P]==I)return j.FileIndex.splice(P,1),j.FullPaths.splice(P,1),!0}return!1}function b_(j,D,I){k(j);var P=Qe.find(j,D);if(P){for(var L=0;L<j.FileIndex.length;++L)if(j.FileIndex[L]==P)return j.FileIndex[L].name=i(I),j.FullPaths[L]=I,!0}return!1}function O_(j){U(j,!0)}return t.find=V,t.read=A,t.parse=d,t.write=_,t.writeFile=F,t.utils={cfb_new:C_,cfb_add:wu,cfb_del:N_,cfb_mov:b_,cfb_gc:O_,ReadShift:Ka,CheckField:fw,prep_blob:Er,bconcat:$t,use_zlib:T,_deflateRaw:O0,_inflateRaw:L0,consts:Ne},t}();function g4(e){return typeof e=="string"?cu(e):Array.isArray(e)?WC(e):e}function Fo(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=cu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Eo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([g4(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Do(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Gt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cg(e,t){for(var r=[],n=Gt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function l0(e){for(var t=[],r=Gt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function hu(e){for(var t=[],r=Gt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function x4(e){for(var t=[],r=Gt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var bc=new Date(1899,11,30,0,0,0);function vr(e,t){var r=e.getTime(),n=bc.getTime()+(e.getTimezoneOffset()-bc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Yy=new Date,v4=bc.getTime()+(Yy.getTimezoneOffset()-bc.getTimezoneOffset())*6e4,ug=Yy.getTimezoneOffset();function qy(e){var t=new Date;return t.setTime(e*24*60*60*1e3+v4),t.getTimezoneOffset()!==ug&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ug)*6e4),t}var dg=new Date("2017-02-19T19:06:09.000Z"),Qy=isNaN(dg.getFullYear())?new Date("2/19/17"):dg,y4=Qy.getFullYear()==2017;function cr(e,t){var r=new Date(e);if(y4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Qy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function fu(e,t){if(Ge&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function yr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=yr(e[r]));return t}function gt(e,t){for(var r="";r.length<t;)r+=e;return r}function Tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var w4=["january","february","march","april","may","june","july","august","september","october","november","december"];function So(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&w4.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Fe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ge?n=Pn(r):n=zC(r),Qe.utils.cfb_add(e,t,n)}Qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function c0(){return Qe.utils.cfb_new()}var At=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},u0=l0(_4),d0=/[&<>'"]/g,S4=/[\u0000-\u0008\u000b-\u001f]/g;function Xe(e){var t=e+"";return t.replace(d0,function(r){return u0[r]}).replace(S4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function hg(e){return Xe(e).replace(/ /g,"_x0020_")}var Zy=/[\u0000-\u001f]/g;function E4(e){var t=e+"";return t.replace(d0,function(r){return u0[r]}).replace(/\n/g,"<br/>").replace(Zy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function T4(e){var t=e+"";return t.replace(d0,function(r){return u0[r]}).replace(Zy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function k4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function j4(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function gd(e){for(var t="",r=0,n=0,i=0,s=0,a=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function fg(e){var t=Wi(2*e.length),r,n,i=1,s=0,a=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function pg(e){return Pn(e,"binary").toString("utf8")}var jl="foo bar baz",Ga=Ge&&(pg(jl)==gd(jl)&&pg||fg(jl)==gd(jl)&&fg)||gd,Eo=Ge?function(e){return Pn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},A4=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),ew=/(^\s|\s$|\n)/;function Wt(e,t){return"<"+e+(t.match(ew)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function To(e){return Gt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ge(e,t,r){return"<"+e+(r!=null?To(r):"")+(t!=null?(t.match(ew)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Hh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function C4(e,t){switch(typeof e){case"string":var r=ge("vt:lpwstr",Xe(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ge((e|0)==e?"vt:i4":"vt:r8",Xe(String(e)));case"boolean":return ge("vt:bool",e?"true":"false")}if(e instanceof Date)return ge("vt:filetime",Hh(e));throw new Error("Unable to serialize "+e)}var Rt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},aa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Tr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function N4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function b4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var mg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},gg=Ge?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pn(t)})):mg(e)}:mg,xg=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Pa(e,i)));return n.join("").replace(Va,"")},h0=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Va,""):xg(e,t,r)}:xg,vg=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},tw=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):vg(e,t,r)}:vg,yg=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(gs(e,i)));return n.join("")},Lo=Ge?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):yg(t,r,n)}:yg,rw=function(e,t){var r=kr(e,t);return r>0?Lo(e,t+4,t+4+r-1):""},nw=rw,iw=function(e,t){var r=kr(e,t);return r>0?Lo(e,t+4,t+4+r-1):""},sw=iw,aw=function(e,t){var r=2*kr(e,t);return r>0?Lo(e,t+4,t+4+r-1):""},ow=aw,lw=function(t,r){var n=kr(t,r);return n>0?h0(t,r+4,r+4+n):""},cw=lw,uw=function(e,t){var r=kr(e,t);return r>0?Lo(e,t+4,t+4+r):""},dw=uw,hw=function(e,t){return N4(e,t)},Oc=hw,f0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ge&&(nw=function(t,r){if(!Buffer.isBuffer(t))return rw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},sw=function(t,r){if(!Buffer.isBuffer(t))return iw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ow=function(t,r){if(!Buffer.isBuffer(t))return aw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},cw=function(t,r){if(!Buffer.isBuffer(t))return lw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},dw=function(t,r){if(!Buffer.isBuffer(t))return uw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Oc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):hw(t,r)},f0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var gs=function(e,t){return e[t]},Pa=function(e,t){return e[t+1]*256+e[t]},O4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ni=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},I4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ka(e,t){var r="",n,i,s=[],a,l,c,u;switch(t){case"dbcs":if(u=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Pa(this,u)),u+=2;e*=2;break;case"utf8":r=Lo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=h0(this,this.l,this.l+e);break;case"wstr":return Ka.call(this,e,"dbcs");case"lpstr-ansi":r=nw(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":r=sw(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":r=ow(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),r=cw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),r=dw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=gs(this,this.l+e++))!==0;)s.push(El(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Pa(this,this.l+e))!==0;)s.push(El(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=gs(this,u),this.l=u+1,l=Ka.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(El(Pa(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=gs(this,u),this.l=u+1,l=Ka.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(El(gs(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=gs(this,this.l),this.l++,n;case 2:return n=(t==="i"?O4:Pa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ni:I4)(this,this.l),this.l+=4,n):(i=kr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Oc(this,this.l):i=Oc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=tw(this,this.l,e);break}}return this.l+=e,r}var P4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},R4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},D4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function F4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)D4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,P4(this,t,this.l);break;case 8:if(n=8,r==="f"){b4(this,t,this.l);break}case 16:break;case-4:n=4,R4(this,t,this.l);break}return this.l+=n,this}function fw(e,t){var r=tw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Er(e,t){e.l=t,e.read_shift=Ka,e.chk=fw,e.write_shift=F4}function pn(e,t){e.l+=t}function se(e){var t=Wi(e);return Er(t,0),t}function xr(){var e=[],t=Ge?256:2048,r=function(u){var d=se(u);return Er(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},a=function(){return i(),$t(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:a,_bufs:e}}function ce(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=NP[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&f0(r)&&e.push(r)}}function Ja(e,t,r){var n=yr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function wg(e,t,r){var n=yr(e);return n.s=Ja(n.s,t.s,r),n.e=Ja(n.e,t.s,r),n}function Xa(e,t){if(e.cRel&&e.c<0)for(e=yr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=yr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=qe(e);return!e.cRel&&e.cRel!=null&&(r=B4(r)),!e.rRel&&e.rRel!=null&&(r=L4(r)),r}function xd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Zt(e.s.c)+":"+(e.e.cRel?"":"$")+Zt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ht(e.s.r)+":"+(e.e.rRel?"":"$")+Ht(e.e.r):Xa(e.s,t.biff)+":"+Xa(e.e,t.biff)}function p0(e){return parseInt(M4(e),10)-1}function Ht(e){return""+(e+1)}function L4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function M4(e){return e.replace(/\$(\d+)$/,"$1")}function m0(e){for(var t=U4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Zt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function B4(e){return e.replace(/^([A-Z])/,"$$$1")}function U4(e){return e.replace(/^\$([A-Z])/,"$1")}function $4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Or(e){var t=e.indexOf(":");return t==-1?{s:Dt(e),e:Dt(e)}:{s:Dt(e.slice(0,t)),e:Dt(e.slice(t+1))}}function jt(e,t){return typeof t>"u"||typeof t=="number"?jt(e.s,e.e):(typeof e!="string"&&(e=qe(e)),typeof t!="string"&&(t=qe(t)),e==t?e:e+":"+t)}function st(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function _g(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=li(e.z,r?vr(t):t)}catch{}try{return e.w=li((e.XF||{}).numFmtId||(r?14:0),r?vr(t):t)}catch{return""+t}}function On(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mo[e.v]||e.v:t==null?_g(e,e.v):_g(e,t))}function Ki(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function pw(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Dt(n.origin):n.origin;a=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=st(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(u.e.r=a=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var m={v:t[h][p]},y=a+h,f=l+p;if(u.s.r>y&&(u.s.r=y),u.s.c>f&&(u.s.c=f),u.e.r<y&&(u.e.r=y),u.e.c<f&&(u.e.c=f),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))m=t[h][p];else if(Array.isArray(m.v)&&(m.f=t[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||xt[14],n.cellDates?(m.t="d",m.w=li(m.z,vr(m.v))):(m.t="n",m.v=vr(m.v),m.w=li(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][f]&&s[y][f].z&&(m.z=s[y][f].z),s[y][f]=m;else{var g=qe({c:f,r:y});s[g]&&s[g].z&&(m.z=s[g].z),s[g]=m}}}return u.s.c<1e7&&(s["!ref"]=jt(u)),s}function oa(e,t){return pw(null,e,t)}function W4(e){return e.read_shift(4,"i")}function sn(e,t){return t||(t=se(4)),t.write_shift(4,e),t}function er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ft(e,t){var r=!1;return t==null&&(r=!0,t=se(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function z4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function H4(e,t){return t||(t=se(4)),t.write_shift(2,0),t.write_shift(2,0),t}function g0(e,t){var r=e.l,n=e.read_shift(1),i=er(e),s=[],a={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(z4(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function V4(e,t){var r=!1;return t==null&&(r=!0,t=se(15+4*e.t.length)),t.write_shift(1,0),Ft(e.t,t),r?t.slice(0,t.l):t}var G4=g0;function K4(e,t){var r=!1;return t==null&&(r=!0,t=se(23+4*e.t.length)),t.write_shift(1,1),Ft(e.t,t),t.write_shift(4,1),H4({},t),r?t.slice(0,t.l):t}function Hr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ji(e,t){return t==null&&(t=se(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Xi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Yi(e,t){return t==null&&(t=se(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var J4=er,mw=Ft;function x0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ic(e,t){var r=!1;return t==null&&(r=!0,t=se(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var X4=er,Vh=x0,v0=Ic;function gw(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Oc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ni(t,0)>>2;return r?i/100:i}function xw(e,t){t==null&&(t=se(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function vw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Y4(e,t){return t||(t=se(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var qi=vw,la=Y4;function ca(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function zi(e,t){return(t||se(8)).write_shift(8,e,"f")}function q4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=aN[i];u&&(t.rgb=Ig(u));break;case 2:t.rgb=Ig([a,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Pc(e,t){if(t||(t=se(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Q4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Z4(e,t){t||(t=se(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var yw=2,_r=3,Al=11,Rc=19,Cl=64,eN=65,tN=71,rN=4108,nN=4126,Ut=80,Sg={1:{n:"CodePage",t:yw},2:{n:"Category",t:Ut},3:{n:"PresentationFormat",t:Ut},4:{n:"ByteCount",t:_r},5:{n:"LineCount",t:_r},6:{n:"ParagraphCount",t:_r},7:{n:"SlideCount",t:_r},8:{n:"NoteCount",t:_r},9:{n:"HiddenCount",t:_r},10:{n:"MultimediaClipCount",t:_r},11:{n:"ScaleCrop",t:Al},12:{n:"HeadingPairs",t:rN},13:{n:"TitlesOfParts",t:nN},14:{n:"Manager",t:Ut},15:{n:"Company",t:Ut},16:{n:"LinksUpToDate",t:Al},17:{n:"CharacterCount",t:_r},19:{n:"SharedDoc",t:Al},22:{n:"HyperlinksChanged",t:Al},23:{n:"AppVersion",t:_r,p:"version"},24:{n:"DigSig",t:eN},26:{n:"ContentType",t:Ut},27:{n:"ContentStatus",t:Ut},28:{n:"Language",t:Ut},29:{n:"Version",t:Ut},255:{},2147483648:{n:"Locale",t:Rc},2147483651:{n:"Behavior",t:Rc},1919054434:{}},Eg={1:{n:"CodePage",t:yw},2:{n:"Title",t:Ut},3:{n:"Subject",t:Ut},4:{n:"Author",t:Ut},5:{n:"Keywords",t:Ut},6:{n:"Comments",t:Ut},7:{n:"Template",t:Ut},8:{n:"LastAuthor",t:Ut},9:{n:"RevNumber",t:Ut},10:{n:"EditTime",t:Cl},11:{n:"LastPrinted",t:Cl},12:{n:"CreatedDate",t:Cl},13:{n:"ModifiedDate",t:Cl},14:{n:"PageCount",t:_r},15:{n:"WordCount",t:_r},16:{n:"CharCount",t:_r},17:{n:"Thumbnail",t:tN},18:{n:"Application",t:Ut},19:{n:"DocSecurity",t:_r},255:{},2147483648:{n:"Locale",t:Rc},2147483651:{n:"Behavior",t:Rc},1919054434:{}};function iN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var sN=iN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),aN=yr(sN),Mo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},oN={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ww(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _w(e,t){var r=x4(oN),n=[],i;n[n.length]=At,n[n.length]=ge("Types",null,{xmlns:Rt.CT,"xmlns:xsd":Rt.xsd,"xmlns:xsi":Rt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ge("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Nl[c][t.bookType]||Nl[c].xlsx}))},a=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Nl[c][t.bookType]||Nl[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),a("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ve={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sw(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ms(e){var t=[At,ge("Relationships",null,{xmlns:Rt.RELS})];return Gt(e["!id"]).forEach(function(r){t[t.length]=ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Je(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ve.HLINK,Ve.XPATH,Ve.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function lN(e){var t=[At];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Tg(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function uN(e){var t=[At];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Tg(e[r][0],e[r][1])),t.push(cN("",e[r][0]));return t.push(Tg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ew(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kc.version+"</meta:generator></office:meta></office:document-meta>"}var Fi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function vd(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Xe(t),n[n.length]=r?ge(e,t,r):Wt(e,t))}function Tw(e,t){var r=t||{},n=[At,ge("cp:coreProperties",null,{"xmlns:cp":Rt.CORE_PROPS,"xmlns:dc":Rt.dc,"xmlns:dcterms":Rt.dcterms,"xmlns:dcmitype":Rt.dcmitype,"xmlns:xsi":Rt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&vd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Hh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&vd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Hh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Fi.length;++s){var a=Fi[s],l=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&vd(a[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Bs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],kw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jw(e){var t=[],r=ge;return e||(e={}),e.Application="SheetJS",t[t.length]=At,t[t.length]=ge("Properties",null,{xmlns:Rt.EXT_PROPS,"xmlns:vt":Rt.vt}),Bs.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Xe(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Xe(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Aw(e){var t=[At,ge("Properties",null,{xmlns:Rt.CUST_PROPS,"xmlns:vt":Rt.vt})];if(!e)return t.join("");var r=1;return Gt(e).forEach(function(i){++r,t[t.length]=ge("property",C4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xe(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var kg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dN(e,t){var r=[];return Gt(kg).map(function(n){for(var i=0;i<Fi.length;++i)if(Fi[i][1]==n)return Fi[i];for(i=0;i<Bs.length;++i)if(Bs[i][1]==n)return Bs[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Wt(kg[n[1]]||n[1],i))}}),ge("DocumentProperties",r.join(""),{xmlns:Tr.o})}function hN(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Gt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Fi.length;++a)if(s==Fi[a][1])return;for(a=0;a<Bs.length;++a)if(s==Bs[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(ge(hg(s),l,{"dt:dt":c}))}}),t&&Gt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ge(hg(s),a,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Tr.o+'">'+i.join("")+"</"+n+">"}function fN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=se(8);return a.write_shift(4,n),a.write_shift(4,i),a}function jg(e,t){var r=se(4),n=se(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=se(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=fN(t);break;case 31:case 80:for(n=se(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return $t([r,n])}var Cw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function pN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ag(e,t,r){var n=se(8),i=[],s=[],a=8,l=0,c=se(8),u=se(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),a+=8+c.length,!t){u=se(8),u.write_shift(4,0),i.unshift(u);var d=[se(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=se(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=$t(d),s.unshift(c),a+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Cw.indexOf(e[l][0])>-1||kw.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],m=0;if(t){m=+t[e[l][0]];var y=r[m];if(y.p=="version"&&typeof p=="string"){var f=p.split(".");p=(+f[0]<<16)+(+f[1]||0)}c=jg(y.t,p)}else{var g=pN(p);g==-1&&(g=31,p=String(p)),c=jg(g,p)}s.push(c),u=se(8),u.write_shift(4,t?m:2+l),i.push(u),a+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,a),n.write_shift(4,s.length),$t([n].concat(i).concat(s))}function Cg(e,t,r,n,i,s){var a=se(i?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Qe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var c=Ag(e,r,n);if(l.push(c),i){var u=Ag(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),l.push(u)}return $t(l)}function mN(e,t){t||(t=se(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function gN(e,t){return e.read_shift(t)===1}function ar(e,t){return t||(t=se(2)),t.write_shift(2,+!!e),t}function Nw(e){return e.read_shift(2,"u")}function Fr(e,t){return t||(t=se(2)),t.write_shift(2,e),t}function bw(e,t,r){return r||(r=se(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Ow(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function xN(e){var t=e.t||"",r=se(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=se(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return $t(i)}function vN(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yN(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vN(e,n,r)}function wN(e,t,r){if(r.biff>5)return yN(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Iw(e,t,r){return r||(r=se(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Ng(e,t){t||(t=se(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _N(e){var t=se(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Ng(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&Ng(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Hi(e,t,r,n){return n||(n=se(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function SN(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function EN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Pw(e,t){return t||(t=se(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function y0(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=se(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function TN(e,t){var r=!t||t.biff==8,n=se(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function kN(e,t){var r=!t||t.biff>=8?2:1,n=se(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function jN(e,t){var r=se(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=xN(e[i]);var s=$t([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function AN(){var e=se(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function CN(e){var t=se(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function NN(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=se(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function bN(e,t,r,n){var i=se(10);return Hi(e,t,n,i),i.write_shift(4,r),i}function ON(e,t,r,n,i){var s=!i||i.biff==8,a=se(8+ +s+(1+s)*r.length);return Hi(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function IN(e,t,r,n){var i=r&&r.biff==5;n||(n=se(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function PN(e,t){var r=t.biff==8||!t.biff?4:2,n=se(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function bg(e,t,r,n){var i=r&&r.biff==5;n||(n=se(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function RN(e){var t=se(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function DN(e,t,r,n,i,s){var a=se(8);return Hi(e,t,n,a),bw(r,s,a),a}function FN(e,t,r,n){var i=se(14);return Hi(e,t,n,i),zi(r,i),i}function LN(e,t,r){if(r.biff<8)return MN(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(SN(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function MN(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Ow(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function BN(e){var t=se(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Pw(e[r],t);return t}function UN(e){var t=se(24),r=Dt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return $t([t,_N(e[1])])}function $N(e){var t=e[1].Tooltip,r=se(10+2*(t.length+1));r.write_shift(2,2048);var n=Dt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function WN(e){return e||(e=se(4)),e.write_shift(2,1),e.write_shift(2,1),e}function zN(e,t,r){if(!r.cellStyles)return pn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:a,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function HN(e,t){var r=se(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function VN(e){for(var t=se(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function GN(e,t,r){var n=se(15);return Uo(n,e,t),n.write_shift(8,r,"f"),n}function KN(e,t,r){var n=se(9);return Uo(n,e,t),n.write_shift(2,r),n}var JN=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=l0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Wi(1);switch(c.type){case"base64":d=en(bn(l));break;case"binary":d=en(l);break;case"buffer":case"array":d=l;break}Er(d,0);var h=d.read_shift(1),p=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var f=0,g=521;h==2&&(f=d.read_shift(2)),d.l+=3,h!=2&&(f=d.read_shift(4)),f>1048576&&(f=1e6),h!=2&&(g=d.read_shift(2));var v=d.read_shift(2),x=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(x=e[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var w=[],E={},C=Math.min(d.length,h==2?521:g-10-(m?264:0)),A=y?32:11;d.l<C&&d[d.l]!=13;)switch(E={},E.name=jc.utils.decode(x,d.slice(d.l,d.l+A)).replace(/[\u0000\r\n].*$/g,""),d.l+=A,E.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),h==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&w.push(E),h!=2&&(d.l+=y?13:14),E.type){case"B":(!m||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var k=0,O=0;for(u[0]=[],O=0;O!=w.length;++O)u[0][O]=w[O].name;for(;f-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++k]=[],O=0,O=0;O!=w.length;++O){var U=d.slice(d.l,d.l+w[O].len);d.l+=w[O].len,Er(U,0);var z=jc.utils.decode(x,U);switch(w[O].type){case"C":z.trim().length&&(u[k][O]=z.replace(/\s+$/,""));break;case"D":z.length===8?u[k][O]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):u[k][O]=z;break;case"F":u[k][O]=parseFloat(z.trim());break;case"+":case"I":u[k][O]=y?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":u[k][O]=!0;break;case"N":case"F":u[k][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[k][O]="##MEMO##"+(y?parseInt(z.trim(),10):U.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(u[k][O]=+z||0);break;case"@":u[k][O]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":u[k][O]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":u[k][O]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][O]=-U.read_shift(-8,"f");break;case"B":if(m&&w[O].len==8){u[k][O]=U.read_shift(8,"f");break}case"G":case"P":U.l+=w[O].len;break;case"0":if(w[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[O].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=oa(r(l,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function i(l,c){try{return Ki(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,c){var u=c||{};if(+u.codepage>=0&&wo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=xr(),h=Bc(l,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),y=l["!cols"]||[],f=0,g=0,v=0,x=1;for(f=0;f<p.length;++f){if(((y[f]||{}).DBF||{}).name){p[f]=y[f].DBF.name,++v;continue}if(p[f]!=null){if(++v,typeof p[f]=="number"&&(p[f]=p[f].toString(10)),typeof p[f]!="string")throw new Error("DBF Invalid column name "+p[f]+" |"+typeof p[f]+"|");if(p.indexOf(p[f])!==f){for(g=0;g<1024;++g)if(p.indexOf(p[f]+"_"+g)==-1){p[f]+="_"+g;break}}}}var w=st(l["!ref"]),E=[],C=[],A=[];for(f=0;f<=w.e.c-w.s.c;++f){var k="",O="",U=0,z=[];for(g=0;g<m.length;++g)m[g][f]!=null&&z.push(m[g][f]);if(z.length==0||p[f]==null){E[f]="?";continue}for(g=0;g<z.length;++g){switch(typeof z[g]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=z[g]instanceof Date?"D":"C";break;default:O="C"}U=Math.max(U,String(z[g]).length),k=k&&k!=O?"C":O}U>250&&(U=250),O=((y[f]||{}).DBF||{}).type,O=="C"&&y[f].DBF.len>U&&(U=y[f].DBF.len),k=="B"&&O=="N"&&(k="N",A[f]=y[f].DBF.dec,U=y[f].DBF.len),C[f]=k=="C"||O=="N"?U:s[k]||0,x+=C[f],E[f]=k}var V=d.next(32);for(V.write_shift(4,318902576),V.write_shift(4,m.length),V.write_shift(2,296+32*v),V.write_shift(2,x),f=0;f<4;++f)V.write_shift(4,0);for(V.write_shift(4,0|(+t[Dy]||3)<<8),f=0,g=0;f<p.length;++f)if(p[f]!=null){var G=d.next(32),ie=(p[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,ie,"sbcs"),G.write_shift(1,E[f]=="?"?"C":E[f],"sbcs"),G.write_shift(4,g),G.write_shift(1,C[f]||s[E[f]]||0),G.write_shift(1,A[f]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),g+=C[f]||s[E[f]]||0}var le=d.next(264);for(le.write_shift(4,13),f=0;f<65;++f)le.write_shift(4,0);for(f=0;f<m.length;++f){var xe=d.next(x);for(xe.write_shift(1,0),g=0;g<p.length;++g)if(p[g]!=null)switch(E[g]){case"L":xe.write_shift(1,m[f][g]==null?63:m[f][g]?84:70);break;case"B":xe.write_shift(8,m[f][g]||0,"f");break;case"N":var Be="0";for(typeof m[f][g]=="number"&&(Be=m[f][g].toFixed(A[g]||0)),v=0;v<C[g]-Be.length;++v)xe.write_shift(1,32);xe.write_shift(1,Be,"sbcs");break;case"D":m[f][g]?(xe.write_shift(4,("0000"+m[f][g].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(m[f][g].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+m[f][g].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(m[f][g]!=null?m[f][g]:"").slice(0,C[g]);for(xe.write_shift(1,Ne,"sbcs"),v=0;v<C[g]-Ne.length;++v)xe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),XN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Gt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,m){var y=e[m];return typeof y=="number"?eg(y):y},n=function(p,m,y){var f=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return f==59?p:eg(f)};e["|"]=254;function i(p,m){switch(m.type){case"base64":return s(bn(p),m);case"binary":return s(p,m);case"buffer":return s(Ge&&Buffer.isBuffer(p)?p.toString("binary"):Do(p),m);case"array":return s(fu(p),m)}throw new Error("Unrecognized type "+m.type)}function s(p,m){var y=p.split(/[\n\r]+/),f=-1,g=-1,v=0,x=0,w=[],E=[],C=null,A={},k=[],O=[],U=[],z=0,V;for(+m.codepage>=0&&wo(+m.codepage);v!==y.length;++v){z=0;var G=y[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ie=G.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),le=ie[0],xe;if(G.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&E.push(G.slice(3).replace(/;;/g,";"));break;case"C":var Be=!1,Ne=!1,F=!1,ae=!1,_=-1,b=-1;for(x=1;x<ie.length;++x)switch(ie[x].charAt(0)){case"A":break;case"X":g=parseInt(ie[x].slice(1))-1,Ne=!0;break;case"Y":for(f=parseInt(ie[x].slice(1))-1,Ne||(g=0),V=w.length;V<=f;++V)w[V]=[];break;case"K":xe=ie[x].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(Tn(xe))?isNaN(So(xe).getDate())||(xe=cr(xe)):(xe=Tn(xe),C!==null&&Ky(C)&&(xe=qy(xe))),Be=!0;break;case"E":ae=!0;var T=Kb(ie[x].slice(1),{r:f,c:g});w[f][g]=[w[f][g],T];break;case"S":F=!0,w[f][g]=[w[f][g],"S5S"];break;case"G":break;case"R":_=parseInt(ie[x].slice(1))-1;break;case"C":b=parseInt(ie[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}if(Be&&(w[f][g]&&w[f][g].length==2?w[f][g][0]=xe:w[f][g]=xe,C=null),F){if(ae)throw new Error("SYLK shared formula cannot have own formula");var B=_>-1&&w[_][b];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");w[f][g][1]=Jb(B[1],{r:f-_,c:g-b})}break;case"F":var S=0;for(x=1;x<ie.length;++x)switch(ie[x].charAt(0)){case"X":g=parseInt(ie[x].slice(1))-1,++S;break;case"Y":for(f=parseInt(ie[x].slice(1))-1,V=w.length;V<=f;++V)w[V]=[];break;case"M":z=parseInt(ie[x].slice(1))/20;break;case"F":break;case"G":break;case"P":C=E[parseInt(ie[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=ie[x].slice(1).split(" "),V=parseInt(U[0],10);V<=parseInt(U[1],10);++V)z=parseInt(U[2],10),O[V-1]=z===0?{hidden:!0}:{wch:z},w0(O[V-1]);break;case"C":g=parseInt(ie[x].slice(1))-1,O[g]||(O[g]={});break;case"R":f=parseInt(ie[x].slice(1))-1,k[f]||(k[f]={}),z>0?(k[f].hpt=z,k[f].hpx=Mw(z)):z===0&&(k[f].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}S<1&&(C=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}}return k.length>0&&(A["!rows"]=k),O.length>0&&(A["!cols"]=O),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,A]}function a(p,m){var y=i(p,m),f=y[0],g=y[1],v=oa(f,m);return Gt(g).forEach(function(x){v[x]=g[x]}),v}function l(p,m){return Ki(a(p,m),m)}function c(p,m,y,f){var g="C;Y"+(y+1)+";X"+(f+1)+";K";switch(p.t){case"n":g+=p.v||0,p.f&&!p.F&&(g+=";E"+S0(p.f,{r:y,c:f}));break;case"b":g+=p.v?"TRUE":"FALSE";break;case"e":g+=p.w||p.v;break;case"d":g+='"'+(p.w||p.v)+'"';break;case"s":g+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(p,m){m.forEach(function(y,f){var g="F;W"+(f+1)+" "+(f+1)+" ";y.hidden?g+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Dc(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Fc(y.wpx)),typeof y.wch=="number"&&(g+=Math.round(y.wch))),g.charAt(g.length-1)!=" "&&p.push(g)})}function d(p,m){m.forEach(function(y,f){var g="F;";y.hidden?g+="M0;":y.hpt?g+="M"+20*y.hpt+";":y.hpx&&(g+="M"+20*Lc(y.hpx)+";"),g.length>2&&p.push(g+"R"+(f+1))})}function h(p,m){var y=["ID;PWXL;N;E"],f=[],g=st(p["!ref"]),v,x=Array.isArray(p),w=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&u(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var E=g.s.r;E<=g.e.r;++E)for(var C=g.s.c;C<=g.e.c;++C){var A=qe({r:E,c:C});v=x?(p[E]||[])[C]:p[A],!(!v||v.v==null&&(!v.f||v.F))&&f.push(c(v,p,E,C))}return y.join(w)+w+f.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:a,from_sheet:h}}(),YN=function(){function e(s,a){switch(a.type){case"base64":return t(bn(s),a);case"binary":return t(s,a);case"buffer":return t(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Do(s),a);case"array":return t(fu(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var l=s.split(`
`),c=-1,u=-1,d=0,h=[];d!==l.length;++d){if(l[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var p=l[d].trim().split(","),m=p[0],y=p[1];++d;for(var f=l[d]||"";(f.match(/["]/g)||[]).length&1&&d<l.length-1;)f+=`
`+l[++d];switch(f=f.trim(),+m){case-1:if(f==="BOT"){h[++c]=[],u=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:f==="TRUE"?h[c][u]=!0:f==="FALSE"?h[c][u]=!1:isNaN(Tn(y))?isNaN(So(y).getDate())?h[c][u]=y:h[c][u]=cr(y):h[c][u]=Tn(y),++u;break;case 1:f=f.slice(1,f.length-1),f=f.replace(/""/g,'"'),f&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),h[c][u++]=f!==""?f:null;break}if(f==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return oa(e(s,a),a)}function n(s,a){return Ki(r(s,a),a)}var i=function(){var s=function(c,u,d,h,p){c.push(u),c.push(d+","+h),c.push('"'+p.replace(/"/g,'""')+'"')},a=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=st(c["!ref"]),h,p=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){a(u,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var f=qe({r:m,c:y});if(h=p?(c[m]||[])[y]:c[f],!h){a(u,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,g,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=li(h.z||xt[14],vr(cr(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var v=`\r
`,x=u.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Rw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var m=h.split(`
`),y=-1,f=-1,g=0,v=[];g!==m.length;++g){var x=m[g].trim().split(":");if(x[0]==="cell"){var w=Dt(x[1]);if(v.length<=w.r)for(y=v.length;y<=w.r;++y)v[y]||(v[y]=[]);switch(y=w.r,f=w.c,x[2]){case"t":v[y][f]=e(x[3]);break;case"v":v[y][f]=+x[3];break;case"vtf":var E=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[y][f]=!!+x[4];break;default:v[y][f]=+x[4];break}x[2]=="vtf"&&(v[y][f]=[v[y][f],E])}}}return p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}function n(h,p){return oa(r(h,p),p)}function i(h,p){return Ki(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],y,f="",g=Or(h["!ref"]),v=Array.isArray(h),x=g.s.r;x<=g.e.r;++x)for(var w=g.s.c;w<=g.e.c;++w)if(f=qe({r:x,c:w}),y=v?(h[x]||[])[w]:h[f],!(!y||y.v==null||y.t==="z")){switch(m=["cell",f,"t"],y.t){case"s":case"str":m.push(t(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=t(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var E=vr(cr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+E,m[5]=y.w||li(y.z||xt[14],E);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,l,a,u(h),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),qN=function(){function e(d,h,p,m,y){y.raw?h[p][m]=d:d===""||(d==="TRUE"?h[p][m]=!0:d==="FALSE"?h[p][m]=!1:isNaN(Tn(d))?isNaN(So(d).getDate())?h[p][m]=d:h[p][m]=cr(d):h[p][m]=Tn(d))}function t(d,h){var p=h||{},m=[];if(!d||d.length===0)return m;for(var y=d.split(/[\r\n]/),f=y.length-1;f>=0&&y[f].length===0;)--f;for(var g=10,v=0,x=0;x<=f;++x)v=y[x].indexOf(" "),v==-1?v=y[x].length:v++,g=Math.max(g,v);for(x=0;x<=f;++x){m[x]=[];var w=0;for(e(y[x].slice(0,g).trim(),m,x,w,p),w=1;w<=(y[x].length-g)/10+1;++w)e(y[x].slice(g+(w-1)*10,g+w*10).trim(),m,x,w,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,m=0,y=0;m<d.length;++m)(y=d.charCodeAt(m))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(f,g){return f[0]-g[0]||n[f[1]]-n[g[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},m="",y=p.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):p&&p.FS?m=p.FS:m=i(d.slice(0,1024));var g=0,v=0,x=0,w=0,E=0,C=m.charCodeAt(0),A=!1,k=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var U=p.dateNF!=null?f4(p.dateNF):null;function z(){var V=d.slice(w,E),G={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)G.t="z";else if(p.raw)G.t="s",G.v=V;else if(V.trim().length===0)G.t="s",G.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(G.t="s",G.v=V.slice(2,-1).replace(/""/g,'"')):Xb(V)?(G.t="n",G.f=V.slice(1)):(G.t="s",G.v=V);else if(V=="TRUE")G.t="b",G.v=!0;else if(V=="FALSE")G.t="b",G.v=!1;else if(!isNaN(x=Tn(V)))G.t="n",p.cellText!==!1&&(G.w=V),G.v=x;else if(!isNaN(So(V).getDate())||U&&V.match(U)){G.z=p.dateNF||xt[14];var ie=0;U&&V.match(U)&&(V=p4(V,p.dateNF,V.match(U)||[]),ie=1),p.cellDates?(G.t="d",G.v=cr(V,ie)):(G.t="n",G.v=vr(cr(V,ie))),p.cellText!==!1&&(G.w=li(G.z,G.v instanceof Date?vr(G.v):G.v)),p.cellNF||delete G.z}else G.t="s",G.v=V;if(G.t=="z"||(p.dense?(y[g]||(y[g]=[]),y[g][v]=G):y[qe({c:v,r:g})]=G),w=E+1,O=d.charCodeAt(w),f.e.c<v&&(f.e.c=v),f.e.r<g&&(f.e.r=g),k==C)++v;else if(v=0,++g,p.sheetRows&&p.sheetRows<=g)return!0}e:for(;E<d.length;++E)switch(k=d.charCodeAt(E)){case 34:O===34&&(A=!A);break;case C:case 10:case 13:if(!A&&z())break e;break}return E-w>0&&z(),y["!ref"]=jt(f),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):oa(t(d,h),h)}function l(d,h){var p="",m=h.type=="string"?[0,0,0,0]:cR(d,h);switch(h.type){case"base64":p=bn(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof jc<"u"||(p=Ge&&Buffer.isBuffer(d)?d.toString("binary"):Do(d));break;case"array":p=fu(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Ga(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Ga(p):h.type=="binary"&&typeof jc<"u",p.slice(0,19)=="socialcalc:version:"?Rw.to_sheet(h.type=="string"?p:Ga(p),h):a(p,h)}function c(d,h){return Ki(l(d,h),h)}function u(d){for(var h=[],p=st(d["!ref"]),m,y=Array.isArray(d),f=p.s.r;f<=p.e.r;++f){for(var g=[],v=p.s.c;v<=p.e.c;++v){var x=qe({r:f,c:v});if(m=y?(d[f]||[])[v]:d[x],!m||m.v==null){g.push("          ");continue}for(var w=(m.w||(On(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(v===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),Og=function(){function e(T,B,S){if(T){Er(T,T.l||0);for(var R=S.Enum||_;T.l<T.length;){var W=T.read_shift(2),Y=R[W]||R[65535],re=T.read_shift(2),te=T.l+re,he=Y.f&&Y.f(T,re,S);if(T.l=te,B(he,Y,W))return}}}function t(T,B){switch(B.type){case"base64":return r(en(bn(T)),B);case"binary":return r(en(T),B);case"buffer":case"array":return r(T,B)}throw"Unsupported type "+B.type}function r(T,B){if(!T)return T;var S=B||{},R=S.dense?[]:{},W="Sheet1",Y="",re=0,te={},he=[],He=[],Le={s:{r:0,c:0},e:{r:0,c:0}},vt=S.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)S.Enum=_,e(T,function(H,J,ne){switch(ne){case 0:S.vers=H,H>=4096&&(S.qpro=!0);break;case 6:Le=H;break;case 204:H&&(Y=H);break;case 222:Y=H;break;case 15:case 51:S.qpro||(H[1].v=H[1].v.slice(1));case 13:case 14:case 16:ne==14&&(H[2]&112)==112&&(H[2]&15)>1&&(H[2]&15)<15&&(H[1].z=S.dateNF||xt[14],S.cellDates&&(H[1].t="d",H[1].v=qy(H[1].v))),S.qpro&&H[3]>re&&(R["!ref"]=jt(Le),te[W]=R,he.push(W),R=S.dense?[]:{},Le={s:{r:0,c:0},e:{r:0,c:0}},re=H[3],W=Y||"Sheet"+(re+1),Y="");var ue=S.dense?(R[H[0].r]||[])[H[0].c]:R[qe(H[0])];if(ue){ue.t=H[1].t,ue.v=H[1].v,H[1].z!=null&&(ue.z=H[1].z),H[1].f!=null&&(ue.f=H[1].f);break}S.dense?(R[H[0].r]||(R[H[0].r]=[]),R[H[0].r][H[0].c]=H[1]):R[qe(H[0])]=H[1];break}},S);else if(T[2]==26||T[2]==14)S.Enum=b,T[2]==14&&(S.qpro=!0,T.l=0),e(T,function(H,J,ne){switch(ne){case 204:W=H;break;case 22:H[1].v=H[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(H[3]>re&&(R["!ref"]=jt(Le),te[W]=R,he.push(W),R=S.dense?[]:{},Le={s:{r:0,c:0},e:{r:0,c:0}},re=H[3],W="Sheet"+(re+1)),vt>0&&H[0].r>=vt)break;S.dense?(R[H[0].r]||(R[H[0].r]=[]),R[H[0].r][H[0].c]=H[1]):R[qe(H[0])]=H[1],Le.e.c<H[0].c&&(Le.e.c=H[0].c),Le.e.r<H[0].r&&(Le.e.r=H[0].r);break;case 27:H[14e3]&&(He[H[14e3][0]]=H[14e3][1]);break;case 1537:He[H[0]]=H[1],H[0]==re&&(W=H[1]);break}},S);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(R["!ref"]=jt(Le),te[Y||W]=R,he.push(Y||W),!He.length)return{SheetNames:he,Sheets:te};for(var We={},N=[],K=0;K<He.length;++K)te[he[K]]?(N.push(He[K]||he[K]),We[He[K]]=te[He[K]]||te[he[K]]):(N.push(He[K]),We[He[K]]={"!ref":"A1"});return{SheetNames:N,Sheets:We}}function n(T,B){var S=B||{};if(+S.codepage>=0&&wo(+S.codepage),S.type=="string")throw new Error("Cannot write WK1 to JS string");var R=xr(),W=st(T["!ref"]),Y=Array.isArray(T),re=[];ve(R,0,s(1030)),ve(R,6,c(W));for(var te=Math.min(W.e.r,8191),he=W.s.r;he<=te;++he)for(var He=Ht(he),Le=W.s.c;Le<=W.e.c;++Le){he===W.s.r&&(re[Le]=Zt(Le));var vt=re[Le]+He,We=Y?(T[he]||[])[Le]:T[vt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?ve(R,13,m(he,Le,We.v)):ve(R,14,f(he,Le,We.v));else{var N=On(We);ve(R,15,h(he,Le,N.slice(0,239)))}}return ve(R,1),R.end()}function i(T,B){var S=B||{};if(+S.codepage>=0&&wo(+S.codepage),S.type=="string")throw new Error("Cannot write WK3 to JS string");var R=xr();ve(R,0,a(T));for(var W=0,Y=0;W<T.SheetNames.length;++W)(T.Sheets[T.SheetNames[W]]||{})["!ref"]&&ve(R,27,ae(T.SheetNames[W],Y++));var re=0;for(W=0;W<T.SheetNames.length;++W){var te=T.Sheets[T.SheetNames[W]];if(!(!te||!te["!ref"])){for(var he=st(te["!ref"]),He=Array.isArray(te),Le=[],vt=Math.min(he.e.r,8191),We=he.s.r;We<=vt;++We)for(var N=Ht(We),K=he.s.c;K<=he.e.c;++K){We===he.s.r&&(Le[K]=Zt(K));var H=Le[K]+N,J=He?(te[We]||[])[K]:te[H];if(!(!J||J.t=="z"))if(J.t=="n")ve(R,23,z(We,K,re,J.v));else{var ne=On(J);ve(R,22,k(We,K,re,ne.slice(0,239)))}}++re}}return ve(R,1),R.end()}function s(T){var B=se(2);return B.write_shift(2,T),B}function a(T){var B=se(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var S=0,R=0,W=0,Y=0;Y<T.SheetNames.length;++Y){var re=T.SheetNames[Y],te=T.Sheets[re];if(!(!te||!te["!ref"])){++W;var he=Or(te["!ref"]);S<he.e.r&&(S=he.e.r),R<he.e.c&&(R=he.e.c)}}return S>8191&&(S=8191),B.write_shift(2,S),B.write_shift(1,W),B.write_shift(1,R),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function l(T,B,S){var R={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&S.qpro?(R.s.c=T.read_shift(1),T.l++,R.s.r=T.read_shift(2),R.e.c=T.read_shift(1),T.l++,R.e.r=T.read_shift(2),R):(R.s.c=T.read_shift(2),R.s.r=T.read_shift(2),B==12&&S.qpro&&(T.l+=2),R.e.c=T.read_shift(2),R.e.r=T.read_shift(2),B==12&&S.qpro&&(T.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(T){var B=se(8);return B.write_shift(2,T.s.c),B.write_shift(2,T.s.r),B.write_shift(2,T.e.c),B.write_shift(2,T.e.r),B}function u(T,B,S){var R=[{c:0,r:0},{t:"n",v:0},0,0];return S.qpro&&S.vers!=20768?(R[0].c=T.read_shift(1),R[3]=T.read_shift(1),R[0].r=T.read_shift(2),T.l+=2):(R[2]=T.read_shift(1),R[0].c=T.read_shift(2),R[0].r=T.read_shift(2)),R}function d(T,B,S){var R=T.l+B,W=u(T,B,S);if(W[1].t="s",S.vers==20768){T.l++;var Y=T.read_shift(1);return W[1].v=T.read_shift(Y,"utf8"),W}return S.qpro&&T.l++,W[1].v=T.read_shift(R-T.l,"cstr"),W}function h(T,B,S){var R=se(7+S.length);R.write_shift(1,255),R.write_shift(2,B),R.write_shift(2,T),R.write_shift(1,39);for(var W=0;W<R.length;++W){var Y=S.charCodeAt(W);R.write_shift(1,Y>=128?95:Y)}return R.write_shift(1,0),R}function p(T,B,S){var R=u(T,B,S);return R[1].v=T.read_shift(2,"i"),R}function m(T,B,S){var R=se(7);return R.write_shift(1,255),R.write_shift(2,B),R.write_shift(2,T),R.write_shift(2,S,"i"),R}function y(T,B,S){var R=u(T,B,S);return R[1].v=T.read_shift(8,"f"),R}function f(T,B,S){var R=se(13);return R.write_shift(1,255),R.write_shift(2,B),R.write_shift(2,T),R.write_shift(8,S,"f"),R}function g(T,B,S){var R=T.l+B,W=u(T,B,S);if(W[1].v=T.read_shift(8,"f"),S.qpro)T.l=R;else{var Y=T.read_shift(2);E(T.slice(T.l,T.l+Y),W),T.l+=Y}return W}function v(T,B,S){var R=B&32768;return B&=-32769,B=(R?T:0)+(B>=8192?B-16384:B),(R?"":"$")+(S?Zt(B):Ht(B))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(T,B){Er(T,0);for(var S=[],R=0,W="",Y="",re="",te="";T.l<T.length;){var he=T[T.l++];switch(he){case 0:S.push(T.read_shift(8,"f"));break;case 1:Y=v(B[0].c,T.read_shift(2),!0),W=v(B[0].r,T.read_shift(2),!1),S.push(Y+W);break;case 2:{var He=v(B[0].c,T.read_shift(2),!0),Le=v(B[0].r,T.read_shift(2),!1);Y=v(B[0].c,T.read_shift(2),!0),W=v(B[0].r,T.read_shift(2),!1),S.push(He+Le+":"+Y+W)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:S.push("("+S.pop()+")");break;case 5:S.push(T.read_shift(2));break;case 6:{for(var vt="";he=T[T.l++];)vt+=String.fromCharCode(he);S.push('"'+vt.replace(/"/g,'""')+'"')}break;case 8:S.push("-"+S.pop());break;case 23:S.push("+"+S.pop());break;case 22:S.push("NOT("+S.pop()+")");break;case 20:case 21:te=S.pop(),re=S.pop(),S.push(["AND","OR"][he-20]+"("+re+","+te+")");break;default:if(he<32&&w[he])te=S.pop(),re=S.pop(),S.push(re+w[he]+te);else if(x[he]){if(R=x[he][1],R==69&&(R=T[T.l++]),R>S.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+S.join("|")+"|");return}var We=S.slice(-R);S.length-=R,S.push(x[he][0]+"("+We.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}S.length==1?B[1].f=""+S[0]:console.error("WK1 bad formula parse |"+S.join("|")+"|")}function C(T){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=T.read_shift(2),B[3]=T[T.l++],B[0].c=T[T.l++],B}function A(T,B){var S=C(T);return S[1].t="s",S[1].v=T.read_shift(B-4,"cstr"),S}function k(T,B,S,R){var W=se(6+R.length);W.write_shift(2,T),W.write_shift(1,S),W.write_shift(1,B),W.write_shift(1,39);for(var Y=0;Y<R.length;++Y){var re=R.charCodeAt(Y);W.write_shift(1,re>=128?95:re)}return W.write_shift(1,0),W}function O(T,B){var S=C(T);S[1].v=T.read_shift(2);var R=S[1].v>>1;if(S[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return S[1].v=R,S}function U(T,B){var S=C(T),R=T.read_shift(4),W=T.read_shift(4),Y=T.read_shift(2);if(Y==65535)return R===0&&W===3221225472?(S[1].t="e",S[1].v=15):R===0&&W===3489660928?(S[1].t="e",S[1].v=42):S[1].v=0,S;var re=Y&32768;return Y=(Y&32767)-16446,S[1].v=(1-re*2)*(W*Math.pow(2,Y+32)+R*Math.pow(2,Y)),S}function z(T,B,S,R){var W=se(14);if(W.write_shift(2,T),W.write_shift(1,S),W.write_shift(1,B),R==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var Y=0,re=0,te=0,he=0;return R<0&&(Y=1,R=-R),re=Math.log2(R)|0,R/=Math.pow(2,re-31),he=R>>>0,he&2147483648||(R/=2,++re,he=R>>>0),R-=he,he|=2147483648,he>>>=0,R*=Math.pow(2,32),te=R>>>0,W.write_shift(4,te),W.write_shift(4,he),re+=16383+(Y?32768:0),W.write_shift(2,re),W}function V(T,B){var S=U(T);return T.l+=B-14,S}function G(T,B){var S=C(T),R=T.read_shift(4);return S[1].v=R>>6,S}function ie(T,B){var S=C(T),R=T.read_shift(8,"f");return S[1].v=R,S}function le(T,B){var S=ie(T);return T.l+=B-10,S}function xe(T,B){return T[T.l+B-1]==0?T.read_shift(B,"cstr"):""}function Be(T,B){var S=T[T.l++];S>B-1&&(S=B-1);for(var R="";R.length<S;)R+=String.fromCharCode(T[T.l++]);return R}function Ne(T,B,S){if(!(!S.qpro||B<21)){var R=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var W=T.read_shift(B-21,"cstr");return[R,W]}}function F(T,B){for(var S={},R=T.l+B;T.l<R;){var W=T.read_shift(2);if(W==14e3){for(S[W]=[0,""],S[W][0]=T.read_shift(2);T[T.l];)S[W][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return S}function ae(T,B){var S=se(5+T.length);S.write_shift(2,14e3),S.write_shift(2,B);for(var R=0;R<T.length;++R){var W=T.charCodeAt(R);S[S.l++]=W>127?95:W}return S[S.l++]=0,S}var _={0:{n:"BOF",f:Nw},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Be},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:F},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),QN=/^\s|\s$|[\t\n\r]/;function Dw(e,t){if(!t.bookSST)return"";var r=[At];r[r.length]=ge("sst",null,{xmlns:aa[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(QN)&&(s+=' xml:space="preserve"'),s+=">"+Xe(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ZN(e){return[e.read_shift(4),e.read_shift(4)]}function eb(e,t){return t||(t=se(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tb=V4;function rb(e){var t=xr();ce(t,159,eb(e));for(var r=0;r<e.length;++r)ce(t,19,tb(e[r]));return ce(t,160),t.end()}function nb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Fw(e){var t=0,r,n=nb(e),i=n.length+1,s,a,l,c,u;for(r=Wi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^a;return t^52811}var ib=function(){function e(i,s){switch(s.type){case"base64":return t(bn(i),s);case"binary":return t(i,s);case"buffer":return t(Ge&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),s);case"array":return t(fu(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},l=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(l)&&(l[h]=[]);for(var p=/\\\w+\b/g,m=0,y,f=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var g=d.slice(m,p.lastIndex-y[0].length);if(g[0]==" "&&(g=g.slice(1)),++f,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[h][f]=v:l[qe({r:h,c:f})]=v}break}m=p.lastIndex}f>u.e.c&&(u.e.c=f)}),l["!ref"]=jt(u),l}function r(i,s){return Ki(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=st(i["!ref"]),l,c=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=qe({r:u,c:d});l=c?(i[u]||[])[d]:i[h],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(On(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Ig(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var sb=6,kn=sb;function Dc(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function Fc(e){return Math.floor((e-5)/kn*100+.5)/100}function Gh(e){return Math.round((e*kn+5)/kn*256)/256}function w0(e){e.width?(e.wpx=Dc(e.width),e.wch=Fc(e.wpx),e.MDW=kn):e.wpx?(e.wch=Fc(e.wpx),e.width=Gh(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=Gh(e.wch),e.wpx=Dc(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var ab=96,Lw=ab;function Lc(e){return e*96/Lw}function Mw(e){return e*Lw/96}function ob(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ge("numFmt",null,{numFmtId:n,formatCode:Xe(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function lb(e){var t=[];return t[t.length]=ge("cellXfs",null),e.forEach(function(r){t[t.length]=ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Bw(e,t){var r=[At,ge("styleSheet",null,{xmlns:aa[0],"xmlns:vt":Rt.vt})],n;return e.SSF&&(n=ob(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lb(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function cb(e,t){var r=e.read_shift(2),n=er(e);return[r,n]}function ub(e,t,r){r||(r=se(6+4*t.length)),r.write_shift(2,e),Ft(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function db(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Q4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=q4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=er(e),n}function hb(e,t){t||(t=se(25+4*32)),t.write_shift(2,e.sz*20),Z4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Pc(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ft(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],yd,pb=pn;function Pg(e,t){t||(t=se(4*3+8*7+16*1)),yd||(yd=l0(fb));var r=yd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Pc({auto:1},t),Pc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function mb(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Uw(e,t,r){r||(r=se(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ka(e,t){return t||(t=se(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var gb=pn;function xb(e,t){return t||(t=se(51)),t.write_shift(1,0),ka(null,t),ka(null,t),ka(null,t),ka(null,t),ka(null,t),t.length>t.l?t.slice(0,t.l):t}function vb(e,t){return t||(t=se(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ic(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function yb(e,t,r){var n=se(2052);return n.write_shift(4,e),Ic(t,n),Ic(r,n),n.length>n.l?n.slice(0,n.l):n}function wb(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(ce(e,615,sn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ce(e,44,ub(i,t[i]))}),ce(e,616))}}function _b(e){var t=1;ce(e,611,sn(t)),ce(e,43,hb({sz:12,color:{theme:1},name:"Calibri",family:2})),ce(e,612)}function Sb(e){var t=2;ce(e,603,sn(t)),ce(e,45,Pg({patternType:"none"})),ce(e,45,Pg({patternType:"gray125"})),ce(e,604)}function Eb(e){var t=1;ce(e,613,sn(t)),ce(e,46,xb()),ce(e,614)}function Tb(e){var t=1;ce(e,626,sn(t)),ce(e,47,Uw({numFmtId:0},65535)),ce(e,627)}function kb(e,t){ce(e,617,sn(t.length)),t.forEach(function(r){ce(e,47,Uw(r,0))}),ce(e,618)}function jb(e){var t=1;ce(e,619,sn(t)),ce(e,48,vb({xfId:0,name:"Normal"})),ce(e,620)}function Ab(e){var t=0;ce(e,505,sn(t)),ce(e,506)}function Cb(e){var t=0;ce(e,508,yb(t,"TableStyleMedium9","PivotStyleMedium4")),ce(e,509)}function Nb(e,t){var r=xr();return ce(r,278),wb(r,e.SSF),_b(r),Sb(r),Eb(r),Tb(r),kb(r,t.cellXfs),jb(r),Ab(r),Cb(r),ce(r,279),r.end()}function $w(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[At];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function bb(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:er(e)}}function Ob(e){var t=se(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ft(e.name,t),t.slice(0,t.l)}function Ib(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Pb(e){var t=se(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Rb(e,t){var r=se(8+2*t.length);return r.write_shift(4,e),Ft(t,r),r.slice(0,r.l)}function Db(e){return e.l+=4,e.read_shift(4)!=0}function Fb(e,t){var r=se(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Lb(){var e=xr();return ce(e,332),ce(e,334,sn(1)),ce(e,335,Ob({name:"XLDAPR",version:12e4,flags:3496657072})),ce(e,336),ce(e,339,Rb(1,"XLDAPR")),ce(e,52),ce(e,35,sn(514)),ce(e,4096,sn(0)),ce(e,4097,Fr(1)),ce(e,36),ce(e,53),ce(e,340),ce(e,337,Fb(1)),ce(e,51,Pb([[1,0]])),ce(e,338),ce(e,333),e.end()}function Ww(){var e=[At];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Mb(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ns=1024;function zw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ge("xml",null,{"xmlns:v":Tr.v,"xmlns:o":Tr.o,"xmlns:x":Tr.x,"xmlns:mv":Tr.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ns<e*1e3;)Ns+=1e3;return t.forEach(function(s){var a=Dt(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ge("v:fill",c,l),d={on:"t",obscured:"t"};++Ns,i=i.concat(["<v:shape"+To({id:"_x0000_s"+Ns,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ge("v:shadow",null,d),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Wt("x:AutoFill","False"),Wt("x:Row",String(a.r)),Wt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Hw(e){var t=[At,ge("comments",null,{xmlns:aa[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Xe(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Xe(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Wt("t",Xe(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)a+=`Reply:
    `+s[l]+`
`;t.push(Wt("t",Xe(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Bb(e,t,r){var n=[At,ge("ThreadedComments",null,{xmlns:Rt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(ge("threadedComment",Wt("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Ub(e){var t=[At,ge("personList",null,{xmlns:Rt.TCMNT,"xmlns:x":aa[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $b(e){var t={};t.iauthor=e.read_shift(4);var r=qi(e);return t.rfx=r.s,t.ref=qe(r.s),e.l+=16,t}function Wb(e,t){return t==null&&(t=se(36)),t.write_shift(4,e[1].iauthor),la(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zb=er;function Hb(e){return Ft(e.slice(0,54))}function Vb(e){var t=xr(),r=[];return ce(t,628),ce(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ce(t,632,Hb(i.a)))})}),ce(t,631),ce(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Dt(n[0]),e:Dt(n[0])};ce(t,635,Wb([s,i])),i.t&&i.t.length>0&&ce(t,637,K4(i)),ce(t,636),delete i.iauthor})}),ce(t,634),ce(t,629),t.end()}function Gb(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Qe.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Vw=["xlsb","xlsm","xlam","biff8","xla"],Kb=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,i+(l?"":"$")+Zt(d)+(c?"":"$")+Ht(u)}return function(i,s){return t=s,i.replace(e,r)}}(),_0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,S0=function(){return function(t,r){return t.replace(_0,function(n,i,s,a,l,c){var u=m0(a)-(s?0:r.c),d=p0(c)-(l?0:r.r),h=d==0?"":l?d+1:"["+d+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+p})}}();function Jb(e,t){return e.replace(_0,function(r,n,i,s,a,l){return n+(i=="$"?i+s:Zt(m0(s)+t.c))+(a=="$"?a+l:Ht(p0(l)+t.r))})}function Xb(e){return e.length!=1}function Et(e){e.l+=1}function ci(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Gw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Kw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=ci(e),l=ci(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Kw(e){var t=ci(e),r=ci(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Yb(e,t,r){if(r.biff<8)return Kw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ci(e),a=ci(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Jw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return qb(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ci(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function qb(e){var t=ci(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Qb(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Zb(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return eO(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:l}}function eO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function tO(e,t,r){var n=(e[e.l++]&96)>>5,i=Gw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function rO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Gw(e,s,r);return[n,i,a]}function nO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function iO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function sO(e,t,r){var n=(e[e.l++]&96)>>5,i=Yb(e,t-1,r);return[n,i]}function aO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Rg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function oO(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function lO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function uO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Xw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function hO(e){return e.read_shift(2),Xw(e)}function fO(e){return e.read_shift(2),Xw(e)}function pO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Jw(e,0,r);return[n,i]}function mO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Zb(e,0,r);return[n,i]}function gO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Jw(e,0,r);return[n,i,s]}function xO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[x3[i],Qw[i],n]}function vO(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:yO(e);return[i,(s[0]===0?Qw:g3)[s[1]]]}function yO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function wO(e,t,r){e.l+=r&&r.biff==2?3:4}function _O(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function SO(e){return e.l++,Mo[e.read_shift(1)]}function EO(e){return e.l++,e.read_shift(2)}function TO(e){return e.l++,e.read_shift(1)!==0}function kO(e){return e.l++,ca(e)}function jO(e,t,r){return e.l++,Ow(e,t-1,r)}function AO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gN(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ca(e);break;case 2:r[1]=wN(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function CO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?qi:EN)(e));return i}function NO(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var l=0;l!=i;++l)a[s][l]=AO(e,r.biff);return a}function bO(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function OO(e,t,r){if(r.biff==5)return IO(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function IO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function PO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function RO(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function DO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function FO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var LO=pn,MO=pn,BO=pn;function Bo(e,t,r){return e.l+=2,[Qb(e)]}function E0(e){return e.l+=6,[]}var UO=Bo,$O=E0,WO=E0,zO=Bo;function Yw(e){return e.l+=2,[Nw(e),e.read_shift(2)&1]}var HO=Bo,VO=Yw,GO=E0,KO=Bo,JO=Bo,XO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function YO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=XO[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function qO(e){return e.l+=2,[e.read_shift(4)]}function QO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ZO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function e3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function r3(e){return e.l+=4,[0,0]}var Dg={1:{n:"PtgExp",f:_O},2:{n:"PtgTbl",f:BO},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:jO},26:{n:"PtgSheet",f:QO},27:{n:"PtgEndSheet",f:ZO},28:{n:"PtgErr",f:SO},29:{n:"PtgBool",f:TO},30:{n:"PtgInt",f:EO},31:{n:"PtgNum",f:kO},32:{n:"PtgArray",f:aO},33:{n:"PtgFunc",f:xO},34:{n:"PtgFuncVar",f:vO},35:{n:"PtgName",f:bO},36:{n:"PtgRef",f:pO},37:{n:"PtgArea",f:tO},38:{n:"PtgMemArea",f:PO},39:{n:"PtgMemErr",f:LO},40:{n:"PtgMemNoMem",f:MO},41:{n:"PtgMemFunc",f:RO},42:{n:"PtgRefErr",f:DO},43:{n:"PtgAreaErr",f:nO},44:{n:"PtgRefN",f:mO},45:{n:"PtgAreaN",f:sO},46:{n:"PtgMemAreaN",f:e3},47:{n:"PtgMemNoMemN",f:t3},57:{n:"PtgNameX",f:OO},58:{n:"PtgRef3d",f:gO},59:{n:"PtgArea3d",f:rO},60:{n:"PtgRefErr3d",f:FO},61:{n:"PtgAreaErr3d",f:iO},255:{}},n3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},i3={1:{n:"PtgElfLel",f:Yw},2:{n:"PtgElfRw",f:KO},3:{n:"PtgElfCol",f:UO},6:{n:"PtgElfRwV",f:JO},7:{n:"PtgElfColV",f:zO},10:{n:"PtgElfRadical",f:HO},11:{n:"PtgElfRadicalS",f:GO},13:{n:"PtgElfColS",f:$O},15:{n:"PtgElfColSV",f:WO},16:{n:"PtgElfRadicalLel",f:VO},25:{n:"PtgList",f:YO},29:{n:"PtgSxName",f:qO},255:{}},s3={0:{n:"PtgAttrNoop",f:r3},1:{n:"PtgAttrSemi",f:dO},2:{n:"PtgAttrIf",f:cO},4:{n:"PtgAttrChoose",f:oO},8:{n:"PtgAttrGoto",f:lO},16:{n:"PtgAttrSum",f:wO},32:{n:"PtgAttrBaxcel",f:Rg},33:{n:"PtgAttrBaxcel",f:Rg},64:{n:"PtgAttrSpace",f:hO},65:{n:"PtgAttrSpaceSemi",f:fO},128:{n:"PtgAttrIfError",f:uO},255:{}};function a3(e,t,r,n){if(n.biff<8)return pn(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=NO(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=CO(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(pn(e,t)),s}function o3(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Dg[s]||Dg[n3[s]],(s===24||s===25)&&(i=(s===24?i3:s3)[e[e.l+1]]),!i||!i.f?pn(e,t):a.push([i.n,i.f(e,t,r)]);return a}function l3(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var c3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function u3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function qw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Fg(e,t,r){var n=qw(e,t,r);return n=="#REF"?n:u3(n,r)}function Xs(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},l=[],c,u,d,h=0,p=0,m,y="";if(!e[0]||!e[0][0])return"";for(var f=-1,g="",v=0,x=e[0].length;v<x;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),f>=0){switch(e[0][f][1][0]){case 0:g=gt(" ",e[0][f][1][1]);break;case 1:g=gt("\r",e[0][f][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}u=u+g,f=-1}l.push(u+c3[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ja(w[1][1],a,i),l.push(Xa(d,s));break;case"PtgRefN":d=r?Ja(w[1][1],r,i):w[1][1],l.push(Xa(d,s));break;case"PtgRef3d":h=w[1][1],d=Ja(w[1][2],a,i),y=Fg(n,h,i),l.push(y+"!"+Xa(d,s));break;case"PtgFunc":case"PtgFuncVar":var E=w[1][0],C=w[1][1];E||(E=0),E&=127;var A=E==0?[]:l.slice(-E);l.length-=E,C==="User"&&(C=A.shift()),l.push(C+"("+A.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":m=wg(w[1][1],r?{s:r}:a,i),l.push(xd(m,i));break;case"PtgArea":m=wg(w[1][1],a,i),l.push(xd(m,i));break;case"PtgArea3d":h=w[1][1],m=w[1][2],y=Fg(n,h,i),l.push(y+"!"+xd(m,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var k=(n.names||[])[p-1]||(n[0]||[])[p],O=k?k.Name:"SH33TJSNAME"+String(p);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),l.push(O);break;case"PtgNameX":var U=w[1][1];p=w[1][2];var z;if(i.biff<=5)U<0&&(U=-U),n[U]&&(z=n[U][p]);else{var V="";if(((n[U]||[])[0]||[])[0]==14849||(((n[U]||[])[0]||[])[0]==1025?n[U][p]&&n[U][p].itab>0&&(V=n.SheetNames[n[U][p].itab-1]+"!"):V=n.SheetNames[p-1]+"!"),n[U]&&n[U][p])V+=n[U][p].Name;else if(n[0]&&n[0][p])V+=n[0][p].Name;else{var G=(qw(n,U,i)||"").split(";;");G[p-1]?V=G[p-1]:V+="SH33TJSERRX"}l.push(V);break}z||(z={Name:"SH33TJSERRY"}),l.push(z.Name);break;case"PtgParen":var ie="(",le=")";if(f>=0){switch(g="",e[0][f][1][0]){case 2:ie=gt(" ",e[0][f][1][1])+ie;break;case 3:ie=gt("\r",e[0][f][1][1])+ie;break;case 4:le=gt(" ",e[0][f][1][1])+le;break;case 5:le=gt("\r",e[0][f][1][1])+le;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}l.push(ie+l.pop()+le);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var xe={c:r.c,r:r.r};if(n.sharedf[qe(d)]){var Be=n.sharedf[qe(d)];l.push(Xs(Be,a,xe,n,i))}else{var Ne=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Xs(u[1],a,xe,n,i)),Ne=!0;break}Ne||l.push(w[1])}break;case"PtgArray":l.push("{"+l3(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var F=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&f>=0&&F.indexOf(e[0][v][0])==-1){w=e[0][f];var ae=!0;switch(w[1][0]){case 4:ae=!1;case 0:g=gt(" ",w[1][1]);break;case 5:ae=!1;case 1:g=gt("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((ae?g:"")+l.pop()+(ae?"":g)),f=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function d3(e){if(e==null){var t=se(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return zi(e);return zi(0)}function h3(e,t,r,n,i){var s=Hi(t,r,i),a=d3(e.v),l=se(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=se(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=$t([s,a,l,u]);return h}function pu(e,t,r){var n=e.read_shift(4),i=o3(e,n,r),s=e.read_shift(4),a=s>0?a3(e,s,i,r):null;return[i,a]}var f3=pu,mu=pu,p3=pu,m3=pu,g3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},x3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v3(e){var t="of:="+e.replace(_0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function y3(e){return e.replace(/\./,"!")}var Ya=typeof Map<"u";function T0(e,t,r){var n=0,i=e.length;if(r){if(Ya?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ya?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Ya?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function gu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(kn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Fc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Gh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Zw(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Jy(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function w3(e,t,r){if(e&&e["!ref"]){var n=st(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function _3(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+jt(e[r])+'"/>';return t+"</mergeCells>"}function S3(e,t,r,n,i){var s=!1,a={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=Eo(Xe(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ge("outlinePr",null,u)}!s&&!l||(i[i.length]=ge("sheetPr",l,a))}var E3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],T3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function k3(e){var t={sheet:1};return E3.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),T3.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Fw(e.password).toString(16).toUpperCase()),ge("sheetProtection",null,t)}function j3(e){return Zw(e),ge("pageMargins",null,e)}function A3(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ge("col",null,gu(i,n)));return r[r.length]="</cols>",r.join("")}function C3(e,t,r,n){var i=typeof e.ref=="string"?e.ref:jt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Or(i);a.s.r==a.e.r&&(a.e.r=Or(t["!ref"]).e.r,i=jt(a));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ge("autoFilter",null,{ref:i})}function N3(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,i),{})}function b3(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Mo[e.v];break;case"d":n&&n.cellDates?i=cr(e.v,-1).toISOString():(e=yr(e),e.t="n",i=""+(e.v=vr(cr(e.v)))),typeof e.z>"u"&&(e.z=xt[14]);break;default:i=e.v;break}var l=Wt("v",Xe(i)),c={r:t},u=xi(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Wt("v",""+T0(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ge("f",Xe(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ge("c",l,c)}function O3(e,t,r,n){var i=[],s=[],a=st(e["!ref"]),l="",c,u="",d=[],h=0,p=0,m=e["!rows"],y=Array.isArray(e),f={r:u},g,v=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Zt(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=Ht(h),p=a.s.c;p<=a.e.c;++p){c=d[p]+u;var x=y?(e[h]||[])[p]:e[c];x!==void 0&&(l=b3(x,c,e,t))!=null&&s.push(l)}(s.length>0||m&&m[h])&&(f={r:u},m&&m[h]&&(g=m[h],g.hidden&&(f.hidden=1),v=-1,g.hpx?v=Lc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(f.ht=v,f.customHeight=1),g.level&&(f.outlineLevel=g.level)),i[i.length]=ge("row",s.join(""),f))}if(m)for(;h<m.length;++h)m&&m[h]&&(f={r:h+1},g=m[h],g.hidden&&(f.hidden=1),v=-1,g.hpx?v=Lc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(f.ht=v,f.customHeight=1),g.level&&(f.outlineLevel=g.level),i[i.length]=ge("row","",f));return i.join("")}function e_(e,t,r,n){var i=[At,ge("worksheet",null,{xmlns:aa[0],"xmlns:r":Rt.r})],s=r.SheetNames[e],a=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=st(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=jt(d)}n||(n={}),c["!comments"]=[];var h=[];S3(c,r,e,t,i),i[i.length]=ge("dimension",null,{ref:u}),i[i.length]=N3(c,t,e,r),t.sheetFormat&&(i[i.length]=ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=A3(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=O3(c,t),l.length>0&&(i[i.length]=l)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=k3(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=C3(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=_3(c["!merges"]));var p=-1,m,y=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(f){f[1].Target&&(m={ref:f[0]},f[1].Target.charAt(0)!="#"&&(y=Je(n,-1,Xe(f[1].Target).replace(/#.*$/,""),Ve.HLINK),m["r:id"]="rId"+y),(p=f[1].Target.indexOf("#"))>-1&&(m.location=Xe(f[1].Target.slice(p+1))),f[1].Tooltip&&(m.tooltip=Xe(f[1].Tooltip)),i[i.length]=ge("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=j3(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Wt("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(y=Je(n,-1,"../drawings/drawing"+(e+1)+".xml",Ve.DRAW),i[i.length]=ge("drawing",null,{"r:id":"rId"+y}),c["!drawing"]=h),c["!comments"].length>0&&(y=Je(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ve.VML),i[i.length]=ge("legacyDrawing",null,{"r:id":"rId"+y}),c["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function I3(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function P3(e,t,r){var n=se(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Lc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,p=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[qe(u)];y&&(h<0&&(h=m),p=m)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,p))}var f=n.l;return n.l=c,n.write_shift(4,l),n.l=f,n.length>n.l?n.slice(0,n.l):n}function R3(e,t,r,n){var i=P3(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&ce(e,0,i)}var D3=qi,F3=la;function L3(){}function M3(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=J4(e),r}function B3(e,t,r){r==null&&(r=se(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Pc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),mw(e,r),r.slice(0,r.l)}function U3(e){var t=Hr(e);return[t]}function $3(e,t,r){return r==null&&(r=se(8)),Ji(t,r)}function W3(e){var t=Xi(e);return[t]}function z3(e,t,r){return r==null&&(r=se(4)),Yi(t,r)}function H3(e){var t=Hr(e),r=e.read_shift(1);return[t,r,"b"]}function V3(e,t,r){return r==null&&(r=se(9)),Ji(t,r),r.write_shift(1,e.v?1:0),r}function G3(e){var t=Xi(e),r=e.read_shift(1);return[t,r,"b"]}function K3(e,t,r){return r==null&&(r=se(5)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function J3(e){var t=Hr(e),r=e.read_shift(1);return[t,r,"e"]}function X3(e,t,r){return r==null&&(r=se(9)),Ji(t,r),r.write_shift(1,e.v),r}function Y3(e){var t=Xi(e),r=e.read_shift(1);return[t,r,"e"]}function q3(e,t,r){return r==null&&(r=se(8)),Yi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Q3(e){var t=Hr(e),r=e.read_shift(4);return[t,r,"s"]}function Z3(e,t,r){return r==null&&(r=se(12)),Ji(t,r),r.write_shift(4,t.v),r}function eI(e){var t=Xi(e),r=e.read_shift(4);return[t,r,"s"]}function tI(e,t,r){return r==null&&(r=se(8)),Yi(t,r),r.write_shift(4,t.v),r}function rI(e){var t=Hr(e),r=ca(e);return[t,r,"n"]}function nI(e,t,r){return r==null&&(r=se(16)),Ji(t,r),zi(e.v,r),r}function iI(e){var t=Xi(e),r=ca(e);return[t,r,"n"]}function sI(e,t,r){return r==null&&(r=se(12)),Yi(t,r),zi(e.v,r),r}function aI(e){var t=Hr(e),r=gw(e);return[t,r,"n"]}function oI(e,t,r){return r==null&&(r=se(12)),Ji(t,r),xw(e.v,r),r}function lI(e){var t=Xi(e),r=gw(e);return[t,r,"n"]}function cI(e,t,r){return r==null&&(r=se(8)),Yi(t,r),xw(e.v,r),r}function uI(e){var t=Hr(e),r=g0(e);return[t,r,"is"]}function dI(e){var t=Hr(e),r=er(e);return[t,r,"str"]}function hI(e,t,r){return r==null&&(r=se(12+4*e.v.length)),Ji(t,r),Ft(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fI(e){var t=Xi(e),r=er(e);return[t,r,"str"]}function pI(e,t,r){return r==null&&(r=se(8+4*e.v.length)),Yi(t,r),Ft(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mI(e,t,r){var n=e.l+t,i=Hr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=mu(e,n-e.l,r);a[3]=Xs(l,null,i,r.supbooks,r)}else e.l=n;return a}function gI(e,t,r){var n=e.l+t,i=Hr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=mu(e,n-e.l,r);a[3]=Xs(l,null,i,r.supbooks,r)}else e.l=n;return a}function xI(e,t,r){var n=e.l+t,i=Hr(e);i.r=r["!row"];var s=ca(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=mu(e,n-e.l,r);a[3]=Xs(l,null,i,r.supbooks,r)}else e.l=n;return a}function vI(e,t,r){var n=e.l+t,i=Hr(e);i.r=r["!row"];var s=er(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=mu(e,n-e.l,r);a[3]=Xs(l,null,i,r.supbooks,r)}else e.l=n;return a}var yI=qi,wI=la;function _I(e,t){return t==null&&(t=se(4)),t.write_shift(4,e),t}function SI(e,t){var r=e.l+t,n=qi(e),i=x0(e),s=er(e),a=er(e),l=er(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return a&&(c.Tooltip=a),c}function EI(e,t){var r=se(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));la({s:Dt(e[0]),e:Dt(e[0])},r),v0("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Ft(i||"",r),Ft(e[1].Tooltip||"",r),Ft("",r),r.slice(0,r.l)}function TI(){}function kI(e,t,r){var n=e.l+t,i=vw(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var l=f3(e,n-e.l,r);a[1]=l}else e.l=n;return a}function jI(e,t,r){var n=e.l+t,i=qi(e),s=[i];if(r.cellFormula){var a=m3(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function AI(e,t,r){r==null&&(r=se(18));var n=gu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var t_=["left","right","top","bottom","header","footer"];function CI(e){var t={};return t_.forEach(function(r){t[r]=ca(e)}),t}function NI(e,t){return t==null&&(t=se(6*8)),Zw(e),t_.forEach(function(r){zi(e[r],t)}),t}function bI(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function OI(e,t,r){r==null&&(r=se(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function II(e){var t=se(24);return t.write_shift(4,4),t.write_shift(4,1),la(e,t),t}function PI(e,t){return t==null&&(t=se(16*4+2)),t.write_shift(2,e.password?Fw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RI(){}function DI(){}function FI(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=yr(t),t.z=t.z||xt[14],t.v=vr(cr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=xi(i.cellXfs,t,i),t.l&&s["!links"].push([qe(c),t.l]),t.c&&s["!comments"].push([qe(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=T0(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,a?ce(e,18,tI(t,c)):ce(e,7,Z3(t,c))):(c.t="str",a?ce(e,17,pI(t,c)):ce(e,6,hI(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?ce(e,13,cI(t,c)):ce(e,2,oI(t,c)):a?ce(e,16,sI(t,c)):ce(e,5,nI(t,c)),!0;case"b":return c.t="b",a?ce(e,15,K3(t,c)):ce(e,4,V3(t,c)),!0;case"e":return c.t="e",a?ce(e,14,q3(t,c)):ce(e,3,X3(t,c)),!0}return a?ce(e,12,z3(t,c)):ce(e,1,$3(t,c)),!0}function LI(e,t,r,n){var i=st(t["!ref"]||"A1"),s,a="",l=[];ce(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){a=Ht(d),R3(e,t,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(l[p]=Zt(p)),s=l[p]+a;var m=c?(t[d]||[])[p]:t[s];if(!m){h=!1;continue}h=FI(e,m,d,p,n,t,h)}}ce(e,146)}function MI(e,t){!t||!t["!merges"]||(ce(e,177,_I(t["!merges"].length)),t["!merges"].forEach(function(r){ce(e,176,wI(r))}),ce(e,178))}function BI(e,t){!t||!t["!cols"]||(ce(e,390),t["!cols"].forEach(function(r,n){r&&ce(e,60,AI(n,r))}),ce(e,391))}function UI(e,t){!t||!t["!ref"]||(ce(e,648),ce(e,649,II(st(t["!ref"]))),ce(e,650))}function $I(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Je(r,-1,n[1].Target.replace(/#.*$/,""),Ve.HLINK);ce(e,494,EI(n,i))}}),delete t["!links"]}function WI(e,t,r,n){if(t["!comments"].length>0){var i=Je(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ve.VML);ce(e,551,v0("rId"+i)),t["!legacy"]=i}}function zI(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:jt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,l=Or(s);l.s.r==l.e.r&&(l.e.r=Or(t["!ref"]).e.r,s=jt(l));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ce(e,161,la(st(s))),ce(e,162)}}function HI(e,t,r){ce(e,133),ce(e,137,OI(t,r)),ce(e,138),ce(e,134)}function VI(e,t){t["!protect"]&&ce(e,535,PI(t["!protect"]))}function GI(e,t,r,n){var i=xr(),s=r.SheetNames[e],a=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=st(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ce(i,129),(r.vbaraw||a["!outline"])&&ce(i,147,B3(l,a["!outline"])),ce(i,148,F3(c)),HI(i,a,r.Workbook),BI(i,a),LI(i,a,e,t),VI(i,a),zI(i,a,r,e),MI(i,a),$I(i,a,n),a["!margins"]&&ce(i,476,NI(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&UI(i,a),WI(i,a,e,n),ce(i,130),i.end()}function KI(e,t){e.l+=10;var r=er(e);return{name:r}}var JI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function XI(e){return!e.Workbook||!e.Workbook.WBProps?"false":j4(e.Workbook.WBProps.date1904)?"true":"false"}var YI="][*?/\\".split("");function r_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return YI.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function qI(e,t,r){e.forEach(function(n,i){r_(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function QI(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];qI(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)w3(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function n_(e){var t=[At];t[t.length]=ge("workbook",null,{xmlns:aa[0],"xmlns:r":Rt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(JI.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ge("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Xe(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ge("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ge("definedName",Xe(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function ZI(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vh(e),r.name=er(e),r}function eP(e,t){return t||(t=se(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),v0(e.strRelID,t),Ft(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tP(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?er(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rP(e,t){t||(t=se(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),mw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nP(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=X4(e),a=p3(e,0,r),l=x0(e);e.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function iP(e,t){ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ce(e,156,eP(i))}ce(e,144)}function sP(e,t){t||(t=se(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ft("SheetJS",t),Ft(kc.version,t),Ft(kc.version,t),Ft("7262",t),t.length>t.l?t.slice(0,t.l):t}function aP(e,t){t||(t=se(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function oP(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ce(e,135),ce(e,158,aP(i)),ce(e,136))}}function lP(e,t){var r=xr();return ce(r,131),ce(r,128,sP()),ce(r,153,rP(e.Workbook&&e.Workbook.WBProps||null)),oP(r,e),iP(r,e),ce(r,132),r.end()}function cP(e,t,r){return(t.slice(-4)===".bin"?lP:n_)(e)}function uP(e,t,r,n,i){return(t.slice(-4)===".bin"?GI:e_)(e,r,n,i)}function dP(e,t,r){return(t.slice(-4)===".bin"?Nb:Bw)(e,r)}function hP(e,t,r){return(t.slice(-4)===".bin"?rb:Dw)(e,r)}function fP(e,t,r){return(t.slice(-4)===".bin"?Vb:Hw)(e)}function pP(e){return(e.slice(-4)===".bin"?Lb:Ww)()}function mP(e,t){var r=[];return e.Props&&r.push(dN(e.Props,t)),e.Custprops&&r.push(hN(e.Props,e.Custprops)),r.join("")}function gP(){return""}function xP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":Xe(xt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ge("Style",s.join(""),a))}),ge("Styles",r.join(""))}function i_(e){return ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+S0(e.Ref,{r:0,c:0})})}function vP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(i_(i)))}return ge("Names",r.join(""))}function yP(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var l=i[a];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(i_(l)))}return s.join("")}function wP(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ge("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Wt("ProtectContents","True")),e["!protect"].objects&&i.push(Wt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Wt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Wt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Wt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ge("WorksheetOptions",i.join(""),{xmlns:Tr.x})}function _P(e){return e.map(function(t){var r=k4(t.t||""),n=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",n,{"ss:Author":t.a})}).join("")}function SP(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Xe(S0(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var c=Dt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Xe(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Xe(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=a.c||u[d].s.r!=a.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=Mo[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xt[14]);break;case"s":h="String",p=T4(e.v||"");break}var m=xi(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=a.c+1;var y=e.v!=null?p:"",f=e.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(e.c||[]).length>0&&(f+=_P(e.c)),ge("Cell",f,l)}function EP(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Mw(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function TP(e,t,r,n){if(!e["!ref"])return"";var i=st(e["!ref"]),s=e["!merges"]||[],a=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){w0(g);var x=!!g.width,w=gu(v,g),E={"ss:Index":v+1};x&&(E["ss:Width"]=Dc(w.width)),g.hidden&&(E["ss:Hidden"]="1"),l.push(ge("Column",null,E))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[EP(u,(e["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(p=!0);break}if(!p){var m={r:u,c:h},y=qe(m),f=c?(e[u]||[])[h]:e[y];d.push(SP(f,y,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function kP(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?yP(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?TP(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(wP(s,t,e,r)),n.join("")}function jP(e,t){t||(t={}),e.SSF||(e.SSF=yr(xt)),e.SSF&&(du(),uu(e.SSF),t.revssf=hu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(mP(e,t)),r.push(gP()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ge("Worksheet",kP(n,t,e),{"ss:Name":Xe(e.SheetNames[n])}));return r[2]=xP(e,t),r[3]=vP(e),At+ge("Workbook",r.join(""),{xmlns:Tr.ss,"xmlns:o":Tr.o,"xmlns:x":Tr.x,"xmlns:ss":Tr.ss,"xmlns:dt":Tr.dt,"xmlns:html":Tr.html})}var wd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AP(e,t){var r=[],n=[],i=[],s=0,a,l=cg(Sg,"n"),c=cg(Eg,"n");if(e.Props)for(a=Gt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(l,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Gt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(l,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)Cw.indexOf(i[s][0])>-1||kw.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Qe.utils.cfb_add(t,"/SummaryInformation",Cg(n,wd.SI,c,Eg)),(r.length||u.length)&&Qe.utils.cfb_add(t,"/DocumentSummaryInformation",Cg(r,wd.DSI,l,Sg,u.length?u:null,wd.UDI))}function CP(e,t){var r=t||{},n=Qe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qe.utils.cfb_add(n,i,s_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&AP(e,n),r.biff==8&&e.vbaraw&&Gb(n,Qe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var NP={0:{f:I3},1:{f:U3},2:{f:aI},3:{f:J3},4:{f:H3},5:{f:rI},6:{f:dI},7:{f:Q3},8:{f:vI},9:{f:xI},10:{f:mI},11:{f:gI},12:{f:W3},13:{f:lI},14:{f:Y3},15:{f:G3},16:{f:iI},17:{f:fI},18:{f:eI},19:{f:g0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nP},40:{},42:{},43:{f:db},44:{f:cb},45:{f:pb},46:{f:gb},47:{f:mb},48:{},49:{f:W4},50:{},51:{f:Ib},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zN},62:{f:uI},63:{f:Mb},64:{f:RI},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M3},148:{f:D3,p:16},151:{f:TI},152:{},153:{f:tP},154:{},155:{},156:{f:ZI},157:{},158:{},159:{T:1,f:ZN},160:{T:-1},161:{T:1,f:qi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bb},336:{T:-1},337:{f:Db,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kI},427:{f:jI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CI},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:SI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zb},633:{T:1},634:{T:-1},635:{T:1,f:$b},636:{T:-1},637:{f:G4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KI},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:DI},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ve(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&f0(r)&&e.push(r)}}function bP(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ve(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],l=0,c=0,u=0;u+(a[l]||8224)<=8224;)u+=a[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(a[l]||8224)<=8224;)u+=a[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Uo(e,t,r){return e||(e=se(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function OP(e,t,r,n){var i=se(9);return Uo(i,e,t),bw(r,n||"b",i),i}function IP(e,t,r){var n=se(8+2*r.length);return Uo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function PP(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?vr(cr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ve(e,2,KN(r,n,i)):ve(e,3,GN(r,n,i));return;case"b":case"e":ve(e,5,OP(r,n,t.v,t.t));return;case"s":case"str":ve(e,4,IP(r,n,(t.v||"").slice(0,255)));return}ve(e,1,Uo(null,r,n))}function RP(e,t,r,n){var i=Array.isArray(t),s=st(t["!ref"]||"A1"),a,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=jt(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Ht(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Zt(d)),a=c[d]+l;var h=i?(t[u]||[])[d]:t[a];h&&PP(e,h,u,d)}}}function DP(e,t){for(var r=t||{},n=xr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ve(n,r.biff==4?1033:r.biff==3?521:9,y0(e,16,r)),RP(n,e.Sheets[e.SheetNames[i]],i,r),ve(n,10),n.end()}function FP(e,t,r){ve(e,49,NN({sz:12,name:"Arial"},r))}function LP(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ve(e,1054,IN(i,t[i],r))})}function MP(e,t){var r=se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ve(e,2151,r),r=se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Pw(st(t["!ref"]||"A1"),r),r.write_shift(4,4),ve(e,2152,r)}function BP(e,t){for(var r=0;r<16;++r)ve(e,224,bg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ve(e,224,bg(n,0,t))})}function UP(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ve(e,440,UN(n)),n[1].Tooltip&&ve(e,2048,$N(n))}delete t["!links"]}function $P(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ve(e,125,HN(gu(i,n),i))})}}function WP(e,t,r,n,i){var s=16+xi(i.cellXfs,t,i);if(t.v==null&&!t.bf){ve(e,513,Hi(r,n,s));return}if(t.bf)ve(e,6,h3(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?vr(cr(t.v)):t.v;ve(e,515,FN(r,n,a,s));break;case"b":case"e":ve(e,517,DN(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=T0(i.Strings,t.v,i.revStrings);ve(e,253,bN(r,n,l,s))}else ve(e,516,ON(r,n,(t.v||"").slice(0,255),s,i));break;default:ve(e,513,Hi(r,n,s))}}function zP(e,t,r){var n=xr(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},l=(a.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,h="",p=[],m=st(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}ve(n,2057,y0(r,16,t)),ve(n,13,Fr(1)),ve(n,12,Fr(100)),ve(n,15,ar(!0)),ve(n,17,ar(!1)),ve(n,16,zi(.001)),ve(n,95,ar(!0)),ve(n,42,ar(!1)),ve(n,43,ar(!1)),ve(n,130,Fr(1)),ve(n,128,RN()),ve(n,131,ar(!1)),ve(n,132,ar(!1)),u&&$P(n,s["!cols"]),ve(n,512,PN(m,t)),u&&(s["!links"]=[]);for(var f=m.s.r;f<=m.e.r;++f){h=Ht(f);for(var g=m.s.c;g<=m.e.c;++g){f===m.s.r&&(p[g]=Zt(g)),d=p[g]+h;var v=c?(s[f]||[])[g]:s[d];v&&(WP(n,v,f,g,t),u&&v.l&&s["!links"].push([d,v.l]))}}var x=l.CodeName||l.name||i;return u&&ve(n,574,CN((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&ve(n,229,BN(s["!merges"])),u&&UP(n,s),ve(n,442,Iw(x)),u&&MP(n,s),ve(n,10),n.end()}function HP(e,t,r){var n=xr(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(ve(n,2057,y0(e,5,r)),r.bookType=="xla"&&ve(n,135),ve(n,225,l?Fr(1200):null),ve(n,193,mN(2)),c&&ve(n,191),c&&ve(n,192),ve(n,226),ve(n,92,TN("SheetJS",r)),ve(n,66,Fr(l?1200:1252)),l&&ve(n,353,Fr(0)),l&&ve(n,448),ve(n,317,VN(e.SheetNames.length)),l&&e.vbaraw&&ve(n,211),l&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";ve(n,442,Iw(u))}ve(n,156,Fr(17)),ve(n,25,ar(!1)),ve(n,18,ar(!1)),ve(n,19,Fr(0)),l&&ve(n,431,ar(!1)),l&&ve(n,444,Fr(0)),ve(n,61,AN()),ve(n,64,ar(!1)),ve(n,141,Fr(0)),ve(n,34,ar(XI(e)=="true")),ve(n,14,ar(!0)),l&&ve(n,439,ar(!1)),ve(n,218,Fr(0)),FP(n,e,r),LP(n,e.SSF,r),BP(n,r),l&&ve(n,352,ar(!1));var d=n.end(),h=xr();l&&ve(h,140,WN()),l&&r.Strings&&bP(h,252,jN(r.Strings)),ve(h,10);var p=h.end(),m=xr(),y=0,f=0;for(f=0;f<e.SheetNames.length;++f)y+=(l?12:11)+(l?2:1)*e.SheetNames[f].length;var g=d.length+y+p.length;for(f=0;f<e.SheetNames.length;++f){var v=s[f]||{};ve(m,133,kN({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[f]},r)),g+=t[f].length}var x=m.end();if(y!=x.length)throw new Error("BS8 "+y+" != "+x.length);var w=[];return d.length&&w.push(d),x.length&&w.push(x),p.length&&w.push(p),$t(w)}function VP(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=yr(xt)),e&&e.SSF&&(du(),uu(e.SSF),r.revssf=hu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,k0(r),r.cellXfs=[],xi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=zP(i,r,e);return n.unshift(HP(e,n,r)),$t(n)}function s_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Or(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return VP(e,t);case 4:case 3:case 2:return DP(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function GP(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var d=qe({r,c:a}),h=n.dense?(e[r]||[])[a]:e[d],p=h&&h.v!=null&&(h.h||E4(h.w||(On(h),h.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+d,s.push(ge("td",p,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var KP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',JP="</body></html>";function XP(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function a_(e,t){var r=t||{},n=r.header!=null?r.header:KP,i=r.footer!=null?r.footer:JP,s=[n],a=Or(e["!ref"]);r.dense=Array.isArray(e),s.push(XP(e,a,r));for(var l=a.s.r;l<=a.e.r;++l)s.push(GP(e,a,l,r));return s.push("</table>"+i),s.join("")}function o_(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Dt(n.origin):n.origin;i=a.r,s=a.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Or(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var h=[],p=0,m=e["!rows"]||(e["!rows"]=[]),y=0,f=0,g=0,v=0,x=0,w=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&f<c;++y){var E=l[y];if(Lg(E)){if(n.display)continue;m[f]={hidden:!0}}var C=E.children;for(g=v=0;g<C.length;++g){var A=C[g];if(!(n.display&&Lg(A))){var k=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):A4(A.innerHTML),O=A.getAttribute("data-z")||A.getAttribute("z");for(p=0;p<h.length;++p){var U=h[p];U.s.c==v+s&&U.s.r<f+i&&f+i<=U.e.r&&(v=U.e.c+1-s,p=-1)}w=+A.getAttribute("colspan")||1,((x=+A.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:f+i,c:v+s},e:{r:f+i+(x||1)-1,c:v+s+(w||1)-1}});var z={t:"s",v:k},V=A.getAttribute("data-t")||A.getAttribute("t")||"";k!=null&&(k.length==0?z.t=V||"z":n.raw||k.trim().length==0||V=="s"||(k==="TRUE"?z={t:"b",v:!0}:k==="FALSE"?z={t:"b",v:!1}:isNaN(Tn(k))?isNaN(So(k).getDate())||(z={t:"d",v:cr(k)},n.cellDates||(z={t:"n",v:vr(z.v)}),z.z=n.dateNF||xt[14]):z={t:"n",v:Tn(k)})),z.z===void 0&&O!=null&&(z.z=O);var G="",ie=A.getElementsByTagName("A");if(ie&&ie.length)for(var le=0;le<ie.length&&!(ie[le].hasAttribute("href")&&(G=ie[le].getAttribute("href"),G.charAt(0)!="#"));++le);G&&G.charAt(0)!="#"&&(z.l={Target:G}),n.dense?(e[f+i]||(e[f+i]=[]),e[f+i][v+s]=z):e[qe({c:v+s,r:f+i})]=z,u.e.c<v+s&&(u.e.c=v+s),v+=w}}++f}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,f-1+i),e["!ref"]=jt(u),f>=c&&(e["!fullref"]=jt((u.e.r=l.length-y+f-1+i,u))),e}function l_(e,t){var r=t||{},n=r.dense?[]:{};return o_(n,e,t)}function YP(e,t){return Ki(l_(e,t),t)}function Lg(e){var t="",r=qP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function qP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var QP=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+To({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return At+t}}(),Mg=function(){var e=function(s){return Xe(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,l){var c=[];c.push('      <table:table table:name="'+Xe(a.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,h=Or(s["!ref"]||"A1"),p=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var f="",g=s["!rows"]||[];for(u=0;u<h.s.r;++u)f=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+f+`></table:table-row>
`);for(;u<=h.e.r;++u){for(f=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+f+`>
`),d=0;d<h.s.c;++d)c.push(t);for(;d<=h.e.c;++d){var v=!1,x={},w="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>u)&&!(p[m].e.c<d)&&!(p[m].e.r<u)){(p[m].s.c!=d||p[m].s.r!=u)&&(v=!0),x["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,x["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(v){c.push(r);continue}var E=qe({r:u,c:d}),C=y?(s[u]||[])[d]:s[E];if(C&&C.f&&(x["table:formula"]=Xe(v3(C.f)),C.F&&C.F.slice(0,E.length)==E)){var A=Or(C.F);x["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,x["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!C){c.push(t);continue}switch(C.t){case"b":w=C.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=C.v?"true":"false";break;case"n":w=C.w||String(C.v||0),x["office:value-type"]="float",x["office:value"]=C.v||0;break;case"s":case"str":w=C.v==null?"":C.v,x["office:value-type"]="string";break;case"d":w=C.w||cr(C.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=cr(C.v).toISOString(),x["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(w);if(C.l&&C.l.Target){var O=C.l.Target;O=O.charAt(0)=="#"?"#"+y3(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),k=ge("text:a",k,{"xlink:href":O.replace(/&/g,"&amp;")})}c.push("          "+ge("table:table-cell",ge("text:p",k,{}),x)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;w0(h),h.ods=l;var p=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var h=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,l){var c=[At],u=To({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=To({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Ew().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)c.push(n(a.Sheets[a.SheetNames[h]],a,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function c_(e,t){if(t.bookType=="fods")return Mg(e,t);var r=c0(),n="",i=[],s=[];return n="mimetype",Fe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Fe(r,n,Mg(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Fe(r,n,QP(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Fe(r,n,At+Ew()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Fe(r,n,uN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Fe(r,n,lN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Mc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ZP(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):en(Eo(e))}function eR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ui(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function tR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function ko(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ke(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Us(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function bt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=ko(e,r),s=i&7;i=Math.floor(i/8);var a=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:a=4,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=ko(e,r),l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function Mt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ke(n*8+i.type)),i.type==2&&t.push(Ke(i.data.length)),t.push(i.data))})}),ui(t)}function Gr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=ko(e,n),s=bt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Us(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=bt(l.data),u=Us(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(a.merge=Us(s[3][0].data)>>>0>0),r.push(a)}return r}function ds(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ke(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ke(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ke(a.data.length)}],n[2].push({data:Mt(a.meta),type:2})});var s=Mt(n);t.push(Ke(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),ui(t)}function rR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ko(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var l=a-59;a=t[r[0]],l>1&&(a|=t[r[0]+1]<<8),l>2&&(a|=t[r[0]+2]<<16),l>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=l}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ui(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var d=ui(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Kr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rR(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ui(t)}function hs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Ke(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ui(t)}function _d(e,t){var r=new Uint8Array(32),n=Mc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,tR(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Sd(e,t){var r=new Uint8Array(32),n=Mc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Un(e){var t=bt(e);return ko(t[1][0].data)}function nR(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Us(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Mc(e[7][0].data),d=0,h=[],p=Mc(e[4][0].data),m=0,y=[],f=0;f<t.length;++f){if(t[f]==null){u.setUint16(f*2,65535,!0),p.setUint16(f*2,65535);continue}u.setUint16(f*2,d,!0),p.setUint16(f*2,m,!0);var g,v;switch(typeof t[f]){case"string":g=_d({t:"s",v:t[f]},r),v=Sd({t:"s",v:t[f]},r);break;case"number":g=_d({t:"n",v:t[f]},r),v=Sd({t:"n",v:t[f]},r);break;case"boolean":g=_d({t:"b",v:t[f]},r),v=Sd({t:"b",v:t[f]},r);break;default:throw new Error("Unsupported value "+t[f])}h.push(g),d+=g.length,y.push(v),m+=v.length,++c}for(e[2][0].data=Ke(c);f<e[7][0].data.length/2;++f)u.setUint16(f*2,65535,!0),p.setUint16(f*2,65535,!0);return e[6][0].data=ui(h),e[3][0].data=ui(y),c}function iR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Or(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(jt(n)));var s=Bc(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(B){return B.forEach(function(S){typeof S=="string"&&a.push(S)})});var l={},c=[],u=Qe.read(t.numbers,{type:"base64"});u.FileIndex.map(function(B,S){return[B,u.FullPaths[S]]}).forEach(function(B){var S=B[0],R=B[1];if(S.type==2&&S.name.match(/\.iwa/)){var W=S.content,Y=Kr(W),re=Gr(Y);re.forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:R,type:Us(te.messages[0].meta[1][0].data)}})}}),c.sort(function(B,S){return B-S});var d=c.filter(function(B){return B>1}).map(function(B){return[B,Ke(B)]});u.FileIndex.map(function(B,S){return[B,u.FullPaths[S]]}).forEach(function(B){var S=B[0];if(B[1],!!S.name.match(/\.iwa/)){var R=Gr(Kr(S.content));R.forEach(function(W){W.messages.forEach(function(Y){d.forEach(function(re){W.messages.some(function(te){return Us(te.meta[1][0].data)!=11006&&eR(te.data,re[1])})&&l[re[0]].deps.push(W.id)})})})}});for(var h=Qe.find(u,l[1].location),p=Gr(Kr(h.content)),m,y=0;y<p.length;++y){var f=p[y];f.id==1&&(m=f)}var g=Un(bt(m.messages[0].data)[1][0].data);for(h=Qe.find(u,l[g].location),p=Gr(Kr(h.content)),y=0;y<p.length;++y)f=p[y],f.id==g&&(m=f);for(g=Un(bt(m.messages[0].data)[2][0].data),h=Qe.find(u,l[g].location),p=Gr(Kr(h.content)),y=0;y<p.length;++y)f=p[y],f.id==g&&(m=f);for(g=Un(bt(m.messages[0].data)[2][0].data),h=Qe.find(u,l[g].location),p=Gr(Kr(h.content)),y=0;y<p.length;++y)f=p[y],f.id==g&&(m=f);var v=bt(m.messages[0].data);{v[6][0].data=Ke(n.e.r+1),v[7][0].data=Ke(n.e.c+1);var x=Un(v[46][0].data),w=Qe.find(u,l[x].location),E=Gr(Kr(w.content));{for(var C=0;C<E.length&&E[C].id!=x;++C);if(E[C].id!=x)throw"Bad ColumnRowUIDMapArchive";var A=bt(E[C].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var k=0;k<=n.e.c;++k){var O=[];O[1]=O[2]=[{type:0,data:Ke(k+420690)}],A[1].push({type:2,data:Mt(O)}),A[2].push({type:0,data:Ke(k)}),A[3].push({type:0,data:Ke(k)})}A[4]=[],A[5]=[],A[6]=[];for(var U=0;U<=n.e.r;++U)O=[],O[1]=O[2]=[{type:0,data:Ke(U+726270)}],A[4].push({type:2,data:Mt(O)}),A[5].push({type:0,data:Ke(U)}),A[6].push({type:0,data:Ke(U)});E[C].messages[0].data=Mt(A)}w.content=hs(ds(E)),w.size=w.content.length,delete v[46];var z=bt(v[4][0].data);{z[7][0].data=Ke(n.e.r+1);var V=bt(z[1][0].data),G=Un(V[2][0].data);w=Qe.find(u,l[G].location),E=Gr(Kr(w.content));{if(E[0].id!=G)throw"Bad HeaderStorageBucket";var ie=bt(E[0].messages[0].data);for(U=0;U<s.length;++U){var le=bt(ie[2][0].data);le[1][0].data=Ke(U),le[4][0].data=Ke(s[U].length),ie[2][U]={type:ie[2][0].type,data:Mt(le)}}E[0].messages[0].data=Mt(ie)}w.content=hs(ds(E)),w.size=w.content.length;var xe=Un(z[2][0].data);w=Qe.find(u,l[xe].location),E=Gr(Kr(w.content));{if(E[0].id!=xe)throw"Bad HeaderStorageBucket";for(ie=bt(E[0].messages[0].data),k=0;k<=n.e.c;++k)le=bt(ie[2][0].data),le[1][0].data=Ke(k),le[4][0].data=Ke(n.e.r+1),ie[2][k]={type:ie[2][0].type,data:Mt(le)};E[0].messages[0].data=Mt(ie)}w.content=hs(ds(E)),w.size=w.content.length;var Be=Un(z[4][0].data);(function(){for(var B=Qe.find(u,l[Be].location),S=Gr(Kr(B.content)),R,W=0;W<S.length;++W){var Y=S[W];Y.id==Be&&(R=Y)}var re=bt(R.messages[0].data);{re[3]=[];var te=[];a.forEach(function(Le,vt){te[1]=[{type:0,data:Ke(vt)}],te[2]=[{type:0,data:Ke(1)}],te[3]=[{type:2,data:ZP(Le)}],re[3].push({type:2,data:Mt(te)})})}R.messages[0].data=Mt(re);var he=ds(S),He=hs(he);B.content=He,B.size=B.content.length})();var Ne=bt(z[3][0].data);{var F=Ne[1][0];delete Ne[2];var ae=bt(F.data);{var _=Un(ae[2][0].data);(function(){for(var B=Qe.find(u,l[_].location),S=Gr(Kr(B.content)),R,W=0;W<S.length;++W){var Y=S[W];Y.id==_&&(R=Y)}var re=bt(R.messages[0].data);{delete re[6],delete Ne[7];var te=new Uint8Array(re[5][0].data);re[5]=[];for(var he=0,He=0;He<=n.e.r;++He){var Le=bt(te);he+=nR(Le,s[He],a),Le[1][0].data=Ke(He),re[5].push({data:Mt(Le),type:2})}re[1]=[{type:0,data:Ke(n.e.c+1)}],re[2]=[{type:0,data:Ke(n.e.r+1)}],re[3]=[{type:0,data:Ke(he)}],re[4]=[{type:0,data:Ke(n.e.r+1)}]}R.messages[0].data=Mt(re);var vt=ds(S),We=hs(vt);B.content=We,B.size=B.content.length})()}F.data=Mt(ae)}z[3][0].data=Mt(Ne)}v[4][0].data=Mt(z)}m.messages[0].data=Mt(v);var b=ds(p),T=hs(b);return h.content=T,h.size=h.content.length,u}function sR(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function k0(e){sR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function aR(e,t){return t.bookType=="ods"?c_(e,t):t.bookType=="numbers"?iR(e,t):t.bookType=="xlsb"?oR(e,t):lR(e,t)}function oR(e,t){Ns=1024,e&&!e.SSF&&(e.SSF=yr(xt)),e&&e.SSF&&(du(),uu(e.SSF),t.revssf=hu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ya?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Vw.indexOf(t.bookType)>-1,i=ww();k0(t=t||{});var s=c0(),a="",l=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Fe(s,a,Tw(e.Props,t)),i.coreprops.push(a),Je(t.rels,2,a,Ve.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Fe(s,a,jw(e.Props)),i.extprops.push(a),Je(t.rels,3,a,Ve.EXT_PROPS),e.Custprops!==e.Props&&Gt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Fe(s,a,Aw(e.Custprops)),i.custprops.push(a),Je(t.rels,4,a,Ve.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Fe(s,a,uP(l-1,a,t,e,d)),i.sheets.push(a),Je(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ve.WS[0])}if(h){var m=h["!comments"],y=!1,f="";m&&m.length>0&&(f="xl/comments"+l+"."+r,Fe(s,f,fP(m,f)),i.comments.push(f),Je(d,-1,"../comments"+l+"."+r,Ve.CMNT),y=!0),h["!legacy"]&&y&&Fe(s,"xl/drawings/vmlDrawing"+l+".vml",zw(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Fe(s,Sw(a),Ms(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Fe(s,a,hP(t.Strings,a,t)),i.strs.push(a),Je(t.wbrels,-1,"sharedStrings."+r,Ve.SST)),a="xl/workbook."+r,Fe(s,a,cP(e,a)),i.workbooks.push(a),Je(t.rels,1,a,Ve.WB),a="xl/theme/theme1.xml",Fe(s,a,$w(e.Themes,t)),i.themes.push(a),Je(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),a="xl/styles."+r,Fe(s,a,dP(e,a,t)),i.styles.push(a),Je(t.wbrels,-1,"styles."+r,Ve.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Fe(s,a,e.vbaraw),i.vba.push(a),Je(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),a="xl/metadata."+r,Fe(s,a,pP(a)),i.metadata.push(a),Je(t.wbrels,-1,"metadata."+r,Ve.XLMETA),Fe(s,"[Content_Types].xml",_w(i,t)),Fe(s,"_rels/.rels",Ms(t.rels)),Fe(s,"xl/_rels/workbook."+r+".rels",Ms(t.wbrels)),delete t.revssf,delete t.ssf,s}function lR(e,t){Ns=1024,e&&!e.SSF&&(e.SSF=yr(xt)),e&&e.SSF&&(du(),uu(e.SSF),t.revssf=hu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ya?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Vw.indexOf(t.bookType)>-1,i=ww();k0(t=t||{});var s=c0(),a="",l=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Fe(s,a,Tw(e.Props,t)),i.coreprops.push(a),Je(t.rels,2,a,Ve.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Fe(s,a,jw(e.Props)),i.extprops.push(a),Je(t.rels,3,a,Ve.EXT_PROPS),e.Custprops!==e.Props&&Gt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Fe(s,a,Aw(e.Custprops)),i.custprops.push(a),Je(t.rels,4,a,Ve.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Fe(s,a,e_(l-1,t,e,h)),i.sheets.push(a),Je(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ve.WS[0])}if(p){var y=p["!comments"],f=!1,g="";if(y&&y.length>0){var v=!1;y.forEach(function(x){x[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,Fe(s,g,Bb(y,d,t)),i.threadedcomments.push(g),Je(h,-1,"../threadedComments/threadedComment"+l+"."+r,Ve.TCMNT)),g="xl/comments"+l+"."+r,Fe(s,g,Hw(y)),i.comments.push(g),Je(h,-1,"../comments"+l+"."+r,Ve.CMNT),f=!0}p["!legacy"]&&f&&Fe(s,"xl/drawings/vmlDrawing"+l+".vml",zw(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Fe(s,Sw(a),Ms(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Fe(s,a,Dw(t.Strings,t)),i.strs.push(a),Je(t.wbrels,-1,"sharedStrings."+r,Ve.SST)),a="xl/workbook."+r,Fe(s,a,n_(e)),i.workbooks.push(a),Je(t.rels,1,a,Ve.WB),a="xl/theme/theme1.xml",Fe(s,a,$w(e.Themes,t)),i.themes.push(a),Je(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),a="xl/styles."+r,Fe(s,a,Bw(e,t)),i.styles.push(a),Je(t.wbrels,-1,"styles."+r,Ve.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Fe(s,a,e.vbaraw),i.vba.push(a),Je(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),a="xl/metadata."+r,Fe(s,a,Ww()),i.metadata.push(a),Je(t.wbrels,-1,"metadata."+r,Ve.XLMETA),d.length>1&&(a="xl/persons/person.xml",Fe(s,a,Ub(d)),i.people.push(a),Je(t.wbrels,-1,"persons/person.xml",Ve.PEOPLE)),Fe(s,"[Content_Types].xml",_w(i,t)),Fe(s,"_rels/.rels",Ms(t.rels)),Fe(s,"xl/_rels/workbook."+r+".rels",Ms(t.wbrels)),delete t.revssf,delete t.ssf,s}function cR(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function u_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Fo(t.file,Qe.write(e,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Qe.write(e,t)}function uR(e,t){var r=yr(t||{}),n=aR(e,r);return dR(n,r)}function dR(e,t){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Qe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(cu(i))}return t.password&&typeof encrypt_agile<"u"?u_(encrypt_agile(i,t.password),t):t.type==="file"?Fo(t.file,i):t.type=="string"?Ga(i):i}function hR(e,t){var r=t||{},n=CP(e,r);return u_(n,r)}function cn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return _o(Eo(n));case"binary":return Eo(n);case"string":return e;case"file":return Fo(t.file,n,"utf8");case"buffer":return Ge?Pn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):cn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fR(e,t){switch(t.type){case"base64":return _o(e);case"binary":return e;case"string":return e;case"file":return Fo(t.file,e,"binary");case"buffer":return Ge?Pn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?_o(r):t.type=="string"?Ga(r):r;case"file":return Fo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function j0(e,t){$C(),QI(e);var r=yr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=j0(e,r);return r.type="array",cu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return cn(jP(e,r),r);case"slk":case"sylk":return cn(XN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return cn(a_(e.Sheets[e.SheetNames[i]],r),r);case"txt":return fR(d_(e.Sheets[e.SheetNames[i]],r),r);case"csv":return cn(A0(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return cn(YN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return bl(JN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return cn(qN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return cn(ib.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return cn(Rw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return cn(c_(e,r),r);case"wk1":return bl(Og.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return bl(Og.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bl(s_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),hR(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function mR(e,t,r){var n=r||{};return n.type="file",n.file=t,pR(n),j0(e,n)}function gR(e,t,r,n,i,s,a,l){var c=Ht(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||e[r])for(var m=t.s.c;m<=t.e.c;++m){var y=a?e[r][m]:e[n[m]+c];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(p[s[m]]=u);continue}var f=y.v;switch(y.t){case"z":if(f==null)break;continue;case"e":f=f==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(f==null)if(y.t=="e"&&f===null)p[s[m]]=null;else if(u!==void 0)p[s[m]]=u;else if(d&&f===null)p[s[m]]=null;else continue;else p[s[m]]=d&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?f:On(y,f,l);f!=null&&(h=!1)}}return{row:p,isempty:h}}function Bc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=st(d);break;case"number":c=st(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var h=Ht(c.s.r),p=[],m=[],y=0,f=0,g=Array.isArray(e),v=c.s.r,x=0,w={};g&&!e[v]&&(e[v]=[]);var E=u.skipHidden&&e["!cols"]||[],C=u.skipHidden&&e["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(E[x]||{}).hidden)switch(p[x]=Zt(x),r=g?e[v][x]:e[p[x]+h],n){case 1:s[x]=x-c.s.c;break;case 2:s[x]=p[x];break;case 3:s[x]=u.header[x-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=a=On(r,null,u),f=w[a]||0,!f)w[a]=1;else{do l=a+"_"+f++;while(w[l]);w[a]=f,w[l]=1}s[x]=l}for(v=c.s.r+i;v<=c.e.r;++v)if(!(C[v]||{}).hidden){var A=gR(e,c,v,p,n,s,g,u);(A.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=A.row)}return m.length=y,m}var Bg=/"/g;function xR(e,t,r,n,i,s,a,l){for(var c=!0,u=[],d="",h=Ht(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var m=l.dense?(e[r]||[])[p]:e[n[p]+h];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:On(m,null,l));for(var y=0,f=0;y!==d.length;++y)if((f=d.charCodeAt(y))===i||f===s||f===34||l.forceQuotes){d='"'+d.replace(Bg,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Bg,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(a)}function A0(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=st(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Zt(y));for(var f=0,g=i.s.r;g<=i.e.r;++g)(m[g]||{}).hidden||(d=xR(e,i,g,h,a,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((f++?l:"")+d)));return delete n.dense,r.join("")}function d_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=A0(e,t);return r}function vR(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=st(e["!ref"]),s="",a=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)a[l]=Zt(l);for(var d=i.s.r;d<=i.e.r;++d)for(s=Ht(d),l=i.s.c;l<=i.e.c;++l)if(t=a[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function h_(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Dt(n.origin):n.origin;a=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:a+t.length-1+i}};if(s["!ref"]){var h=st(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+t.length-1+i)}else a==-1&&(a=0,d.e.r=t.length-1+i);var p=n.header||[],m=0;t.forEach(function(f,g){Gt(f).forEach(function(v){(m=p.indexOf(v))==-1&&(p[m=p.length]=v);var x=f[v],w="z",E="",C=qe({c:l+m,r:a+g+i});u=jo(s,C),x&&typeof x=="object"&&!(x instanceof Date)?s[C]=x:(typeof x=="number"?w="n":typeof x=="boolean"?w="b":typeof x=="string"?w="s":x instanceof Date?(w="d",n.cellDates||(w="n",x=vr(x)),E=n.dateNF||xt[14]):x===null&&n.nullError&&(w="e",x=0),u?(u.t=w,u.v=x,delete u.w,delete u.R,E&&(u.z=E)):s[C]=u={t:w,v:x},E&&(u.z=E))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var y=Ht(a);if(i)for(m=0;m<p.length;++m)s[Zt(m+l)+y]={t:"s",v:p[m]};return s["!ref"]=jt(d),s}function yR(e,t){return h_(null,e,t)}function jo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?jo(e,qe(t)):jo(e,qe({r:t,c:r||0}))}function wR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _R(){return{SheetNames:[],Sheets:{}}}function SR(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(r_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ER(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function TR(e,t){return e.z=t,e}function f_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function kR(e,t,r){return f_(e,"#"+t,r)}function jR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function AR(e,t,r,n){for(var i=typeof t!="string"?t:st(t),s=typeof t=="string"?t:jt(t),a=i.s.r;a<=i.e.r;++a)for(var l=i.s.c;l<=i.e.c;++l){var c=jo(e,a,l);c.t="n",c.F=s,delete c.v,a==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Si={encode_col:Zt,encode_row:Ht,encode_cell:qe,encode_range:jt,decode_col:m0,decode_row:p0,split_cell:$4,decode_cell:Dt,decode_range:Or,format_cell:On,sheet_add_aoa:pw,sheet_add_json:h_,sheet_add_dom:o_,aoa_to_sheet:oa,json_to_sheet:yR,table_to_sheet:l_,table_to_book:YP,sheet_to_csv:A0,sheet_to_txt:d_,sheet_to_json:Bc,sheet_to_html:a_,sheet_to_formulae:vR,sheet_to_row_object_array:Bc,sheet_get_cell:jo,book_new:_R,book_append_sheet:SR,book_set_sheet_visibility:ER,cell_set_number_format:TR,cell_set_hyperlink:f_,cell_set_internal_link:kR,cell_add_comment:jR,sheet_set_array_formula:AR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function CR(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function C0(){const e=CR();(!e||e.role!=="admin")&&(alert("Access restricted to admin."),window.location.href="/")}const xu=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},Kl=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),NR=()=>xu("users_seed",[]),bR=()=>xu("sales",[]),OR=()=>xu("assignments",[]),Ug=()=>xu("payouts",[]),Ed=e=>Kl("payouts",e),Ol=.2,$g=.3,Ct=e=>Number.isFinite(+e)?`$${(+e).toFixed(2)}`:"-",IR=e=>e?new Date(e).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"-",Td=e=>e?new Date(e).toLocaleDateString([],{year:"numeric",month:"short",day:"numeric"}):"-";function N0(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Kh(){return N0(new Date)}function PR(){const e=localStorage.getItem("pay_period_start");if(!e)return Kh();const t=new Date(e);return isNaN(t.getTime())?Kh():N0(t)}function p_(e,t){if(!e)return!1;const r=new Date(e),n=new Date(t.getTime()+13*24*60*60*1e3);return n.setHours(23,59,59,999),r>=t&&r<=n}function RR({users:e,completedAll:t,completedPP:r,payStart:n,salesById:i}){const s=new Map;function a(d){if(!s.has(d)){const h=e.find(p=>p.email===d);s.set(d,{id:d,name:(h==null?void 0:h.name)||d,role:(h==null?void 0:h.role)||"-",hoursAll:0,hoursPP:0,jobsAll:0,jobsPP:0,salesAll:0,salesPP:0,workerAll:0,workerPP:0,sellerAll:0,sellerPP:0,earnAll:0,earnPP:0,customersPP:[]})}return s.get(d)}const l=3;function c(d){return Number.isFinite(+d.durationHours)?+d.durationHours:l}for(const d of t){const h=i.get(String(d.saleId)),p=h!=null&&h.price?+h.price:+d.price||0;if(d.workerEmail){const m=a(d.workerEmail);if(m.jobsAll+=1,m.hoursAll+=c(d),p){const y=p*Ol;m.workerAll+=y}}if(d.worker2Email){const m=a(d.worker2Email);if(m.jobsAll+=1,m.hoursAll+=c(d),p){const y=p*Ol;m.workerAll+=y}}}for(const d of r){const h=i.get(String(d.saleId)),p=h!=null&&h.price?+h.price:+d.price||0,m=(h==null?void 0:h.name)||d.saleId;if(d.workerEmail){const y=a(d.workerEmail);if(y.jobsPP+=1,y.hoursPP+=c(d),p){const f=p*Ol;y.workerPP+=f,y.customersPP.push({custName:m,price:p,share:f})}}if(d.worker2Email){const y=a(d.worker2Email);if(y.jobsPP+=1,y.hoursPP+=c(d),p){const f=p*Ol;y.workerPP+=f,y.customersPP.push({custName:m,price:p,share:f})}}}for(const d of i.values()){const h=d==null?void 0:d.sellerEmail;if(!h)continue;const p=a(h);p.salesAll+=1,d!=null&&d.price&&(p.sellerAll+=+d.price*$g)}for(const d of i.values()){const h=d==null?void 0:d.sellerEmail;if(!h)continue;const p=d.createdAt||d.soldAt||d.created_at;if(!p_(p,n))continue;const m=a(h);if(m.salesPP+=1,d!=null&&d.price){const y=+d.price*$g;m.sellerPP+=y,m.customersPP.push({custName:d.name||"(sold)",price:+d.price,share:y})}}const u=Array.from(s.values()).map(d=>(d.earnAll=d.workerAll+d.sellerAll,d.earnPP=d.workerPP+d.sellerPP,d));return u.sort((d,h)=>h.earnPP-d.earnPP),u}function DR(){de.useEffect(()=>{C0()},[]);const[e,t]=de.useState(!1),[r,n]=de.useState(!1),[i,s]=de.useState(!1),[a,l]=de.useState([]),[c,u]=de.useState([]),[d,h]=de.useState([]),[p,m]=de.useState([]),[y,f]=de.useState(PR()),[g,v]=de.useState(Ug()),[x,w]=de.useState(()=>NR()),[E,C]=de.useState(()=>bR()),[A,k]=de.useState(()=>OR()),O=de.useMemo(()=>{const S=new Map;for(const R of E)S.set(String(R.id),R);return S},[E]),U=de.useMemo(()=>(A||[]).filter(S=>S&&(S.done||S.status==="completed"||S.status==="done"||S.isPast)),[A]),z=de.useMemo(()=>U.filter(S=>{const R=S.doneAt||S.createdAt||S.when||null;return p_(R,y)}),[U,y]),V=de.useMemo(()=>RR({users:x,completedAll:U,completedPP:z,payStart:y,salesById:O}),[x,U,z,y,O]);de.useEffect(()=>{r&&(l(V.map(S=>({...S}))),u(V.map(S=>({...S}))))},[r]),de.useEffect(()=>{i&&(h(V.map(S=>({...S}))),m(V.map(S=>({...S}))))},[i]);const G=()=>{const S=["NAME","ROLE","CUSTOMERS WORKED (W/S)","NAMES WORKED (W/S)","TOTAL HOURS","EARNINGS","WORKER EARNED","SELLER EARNED"],R=V.map(J=>{const ne=J.jobsPP||0,ue=J.salesPP||0,_e=J.customersPP.filter(Ze=>Ze.share===Ze.price*.2).map(Ze=>Ze.custName).join("; "),De=J.customersPP.filter(Ze=>Ze.share===Ze.price*.3).map(Ze=>Ze.custName).join("; "),Me=`${_e||"-"} / ${De||"-"}`;return[J.name,J.role,`${ne}/${ue}`,Me,J.hoursPP.toFixed(1),J.earnPP,J.workerPP,J.sellerPP]}),W="Pane in the Glass  Pay Period Snapshot",Y=`Pay Period: ${Td(y)}  ${Td(new Date(y.getTime()+13*24*60*60*1e3))}`,re=[[W],[Y],[],S,...R.map(J=>[J[0],J[1],J[2],J[3],J[4],J[5],J[6],J[7]])],te=Si.aoa_to_sheet(re);te["!merges"]=[{s:{r:0,c:0},e:{r:0,c:7}},{s:{r:1,c:0},e:{r:1,c:7}}],te["!cols"]=[{wch:24},{wch:14},{wch:30},{wch:30},{wch:16},{wch:18},{wch:18},{wch:18}],te["!rows"]=[{hpt:28},{hpt:22},{hpt:8},{hpt:30}];const he={top:{style:"thin",color:{rgb:"D1D5DB"}},bottom:{style:"thin",color:{rgb:"D1D5DB"}},left:{style:"thin",color:{rgb:"D1D5DB"}},right:{style:"thin",color:{rgb:"D1D5DB"}}};for(let J=0;J<S.length;J++){const ne=te[Si.encode_cell({r:0,c:J})];ne&&(ne.s={font:{bold:!0,sz:18,color:{rgb:"111827"}},alignment:{horizontal:"center",vertical:"center"},border:he})}for(let J=0;J<S.length;J++){const ne=te[Si.encode_cell({r:1,c:J})];ne&&(ne.s={font:{italic:!0,sz:13,color:{rgb:"6B7280"}},alignment:{horizontal:"center",vertical:"center"},border:he})}for(let J=0;J<S.length;J++){const ne=te[Si.encode_cell({r:3,c:J})];ne&&(ne.s={font:{bold:!0,sz:15,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"E5E7EB"}},alignment:{horizontal:"center",vertical:"center"},border:he})}const He=4,Le=R.length;for(let J=0;J<Le;J++){const ne=He+J,ue=J%2===1;for(let _e=0;_e<S.length;_e++){const De=te[Si.encode_cell({r:ne,c:_e})];if(!De)continue;const Me=_e===0||_e===1||_e===4||_e===5,Ze=_e===5||_e===6||_e===7;Ze&&(De.t="s",De.v=Ct(De.v)),De.s={font:{sz:Me?13:12,bold:Me,color:{rgb:"111827"}},alignment:{horizontal:Ze?"right":_e===0||_e===1?"left":"center",vertical:"center"},fill:{fgColor:{rgb:ue?"F9FAFB":"FFFFFF"}},border:he}}}const vt=Si.book_new();Si.book_append_sheet(vt,te,"Snapshot"),mR(vt,`PaneSnapshot_${y.toISOString().slice(0,10)}.xlsx`,{cellStyles:!0});const We=j0(vt,{bookType:"xlsx",type:"base64"}),N={id:crypto.randomUUID?crypto.randomUUID():Date.now().toString(),name:`PaneSnapshot_${y.toISOString().slice(0,10)}.xlsx`,xlsx:We,createdAtISO:new Date().toISOString(),periodStartISO:y.toISOString()},K=Ug(),H=[N,...K];Ed(H),v(H)};function ie(S){if(!(S!=null&&S.id))return;const W=[{id:crypto.randomUUID?crypto.randomUUID():S.id+"-"+Date.now(),email:S.id,name:S.name,amount:+S.earnPP,periodStartISO:y.toISOString(),createdAtISO:new Date().toISOString()},...g];v(W),Ed(W)}function le(S){const R=g.filter(W=>W.id!==S);v(R),Ed(R)}const xe=y.toISOString().slice(0,10),Be=S=>{const R=S.target.value;if(!R)return;const W=new Date(R+"T00:00:00");if(isNaN(W.getTime()))return;const Y=N0(W);f(Y),localStorage.setItem("pay_period_start",Y.toISOString())},Ne=()=>{const S=Kh();localStorage.setItem("pay_period_start",S.toISOString()),f(S)};function F(){const S=x.map(W=>{const Y=a.find(re=>re.id===W.email);return Y?{...W,name:Y.name,role:Y.role}:W});w(S),Kl("users_seed",S);const R=A.map(W=>{let Y=!1,re={...W};if(W.workerEmail){const te=a.find(he=>he.id===W.workerEmail);te&&re.workerName!==te.name&&(re.workerName=te.name,Y=!0)}if(W.worker2Email){const te=a.find(he=>he.id===W.worker2Email);te&&re.worker2Name!==te.name&&(re.worker2Name=te.name,Y=!0)}return Y?re:W});k(R),Kl("assignments",R),n(!1)}function ae(){l(c.map(S=>({...S}))),n(!1)}function _(){const S=y.toISOString(),R=g.map(W=>{const Y=d.find(re=>re.id===W.email&&W.periodStartISO===S);return Y?{...W,name:Y.name,amount:+Y.earnPP}:W});v(R),Kl("payouts",R),s(!1)}function b(){h(p.map(S=>({...S}))),s(!1)}const T={padding:"8px 10px",verticalAlign:"middle",textAlign:"center"},B={padding:"8px 10px",verticalAlign:"middle",textAlign:"center"};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",style:{marginTop:"-10px"},children:[o.jsx("div",{style:{display:"flex",flexDirection:"column",marginBottom:12},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,width:"100%"},children:[o.jsxs("div",{style:{flex:"1 1 auto"},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:4},children:"Money (Admin)"}),o.jsx("p",{className:"muted",style:{fontSize:13,marginTop:-6,marginBottom:0,lineHeight:1.4},children:"View earnings, set pay window, mark payouts."})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:160,marginRight:-60},children:[o.jsxs("label",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:1,cursor:"pointer",userSelect:"none",fontSize:12,fontWeight:600,whiteSpace:"nowrap"},children:[o.jsx("input",{type:"checkbox",checked:e,onChange:S=>t(S.target.checked),style:{margin:-12,transform:"scale(0.95)"}}),o.jsx("span",{style:{marginLeft:2},children:"Edit Mode"})]}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",gap:8,marginTop:8,visibility:e?"visible":"hidden",marginLeft:"-120px"},children:[o.jsx("button",{className:"btn",style:{fontSize:12,lineHeight:1,padding:"6px 10px"},onClick:()=>{},children:"+ Add Row"}),o.jsx("button",{className:"btn outline",style:{fontSize:12,lineHeight:1,padding:"6px 10px",borderColor:"var(--accent)",color:"var(--accent)"},onClick:()=>{alert("Nothing to save yet here ")},children:"Save All Changes"})]})]})]})}),o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[o.jsxs("label",{style:{fontWeight:600},children:["Pay period start:",o.jsx("input",{type:"date",value:xe,onChange:Be,style:{padding:"6px 8px",border:"1px solid var(--border)",borderRadius:8,background:"var(--card)",color:"var(--text)"}})]}),o.jsx("button",{className:"btn outline",onClick:Ne,children:"Reset to next 14 days"}),o.jsx("button",{className:"btn",onClick:G,children:"Export PP Excel"})]}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:4,lineHeight:1.4},children:"Pay period = start date through the next 14 days (including today)."})]}),o.jsxs("div",{className:"card",style:{paddingTop:"16px",marginTop:"-10px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:"4px"},children:"Employee Info"}),o.jsx("button",{className:"btn outline",style:{fontSize:12,padding:"4px 10px",marginLeft:8,marginTop:-4,borderColor:r?"var(--accent)":"#cbd5e1",color:r?"var(--accent)":"#64748b"},onClick:()=>n(S=>!S),children:r?"Done":"Edit"})]}),o.jsxs("div",{style:{borderTop:"1px solid #e2e8f0",marginTop:"6px",paddingTop:"6px"},children:[o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"8%"}}),o.jsx("col",{style:{width:"9%"}}),o.jsx("col",{style:{width:"9%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"15%"}}),o.jsx("col",{style:{width:"25%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Employee"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Role"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Hours (PP)"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Hours (All)"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Earnings (PP)"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Earnings (All)"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Breakdown (PP / All)"}),o.jsx("th",{style:{...T,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Customers (PP)"})]})}),o.jsxs("tbody",{children:[V.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,style:{...T,color:"#64748b"},children:"No employees."})}),(r?a:V).map((S,R)=>o.jsxs("tr",{children:[o.jsx("td",{style:{...T,fontWeight:600},children:r?o.jsx("input",{type:"text",value:S.name,style:{width:"90%",fontWeight:600,fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],name:Y},te})}}):S.name}),o.jsx("td",{style:T,children:r?o.jsx("input",{type:"text",value:S.role,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],role:Y},te})}}):S.role}),o.jsx("td",{style:T,children:r?o.jsx("input",{type:"text",value:S.hoursPP,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],hoursPP:Y},te})}}):Number(S.hoursPP).toFixed(1)}),o.jsx("td",{style:T,children:r?o.jsx("input",{type:"text",value:S.hoursAll,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],hoursAll:Y},te})}}):Number(S.hoursAll).toFixed(1)}),o.jsx("td",{style:T,children:r?o.jsx("input",{type:"text",value:S.earnPP,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],earnPP:Y},te})}}):Ct(S.earnPP)}),o.jsx("td",{style:T,children:r?o.jsx("input",{type:"text",value:S.earnAll,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;l(re=>{const te=[...re];return te[R]={...te[R],earnAll:Y},te})}}):Ct(S.earnAll)}),o.jsx("td",{style:{...T,fontSize:12,lineHeight:1.4},children:r?o.jsx("input",{type:"text",value:`Worker: ${Ct(S.workerPP)} / ${Ct(S.workerAll)} | Seller: ${Ct(S.sellerPP)} / ${Ct(S.sellerAll)}`,style:{width:"98%",fontSize:12,padding:"4px 6px"},onChange:()=>{},disabled:!0}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:["Worker: ",Ct(S.workerPP)," / ",Ct(S.workerAll)]}),o.jsxs("div",{children:["Seller: ",Ct(S.sellerPP)," / ",Ct(S.sellerAll)]}),o.jsxs("div",{style:{marginTop:4},children:["Sales: ",S.salesPP," / ",S.salesAll,"  Jobs: ",S.jobsPP," / ",S.jobsAll]})]})}),o.jsx("td",{style:{...T,fontSize:11,lineHeight:1.4,whiteSpace:"pre-wrap"},children:r?o.jsx("textarea",{value:S.customersPP&&S.customersPP.length>0?S.customersPP.map((W,Y)=>`${W.custName} (${Ct(W.price)}/${Ct(W.share)})`).join(`
`):"",style:{width:"98%",fontSize:11,minHeight:30,padding:"4px 6px"},onChange:()=>{},disabled:!0}):S.customersPP.length===0?o.jsx("span",{style:{color:"var(--muted)"},children:""}):S.customersPP.map((W,Y)=>o.jsxs("div",{children:[W.custName," (",Ct(W.price),"/",Ct(W.share),")"]},Y))})]},S.id))]})]}),r&&o.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,justifyContent:"center"},children:[o.jsx("button",{className:"btn",style:{fontSize:13,padding:"6px 16px"},onClick:F,children:"Save"}),o.jsx("button",{className:"btn outline",style:{fontSize:13,padding:"6px 16px"},onClick:ae,children:"Cancel"})]}),o.jsx("div",{style:{marginTop:12,fontSize:12,color:"var(--muted)",textAlign:"center"},children:'"PP" = current pay period window.'})]})]}),o.jsxs("div",{className:"card",children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsx("h3",{className:"section-title",style:{marginBottom:6},children:"Mark Pay This Period"}),o.jsx("button",{className:"btn outline",style:{fontSize:12,padding:"4px 10px",marginLeft:8,marginTop:-4,borderColor:i?"var(--accent)":"#cbd5e1",color:i?"var(--accent)":"#64748b"},onClick:()=>s(S=>!S),children:i?"Done":"Edit"})]}),o.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"16%"}}),o.jsx("col",{style:{width:"16%"}}),o.jsx("col",{style:{width:"16%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Name"}),o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Role"}),o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Worker Earn (PP)"}),o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Seller Earn (PP)"}),o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Total (PP)"}),o.jsx("th",{style:{...B,fontWeight:700,fontSize:"13.5px",padding:"10px 12px",letterSpacing:"0.25px"},children:"Pay"})]})}),o.jsxs("tbody",{children:[V.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:6,style:{...B,color:"var(--muted)"},children:"No payouts this period."})}),(i?d:V).map((S,R)=>o.jsxs("tr",{children:[o.jsx("td",{style:{...B,fontWeight:600},children:i?o.jsx("input",{type:"text",value:S.name,style:{width:"90%",fontWeight:600,fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;h(re=>{const te=[...re];return te[R]={...te[R],name:Y},te})}}):S.name}),o.jsx("td",{style:B,children:i?o.jsx("input",{type:"text",value:S.role,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;h(re=>{const te=[...re];return te[R]={...te[R],role:Y},te})}}):S.role}),o.jsx("td",{style:B,children:i?o.jsx("input",{type:"text",value:S.workerPP,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;h(re=>{const te=[...re];return te[R]={...te[R],workerPP:Y},te})}}):Ct(S.workerPP)}),o.jsx("td",{style:B,children:i?o.jsx("input",{type:"text",value:S.sellerPP,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;h(re=>{const te=[...re];return te[R]={...te[R],sellerPP:Y},te})}}):Ct(S.sellerPP)}),o.jsx("td",{style:B,children:i?o.jsx("input",{type:"text",value:S.earnPP,style:{width:"90%",fontSize:13,padding:"4px 6px"},onChange:W=>{const Y=W.target.value;h(re=>{const te=[...re];return te[R]={...te[R],earnPP:Y},te})}}):o.jsx("strong",{children:Ct(S.earnPP)})}),o.jsx("td",{style:B,children:o.jsx("button",{className:"btn outline",style:{fontSize:12,padding:"4px 8px",lineHeight:1},onClick:()=>ie(S),disabled:i,children:"Mark Paid"})})]},S.id))]})]}),i&&o.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,justifyContent:"center"},children:[o.jsx("button",{className:"btn",style:{fontSize:13,padding:"6px 16px"},onClick:_,children:"Save"}),o.jsx("button",{className:"btn outline",style:{fontSize:13,padding:"6px 16px"},onClick:b,children:"Cancel"})]}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:8},children:"Mark Paid = just logs a receipt in this browser (localStorage.payouts). It doesn't actually move money."})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{className:"section-title",style:{marginBottom:6},children:"Payout Receipts (All Time)"}),o.jsxs("table",{className:"table",style:{fontSize:12},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"When Logged"}),o.jsx("th",{children:"Name"}),o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Amount Paid"}),o.jsx("th",{children:"Period Start"}),o.jsx("th",{})]})}),o.jsxs("tbody",{children:[g.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:6,style:{color:"var(--muted)"},children:"None recorded yet."})}),g.map(S=>o.jsxs("tr",{children:[o.jsx("td",{children:IR(S.createdAtISO)}),o.jsx("td",{style:{fontWeight:600},children:S.name}),o.jsx("td",{style:{fontSize:11,color:"var(--muted)"},children:S.email}),o.jsx("td",{children:o.jsx("strong",{children:Ct(S.amount)})}),o.jsx("td",{children:Td(S.periodStartISO)}),o.jsx("td",{children:o.jsx("button",{className:"btn outline",style:{fontSize:11,padding:"4px 6px",lineHeight:1,color:"var(--accent)"},onClick:()=>le(S.id),children:"remove"})})]},S.id))]})]}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:8,lineHeight:1.4},children:"This is your audit trail. Stored in localStorage.payouts on this device. Clearing browser data deletes it."})]})]})}const Wg=["admin","seller","worker","hybrid"];function FR(){const[e,t]=X.useState([]),[r,n]=X.useState({email:"",pin:"",name:"",address:"",notes:"",role:"seller"}),[i,s]=X.useState(null),[a,l]=X.useState({}),[c,u]=X.useState(!0),[d,h]=X.useState("");async function p(){u(!0),h("");const{data:x,error:w}=await ms.from("users").select("*").order("role").order("name");w&&h(w.message),t(x||[]);try{localStorage.setItem("users_seed",JSON.stringify(x||[]))}catch{}u(!1)}X.useEffect(()=>{p();const x=()=>p();return window.addEventListener("focus",x),()=>window.removeEventListener("focus",x)},[]);function m(){n({email:"",pin:"",name:"",address:"",notes:"",role:"seller"}),s(null)}function y(x){s(x.email),n({email:x.email||"",pin:x.pin||"",name:x.name||"",address:x.address||"",notes:x.notes||"",role:x.role||"seller"})}async function f(x){if(!confirm("Delete this employee?"))return;const{error:w}=await ms.from("users").delete().eq("email",x);if(w){alert(w.message);return}await p(),i===x&&m()}async function g(x){x.preventDefault();const w={email:(r.email||"").trim().toLowerCase(),pin:String(r.pin||"").trim(),name:(r.name||"").trim(),address:(r.address||"").trim(),notes:(r.notes||"").trim(),role:Wg.includes(r.role)?r.role:"seller"};if(!w.email||!w.pin||!w.name){alert("Email, PIN, and Name are required.");return}if(i&&i!==w.email){const{error:E}=await ms.from("users").upsert(w);if(E)return alert(E.message);const{error:C}=await ms.from("users").delete().eq("email",i);if(C)return alert(C.message)}else{const{error:E}=await ms.from("users").upsert(w);if(E)return alert(E.message)}await p(),m()}function v(x){l(w=>({...w,[x]:!w[x]}))}return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",style:{marginBottom:8},children:"Employees"}),o.jsxs("div",{style:{display:"flex",gap:18,color:"#64748b",fontSize:14,marginTop:2,marginBottom:2,fontWeight:400},children:[o.jsxs("span",{children:["Total: ",o.jsx("b",{children:e.length})]}),o.jsxs("span",{children:["Admins: ",o.jsx("b",{children:e.filter(x=>x.role==="admin").length})]}),o.jsxs("span",{children:["Sellers: ",o.jsx("b",{children:e.filter(x=>x.role==="seller").length})]}),o.jsxs("span",{children:["Workers: ",o.jsx("b",{children:e.filter(x=>x.role==="worker").length})]}),o.jsxs("span",{children:["Hybrids: ",o.jsx("b",{children:e.filter(x=>x.role==="hybrid").length})]}),c&&o.jsx("span",{children:"Loading"}),d&&o.jsxs("span",{style:{color:"var(--danger)"},children:["Error: ",d]})]})]}),o.jsx("div",{className:"card",children:o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"16%"},children:"Name"}),o.jsx("th",{style:{width:"18%"},children:"Email"}),o.jsx("th",{style:{width:"10%"},children:"PIN"}),o.jsx("th",{style:{width:"12%"},children:"Role"}),o.jsx("th",{children:"Address"}),o.jsx("th",{children:"Notes"}),o.jsx("th",{style:{width:140},children:"Actions"})]})}),o.jsx("tbody",{children:e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,style:{color:"#64748b"},children:c?"Loading":"No employees found."})}):e.map(x=>o.jsxs("tr",{children:[o.jsx("td",{children:x.name||"-"}),o.jsx("td",{children:x.email||"-"}),o.jsx("td",{children:o.jsx("button",{type:"button",onClick:()=>v(x.email),style:{cursor:"pointer",background:"none",border:"none",padding:0,fontSize:"inherit",fontFamily:"inherit"},"aria-label":a[x.email]?"Hide PIN":"Show PIN",children:a[x.email]?x.pin||"-":""})}),o.jsx("td",{style:{textTransform:"capitalize"},children:x.role||"-"}),o.jsx("td",{style:{maxWidth:240,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.address||"-"}),o.jsx("td",{style:{maxWidth:260,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.notes||"-"}),o.jsx("td",{children:o.jsxs("div",{className:"row",style:{gap:6},children:[o.jsx("button",{className:"btn outline",onClick:()=>y(x),children:"Edit"}),o.jsx("button",{className:"btn danger outline",onClick:()=>f(x.email),children:"Delete"})]})})]},x.email))})]})}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{className:"section-title",style:{marginBottom:-55},children:i?"Edit Employee":"Add Employee"}),o.jsxs("form",{onSubmit:g,children:[o.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{children:"Name"}),o.jsx("input",{value:r.name,onChange:x=>n({...r,name:x.target.value}),placeholder:"Full name"})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Email (unique)"}),o.jsx("input",{value:r.email,onChange:x=>n({...r,email:x.target.value}),placeholder:"email@example.com",type:"email"})]}),o.jsxs("div",{children:[o.jsx("label",{children:"PIN"}),o.jsx("input",{value:r.pin,onChange:x=>n({...r,pin:x.target.value}),placeholder:"1234",inputMode:"numeric"})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Role"}),o.jsx("select",{value:r.role,onChange:x=>n({...r,role:x.target.value}),children:Wg.map(x=>o.jsx("option",{value:x,children:x},x))})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Address"}),o.jsx("input",{value:r.address,onChange:x=>n({...r,address:x.target.value}),placeholder:"Street, City, State"})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Notes"}),o.jsx("input",{value:r.notes,onChange:x=>n({...r,notes:x.target.value}),placeholder:"Notes"})]})]}),o.jsxs("div",{className:"row",style:{gap:8,marginTop:12},children:[o.jsx("button",{className:"btn",type:"submit",children:i?"Save Changes":"Add Employee"}),i&&o.jsx("button",{type:"button",className:"btn outline",onClick:m,children:"Cancel"})]})]})]})]})}function zg(e){try{return JSON.parse(localStorage.getItem(e)||"[]")}catch{return[]}}function LR(){const e=zg("finishedNeighborhoodLogs");return e.length>0?{data:e,storageKey:"finishedNeighborhoodLogs"}:{data:zg("finishedNeighborhoods"),storageKey:"finishedNeighborhoods"}}function MR(e,t){localStorage.setItem(e,JSON.stringify(t))}function BR(){de.useEffect(()=>{C0()},[]);const[{storageKey:e,initialLoaded:t},r]=de.useState(()=>{const{data:x,storageKey:w}=LR();return{storageKey:w,initialLoaded:x}}),[n,i]=de.useState(()=>t||[]),[s,a]=de.useState(!1),l={textAlign:"center",padding:"8px 10px",verticalAlign:"middle"},c={textAlign:"center",padding:"8px 10px",verticalAlign:"middle"},u={textAlign:"left",padding:"8px 10px",verticalAlign:"middle"};function d(x,w,E){i(C=>{const A=[...C],k={...A[x]};return k[w]=E,A[x]=k,A})}function h(x){i(w=>{const E=[...w];return E.splice(x,1),E})}function p(){const x={id:crypto.randomUUID?crypto.randomUUID():Date.now(),sellerName:"",sellerEmail:"",date:"",time:"",salesCount:"",numSales:"",customers:"",addressSentTo:"",address:"",notes:"",photoDataUrl:""};i(w=>[x,...w])}function m(){MR(e,n),alert("Saved to localStorage ")}function y({idx:x,field:w,placeholder:E,center:C}){var k;const A=((k=n[x])==null?void 0:k[w])??"";return s?o.jsx("input",{style:{width:"100%",fontSize:12,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)"},value:A,placeholder:E||"",onChange:O=>d(x,w,O.target.value)}):o.jsx("div",{style:{fontSize:12,fontWeight:w==="sellerName"?600:400,lineHeight:1.4,wordBreak:"break-word",whiteSpace:"pre-wrap"},children:A||"-"})}function f({idx:x,field:w,placeholder:E}){var A;const C=((A=n[x])==null?void 0:A[w])??"";return s?o.jsx("textarea",{style:{width:"100%",minHeight:60,fontSize:12,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)"},value:C,placeholder:E||"",onChange:k=>d(x,w,k.target.value)}):o.jsx("div",{style:{fontSize:12,lineHeight:1.4,wordBreak:"break-word",whiteSpace:"pre-wrap"},children:C||"-"})}function g({idx:x}){const w=n[x]||{},E=w.sellerName||w.sellerEmail||"",C=w.sellerEmail||"";return s?o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[o.jsx("input",{style:{width:"100%",fontSize:12,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)",fontWeight:600},value:w.sellerName||"",placeholder:"Name",onChange:A=>d(x,"sellerName",A.target.value)}),o.jsx("input",{style:{width:"100%",fontSize:11,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)"},value:w.sellerEmail||"",placeholder:"email@example.com",onChange:A=>d(x,"sellerEmail",A.target.value)})]}):o.jsxs("div",{style:{fontSize:12,lineHeight:1.4},children:[o.jsx("div",{style:{fontWeight:600},children:E||"?"}),C?o.jsx("div",{style:{fontSize:11,color:"var(--muted)",fontWeight:400,wordBreak:"break-word"},children:C}):null]})}function v({idx:x}){const E=(n[x]||{}).photoDataUrl||"";return s?o.jsxs("div",{style:{textAlign:"center"},children:[E?o.jsx("img",{src:E,alt:"proof",style:{width:60,height:60,objectFit:"cover",borderRadius:6,border:"1px solid var(--border)",display:"block",margin:"0 auto 6px auto"}}):null,o.jsx("input",{style:{width:"100%",fontSize:11,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)"},value:E,placeholder:"data:image/jpeg;base64,...",onChange:C=>d(x,"photoDataUrl",C.target.value)})]}):o.jsx("div",{style:{textAlign:"center"},children:E?o.jsx("img",{src:E,alt:"proof",style:{width:60,height:60,objectFit:"cover",borderRadius:6,border:"1px solid var(--border)",display:"block",margin:"0 auto"}}):o.jsx("span",{style:{color:"var(--muted)",fontSize:12},children:"no photo"})})}return o.jsx("div",{className:"grid",style:{marginTop:-52},children:o.jsxs("div",{className:"card",children:[o.jsx("div",{style:{display:"flex",flexDirection:"column",marginBottom:12},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,width:"100%"},children:[o.jsxs("div",{style:{flex:"1 1 auto"},children:[o.jsx("h2",{className:"section-title",style:{marginBottom:4},children:"Review Neighborhood Submissions"}),o.jsx("p",{className:"muted",style:{fontSize:13,marginTop:-6,marginBottom:0,lineHeight:1.4},children:"Sellers / Hybrids submit proof they worked a neighborhood. You confirm they actually did it."})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:160,marginRight:-60},children:[o.jsxs("label",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:1,cursor:"pointer",userSelect:"none",fontSize:12,fontWeight:600,whiteSpace:"nowrap"},children:[o.jsx("input",{type:"checkbox",checked:s,onChange:x=>a(x.target.checked),style:{margin:-12,transform:"scale(0.95)"}}),o.jsx("span",{style:{marginLeft:2},children:"Edit Mode"})," "]}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",gap:8,marginTop:8,visibility:s?"visible":"hidden",marginLeft:"-120px"},children:[o.jsx("button",{className:"btn",style:{fontSize:12,lineHeight:1,padding:"6px 10px"},onClick:p,children:"+ Add Row"}),o.jsx("button",{className:"btn outline",style:{fontSize:12,lineHeight:1,padding:"6px 10px",borderColor:"var(--accent)",color:"var(--accent)"},onClick:m,children:"Save All Changes"})]})]})]})}),o.jsxs("table",{className:"table",style:{width:"100%",tableLayout:"fixed",borderCollapse:"collapse"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"8%"}}),o.jsx("col",{style:{width:"8%"}}),o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"10%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:l,children:"Employee"}),o.jsx("th",{style:l,children:"Date"}),o.jsx("th",{style:l,children:"Time"}),o.jsx("th",{style:l,children:"# Sales"}),o.jsx("th",{style:l,children:"Customers"}),o.jsx("th",{style:l,children:"Address Sent To"}),o.jsx("th",{style:l,children:"Notes"}),o.jsx("th",{style:l,children:"Photo"})]})}),o.jsxs("tbody",{children:[n.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,style:{...c,color:"var(--muted)",fontSize:12},children:"No submissions yet."})}),n.map((x,w)=>{const E=x.salesCount!==void 0&&x.salesCount!==""?x.salesCount:x.numSales!==void 0&&x.numSales!==""?x.numSales:"";return o.jsxs("tr",{children:[o.jsx("td",{style:u,children:o.jsx(g,{idx:w})}),o.jsx("td",{style:c,children:o.jsx(y,{idx:w,field:"date",placeholder:"2025-11-01",center:!0})}),o.jsx("td",{style:c,children:o.jsx(y,{idx:w,field:"time",placeholder:"3:45 PM",center:!0})}),o.jsx("td",{style:c,children:s?o.jsx("input",{style:{width:"100%",fontSize:12,lineHeight:1.4,padding:"4px 6px",border:"1px solid var(--border)",borderRadius:4,background:"var(--card)",color:"var(--text)",textAlign:"center"},value:E,placeholder:"0",onChange:C=>{d(w,"salesCount",C.target.value),d(w,"numSales",C.target.value)}}):o.jsx("div",{style:{fontSize:12,fontWeight:600},children:E||"-"})}),o.jsx("td",{style:u,children:o.jsx(f,{idx:w,field:"customers",placeholder:"House 1, House 2, House 3..."})}),o.jsx("td",{style:u,children:s?o.jsx(f,{idx:w,field:"addressSentTo",placeholder:"Sent lead list to: Jason / group text / etc"}):o.jsx("div",{style:{fontSize:12,lineHeight:1.4,wordBreak:"break-word",whiteSpace:"pre-wrap"},children:x.addressSentTo||x.address||"-"})}),o.jsx("td",{style:u,children:o.jsx(f,{idx:w,field:"notes",placeholder:"Knocked cul-de-sac, HOA tried to kick me out, etc."})}),o.jsxs("td",{style:{...c,verticalAlign:"top"},children:[o.jsx(v,{idx:w}),s&&o.jsx("button",{className:"btn outline",style:{fontSize:10,lineHeight:1,padding:"4px 6px",marginTop:8,borderColor:"var(--accent)",color:"var(--accent)",width:"100%"},onClick:()=>h(w),children:"delete row"})]})]},x.id||w)})]})]}),o.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:10,lineHeight:1.4},children:'Edit Mode lets you fix bad data, add missing knocks, or clean up notes. Press "Save All Changes" to write it all into localStorage.'})]})})}const kd=["users_seed","sales","assignments","finishedNeighborhoodLogs","finishedNeighborhoods","payouts","pay_period_start"];function Il(e){return localStorage.getItem(e)??""}function jd(e,t){localStorage.setItem(e,t)}function Hg(e){try{const t=JSON.parse(e);return JSON.stringify(t,null,2)}catch{return e??""}}function Ad(e){try{return JSON.parse(e)}catch{return null}}function UR(){de.useEffect(()=>{C0()},[]);const[e,t]=de.useState(kd[0]),[r,n]=de.useState(()=>Hg(Il(kd[0]))),[i,s]=de.useState("");function a(h){const p=h.target.value;t(p),n(Hg(Il(p))),s("")}function l(){const h=r.trim();if(h.startsWith("{")||h.startsWith("["))try{JSON.parse(h)}catch{s(" Not valid JSON. Fix it first.");return}jd(e,h),s(" Saved to localStorage["+e+"]")}function c(h){const p=Il(e),m=Ad(p);if(!Array.isArray(m)){s(" Current value is not an array, can't delete index.");return}const y=[...m];if(h<0||h>=y.length){s(" Index out of range.");return}y.splice(h,1);const f=JSON.stringify(y,null,2);n(f),jd(e,f),s(` Removed item ${h} from ${e}`)}function u(){const h=Il(e),p=Ad(h);if(!Array.isArray(p)){s(" Current value is not an array, can't push blank row.");return}const y=[{id:crypto.randomUUID?crypto.randomUUID():Date.now()},...p],f=JSON.stringify(y,null,2);n(f),jd(e,f),s(` Added blank row to ${e}`)}function d(){const h=Ad(r);if(!Array.isArray(h))return null;const p=h.slice(0,5);return o.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px",background:"var(--card)",overflowX:"auto"},children:[o.jsxs("div",{style:{fontSize:12,fontWeight:600,marginBottom:6},children:["Quick Preview (first 5 rows of ",e,")"]}),o.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12,lineHeight:1.4},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"var(--bg2)"},children:[o.jsx("th",{style:{textAlign:"left",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"idx"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"id"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"name / sellerName"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"email"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"$ / notes / etc"}),o.jsx("th",{style:{textAlign:"center",padding:"4px 6px",borderBottom:"1px solid var(--border)",fontWeight:600},children:"delete"})]})}),o.jsxs("tbody",{children:[p.map((m,y)=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",verticalAlign:"top",fontWeight:600},children:y}),o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",verticalAlign:"top"},children:(m==null?void 0:m.id)??"-"}),o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",verticalAlign:"top"},children:(m==null?void 0:m.name)||(m==null?void 0:m.sellerName)||"-"}),o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",verticalAlign:"top",fontSize:11,color:"var(--muted)"},children:(m==null?void 0:m.email)||(m==null?void 0:m.sellerEmail)||"-"}),o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",verticalAlign:"top",fontSize:11,whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:140},children:(m==null?void 0:m.price)||(m==null?void 0:m.notes)||(m==null?void 0:m.customers)||(m==null?void 0:m.address)||(m==null?void 0:m.addressSentTo)||"-"}),o.jsx("td",{style:{padding:"4px 6px",borderBottom:"1px solid var(--border)",textAlign:"center"},children:o.jsx("button",{className:"btn outline",style:{fontSize:10,lineHeight:1,padding:"4px 6px",borderColor:"var(--accent)",color:"var(--accent)"},onClick:()=>c(y),children:"delete"})})]},y)),h.length>5&&o.jsx("tr",{children:o.jsxs("td",{colSpan:6,style:{padding:"4px 6px",fontSize:11,color:"var(--muted)",textAlign:"center"},children:["and ",h.length-5," more rows"]})})]})]}),o.jsx("div",{style:{marginTop:6,display:"flex",gap:8,flexWrap:"wrap"},children:o.jsx("button",{className:"btn",style:{fontSize:12,lineHeight:1,padding:"6px 10px"},onClick:u,children:"+ Add Blank Row"})})]})}return o.jsx("div",{className:"grid",style:{marginTop:-52},children:o.jsxs("div",{className:"card",style:{width:"100%"},children:[o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:12},children:[o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",style:{marginBottom:4},children:"Admin Data Console"}),o.jsx("div",{className:"muted",style:{fontSize:13,marginTop:-6,lineHeight:1.4},children:"Full access to localStorage. Edit carefully."})]}),o.jsxs("div",{style:{minWidth:220},children:[o.jsx("label",{style:{fontSize:12,fontWeight:600,display:"block",marginBottom:4},children:"Storage Key"}),o.jsx("select",{style:{width:"100%",fontSize:12,padding:"6px 8px",border:"1px solid var(--border)",borderRadius:6,background:"var(--card)",color:"var(--text)"},value:e,onChange:a,children:kd.map(h=>o.jsx("option",{value:h,children:h},h))})]})]}),d(),o.jsxs("div",{style:{marginTop:16},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:12,marginBottom:6},children:[o.jsxs("div",{style:{fontSize:12,fontWeight:600},children:["Raw ",e," value:"]}),o.jsx("button",{className:"btn outline",style:{fontSize:12,lineHeight:1,padding:"6px 10px",borderColor:"var(--accent)",color:"var(--accent)"},onClick:l,children:"Save to localStorage"})]}),o.jsx("textarea",{style:{width:"100%",minHeight:260,fontSize:12,lineHeight:1.4,fontFamily:"monospace",padding:"8px 10px",border:"1px solid var(--border)",borderRadius:8,background:"var(--card)",color:"var(--text)",whiteSpace:"pre"},value:r,onChange:h=>{n(h.target.value),s("")}})]}),i&&o.jsx("div",{style:{fontSize:12,marginTop:10,color:i.startsWith("")?"var(--accent)":"var(--danger, #dc2626)",lineHeight:1.4,wordBreak:"break-word"},children:i})]})})}const b0=(e,t)=>{try{return JSON.parse(localStorage.getItem(e)??JSON.stringify(t))}catch{return t}},m_=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),$R=()=>{try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}},ja=()=>b0("neighborhoodAssignments",[]),Cd=e=>m_("neighborhoodAssignments",e),WR=()=>b0("seller_calendar",[]),zR=e=>m_("seller_calendar",e),HR=()=>b0("sales",[]),Nd=(e,t)=>{if(!e)return t?String(t):"-";const r=new Date(e);if(isNaN(r.getTime()))return t?String(t):"-";const n=r.toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return t?`${n}  ${t}`:n},VR=(e,t)=>{const r=new Date(e);if(isNaN(r.getTime()))return!1;const n=Date.now()-r.getTime();return n>=0&&n<=t*24*60*60*1e3},Vg=e=>{if(!e)return!1;const t=new Date(e);if(isNaN(t.getTime()))return!1;const r=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),i=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return n>=i};function GR(e,t,r,n){const i=n?String(n).slice(0,10):null;let s=0;for(const a of e)if(((a==null?void 0:a.sellerEmail)||"").toLowerCase()===(t||"").toLowerCase()&&((a==null?void 0:a.neighborhood)||"").trim().toLowerCase()===(r||"").trim().toLowerCase())if(i){const l=a!=null&&a.soldAt?String(a.soldAt).slice(0,10):a!=null&&a.createdAt?new Date(a.createdAt).toISOString().slice(0,10):null;l&&l===i&&s++}else s++;return s}function bd({children:e}){return o.jsx("span",{className:"chip",style:{fontSize:11,padding:"2px 8px",borderRadius:999},children:e})}function KR(){const[e,t]=de.useState({open:!1,id:null,soldCount:"",soldNames:""});function r(v){t({open:!0,id:v,soldCount:"",soldNames:""})}function n(){t({open:!1,id:null,soldCount:"",soldNames:""})}function i(){const v=parseInt(String(e.soldCount||"").trim(),10),x=Number.isFinite(v)&&v>=0?v:0,w=String(e.soldNames||"").trim(),E=ja(),C=E.findIndex(A=>A.id===e.id);C!==-1&&(E[C]={...E[C],finishedAt:Date.now(),soldCount:x,soldNames:w},Cd(E)),n()}const s=$R(),a=(s==null?void 0:s.email)||"",[l,c]=de.useState(ja()),u=de.useMemo(()=>HR(),[]);de.useEffect(()=>{const v=setInterval(()=>c(ja()),1200);return()=>clearInterval(v)},[]);const d=de.useMemo(()=>(l||[]).filter(x=>x.sellerEmail===a).filter(x=>!x.accepted&&!(x.denied||[]).some(w=>w.email===a)).sort((x,w)=>String(x.dateISO||"").localeCompare(String(w.dateISO||""))),[l,a]),h=de.useMemo(()=>(l||[]).filter(x=>x.sellerEmail===a&&x.accepted&&!x.finishedAt).filter(x=>Vg(x.dateISO)).sort((x,w)=>String(x.dateISO||"").localeCompare(String(w.dateISO||""))),[l,a]),p=de.useMemo(()=>(l||[]).filter(x=>x.sellerEmail===a&&x.accepted).filter(x=>x.finishedAt||!Vg(x.dateISO)&&VR(x.dateISO,7)).sort((x,w)=>String(w.dateISO||"").localeCompare(String(x.dateISO||""))),[l,a]),m=v=>{const x=ja(),w=x.findIndex(k=>k.id===v);if(w===-1)return;const E=x[w];x[w]={...E,accepted:!0,acceptedAt:Date.now()},Cd(x),c(x);const C=WR();C.some(k=>k.source==="neighborhood"&&k.sellerEmail===E.sellerEmail&&k.dateISO===E.dateISO&&k.address===(E.neighborhood||"-"))||(C.push({id:Date.now(),sellerEmail:E.sellerEmail,dateISO:E.dateISO,time:E.time||E.day||"-",address:E.neighborhood||"-",notes:E.notes||"",source:"neighborhood"}),zR(C)),alert("Neighborhood accepted and locked.")},y=v=>{let x="";for(;;){const A=prompt("Please enter a reason to deny (required):");if(A===null)return;if(String(A).trim()){x=String(A).trim();break}alert("A reason is required to deny this neighborhood.")}const w=ja(),E=w.findIndex(A=>A.id===v);if(E===-1)return;const C=Array.isArray(w[E].denied)?w[E].denied:[];w[E]={...w[E],denied:[...C,{email:a,ts:Date.now(),reason:x}]},Cd(w),c(w),alert("Neighborhood denied.")},f={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:12,marginTop:8},g={border:"1px solid var(--border)",borderRadius:12,padding:"10px 12px"};return o.jsxs("div",{className:"grid",children:[o.jsxs("div",{className:"card",children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:2},children:"Offered Neighborhood"}),o.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:8},children:"(once accepted schedule is locked)"}),d.length===0?o.jsx("div",{className:"muted",style:{padding:"6px 2px"},children:"No neighborhood offers right now."}):o.jsx("div",{style:f,children:d.map(v=>o.jsxs("div",{style:g,children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("div",{style:{fontWeight:700},children:v.neighborhood||"-"}),o.jsx(bd,{children:"Offered"})]}),o.jsx("table",{className:"table",style:{width:"100%",marginTop:4},children:o.jsxs("tbody",{children:[o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Date & Time"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13},children:Nd(v.dateISO,v.day)})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Notes"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:v.notes||"-"})})]})}),o.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:10},children:[o.jsx("button",{className:"btn outline",onClick:()=>y(v.id),children:"Deny"}),o.jsx("button",{className:"btn",onClick:()=>m(v.id),children:"Accept"})]})]},v.id))})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Accepted Neighborhoods"}),h.length===0?o.jsx("div",{className:"muted",style:{padding:"6px 2px"},children:"No accepted neighborhoods scheduled."}):o.jsx("div",{style:f,children:h.map(v=>o.jsxs("div",{style:g,children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6,gap:8},children:[o.jsx("div",{style:{fontWeight:700},children:v.neighborhood||"-"}),o.jsxs("div",{className:"row",style:{gap:8},children:[o.jsx(bd,{children:"Locked"}),o.jsx("button",{className:"btn outline",onClick:()=>r(v.id),title:"Mark this neighborhood finished",children:"Finished"})]})]}),o.jsx("table",{className:"table",style:{width:"100%",marginTop:4},children:o.jsxs("tbody",{children:[o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Date & Time"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13},children:Nd(v.dateISO,v.day)})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Notes"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:v.notes||"-"})})]})})]},v.id))})]}),o.jsxs("div",{className:"card",style:{marginTop:24},children:[o.jsx("h2",{className:"section-title",style:{marginTop:6,marginBottom:6},children:"Past Neighborhoods (7 Days)"}),p.length===0?o.jsx("div",{className:"muted",style:{padding:"6px 2px"},children:"No past neighborhoods in the last week."}):o.jsx("div",{style:f,children:p.map(v=>{const x=GR(u,a,v.neighborhood,v.dateISO);return o.jsxs("div",{style:g,children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("div",{style:{fontWeight:700},children:v.neighborhood||"-"}),o.jsx(bd,{children:"Past 7d"})]}),o.jsx("table",{className:"table",style:{width:"100%",marginTop:4},children:o.jsxs("tbody",{children:[o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Date & Time"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13},children:Nd(v.dateISO,v.day)})}),o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"# of Sales"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13},children:String(typeof v.soldCount=="number"?v.soldCount:x)})}),v.soldNames?o.jsxs(o.Fragment,{children:[o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Customer Names"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:v.soldNames})})]}):null,o.jsx("tr",{children:o.jsx("th",{style:{textAlign:"left",fontSize:11,color:"var(--muted)"},children:"Notes"})}),o.jsx("tr",{children:o.jsx("td",{style:{fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:v.notes||"-"})})]})})]},v.id)})})]}),e.open&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"grid",placeItems:"center",zIndex:1e3},role:"dialog","aria-modal":"true",children:o.jsxs("div",{className:"card",style:{width:"min(560px, 94vw)",padding:16,background:"var(--card)",border:"1px solid var(--border)",borderRadius:12},children:[o.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:8},children:"Finish Neighborhood"}),o.jsx("table",{className:"table",style:{width:"100%"},children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{style:{textAlign:"left",width:"40%"},children:"Customers sold"}),o.jsx("td",{children:o.jsx("input",{type:"number",min:"0",inputMode:"numeric",value:e.soldCount,onChange:v=>t(x=>({...x,soldCount:v.target.value})),placeholder:"e.g., 3"})})]}),o.jsxs("tr",{children:[o.jsx("th",{style:{textAlign:"left"},children:"Names"}),o.jsx("td",{children:o.jsx("textarea",{rows:3,value:e.soldNames,onChange:v=>t(x=>({...x,soldNames:v.target.value})),placeholder:"List customer names (comma or line separated)"})})]})]})}),o.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[o.jsx("button",{className:"btn outline",type:"button",onClick:n,children:"Cancel"}),o.jsx("button",{className:"btn",type:"button",onClick:i,children:"Done"})]})]})})]})}(()=>{try{const e=localStorage.getItem("pane_theme")||localStorage.getItem("theme"),t=e||"light";document.documentElement.setAttribute("data-theme",t),e||(localStorage.setItem("pane_theme",t),localStorage.setItem("theme",t))}catch{}})();let Gg=()=>{};if(Gg=hT({immediate:!0,onNeedRefresh(){Gg(!0)},onRegisteredSW(e,t){t&&(setTimeout(()=>t.update().catch(()=>{}),2e3),setInterval(()=>t.update().catch(()=>{}),60*60*1e3))}}),"serviceWorker"in navigator){let e=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,window.location.reload())})}function Jh(){try{return JSON.parse(localStorage.getItem("pane_user")||"null")}catch{return null}}function Kg(e){if(!e)return"/login";switch(e.role){case"seller":return"/seller/home";case"worker":return"/worker";case"hybrid":return"/hybrid/home";case"admin":return"/admin/home";default:return"/login"}}function yt({children:e}){return Jh()?e:o.jsx(kh,{to:"/login",replace:!0})}Od.createRoot(document.getElementById("root")).render(o.jsx(de.StrictMode,{children:o.jsxs(iT,{children:[o.jsx(Lj,{}),o.jsxs(qE,{children:[o.jsx(ut,{path:"/login",element:o.jsx($j,{})}),o.jsx(ut,{path:"/",element:o.jsx(yt,{children:o.jsx(kh,{to:Kg(Jh()),replace:!0})})}),o.jsx(ut,{path:"/seller/home",element:o.jsx(yt,{children:o.jsx(Kj,{})})}),o.jsx(ut,{path:"/calendar/sellers",element:o.jsx(yt,{children:o.jsx(iA,{})})}),o.jsx(ut,{path:"/seller/payments",element:o.jsx(yt,{children:o.jsx(dA,{})})}),o.jsx(ut,{path:"/seller",element:o.jsx(yt,{children:o.jsx(gA,{})})}),o.jsx(ut,{path:"/my-neighborhoods",element:o.jsx(yt,{children:o.jsx(KR,{})})}),o.jsx(ut,{path:"/worker",element:o.jsx(yt,{children:o.jsx(AA,{})})}),o.jsx(ut,{path:"/calendar/workers",element:o.jsx(yt,{children:o.jsx(UA,{})})}),o.jsx(ut,{path:"/worker/payments",element:o.jsx(yt,{children:o.jsx(KA,{})})}),o.jsx(ut,{path:"/finished",element:o.jsx(yt,{children:o.jsx(YA,{})})}),o.jsx(ut,{path:"/hybrid/home",element:o.jsx(yt,{children:o.jsx(sC,{})})}),o.jsx(ut,{path:"/hybrid/calendar",element:o.jsx(yt,{children:o.jsx(_C,{})})}),o.jsx(ut,{path:"/hybrid/payments",element:o.jsx(yt,{children:o.jsx(NC,{})})}),o.jsx(ut,{path:"/admin/home",element:o.jsx(yt,{children:o.jsx(OC,{})})}),o.jsx(ut,{path:"/admin/assign",element:o.jsx(yt,{children:o.jsx(DC,{})})}),o.jsx(ut,{path:"/admin/past",element:o.jsx(yt,{children:o.jsx(MC,{})})}),o.jsx(ut,{path:"/admin/money",element:o.jsx(yt,{children:o.jsx(DR,{})})}),o.jsx(ut,{path:"/admin/employees",element:o.jsx(yt,{children:o.jsx(FR,{})})}),o.jsx(ut,{path:"/admin/review-neighborhoods",element:o.jsx(yt,{children:o.jsx(BR,{})})}),o.jsx(ut,{path:"/admin/data",element:o.jsx(yt,{children:o.jsx(UR,{})})}),o.jsx(ut,{path:"*",element:o.jsx(yt,{children:o.jsx(kh,{to:Kg(Jh()),replace:!0})})})]})]})}));
